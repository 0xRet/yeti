(function(e){function t(t){for(var s,o,l=t[0],r=t[1],c=t[2],d=0,p=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,l=1;l<a.length;l++){var r=a[l];0!==n[r]&&(s=!1)}s&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},n={app:0},i=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=r;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"08a8":function(e,t,a){},1028:function(e,t,a){"use strict";var s=a("bfe7"),n=a.n(s);n.a},"1a12":function(e,t,a){},"29ba":function(e,t,a){},"3a99":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("navbar"),a("div",{staticClass:"container is-fluid",attrs:{id:"app"}},[a("router-view")],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-navbar",{staticClass:"yeti-navbar",attrs:{shadow:!0,type:"is-dark"}},[a("template",{slot:"brand"},[a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}})],1),e.isAuthenticated?a("template",{slot:"start"},[a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[e._v("Search")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/browse"}}},[e._v("Browse observables")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/feeds"}}},[e._v("Feeds")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/analytics"}}},[e._v("Analytics")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/exports"}}},[e._v("Exports")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/templates"}}},[e._v("Templates")])],1):e._e(),a("template",{slot:"end"},[e.isAdmin?a("b-navbar-dropdown",{attrs:{label:"Admin"}},[a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/users"}}},[e._v("Users")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/groups"}}},[e._v("Groups")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/tags"}}},[e._v("Tags")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/system"}}},[e._v("System")])],1):e._e(),e.isAuthenticated?a("b-navbar-dropdown",{attrs:{label:e.tokenSubject}},[a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/profile"}}},[e._v(" Profile ")]),e.localAuth?a("b-navbar-item",{attrs:{tag:"a"},on:{click:function(t){return e.logout()}}},[e._v(" Logout ")]):e._e()],1):e._e(),a("b-navbar-item",{attrs:{tag:"div"}},[a("div",{staticClass:"buttons"},[e.isAuthenticated?e._e():a("a",{staticClass:"button is-primary",attrs:{href:"/auth/login"}},[e._v("Log in")])])])],1)],2)},l=[],r={name:"Navbar",methods:{logout:function(){this.$store.dispatch("logout").then((function(){window.location.href="/login"})),console.log("logout")}},computed:{isAuthenticated:function(){return this.$store.getters.isAuthenticated},isAdmin:function(){return this.$store.getters.isAdmin},tokenSubject:function(){return this.$store.getters.tokenSubject},localAuth:function(){var e=this.$store.getters.appConfig;return null!==e?"local"===e.auth.module:null}}},c=r,u=(a("5dfc"),a("2877")),d=Object(u["a"])(c,o,l,!1,null,null,null),p=d.exports,b={components:{Navbar:p}},f=b,m=(a("5c0b"),Object(u["a"])(f,n,i,!1,null,null,null)),g=m.exports,h=(a("b0c0"),a("8c4f")),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"observable-search"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-one-third"},[a("h1",{staticClass:"is-size-2"},[e._v("Search & add")]),e._m(0),a("div",{staticClass:"card"},[e._m(1),a("div",{staticClass:"card-content"},[a("div",{staticClass:"search"},[a("div",{staticClass:"field"},[a("form",{on:{submit:e.advancedSearchSubmit}},[a("b-input",{attrs:{type:"text",placeholder:"Search query + ⏎",icon:"search"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1)])]),a("br"),e._m(2)])])]),a("div",{staticClass:"column is-two-thirds "},[a("b-field",{staticClass:"add-tags",attrs:{grouped:""}},[a("b-field",[a("b-checkbox",{staticClass:"add-missing-control",model:{value:e.addMissing,callback:function(t){e.addMissing=t},expression:"addMissing"}},[e._v("Add and tag missing observables")])],1),a("b-field",{class:{hidden:!e.addMissing}},[a("yeti-tag-input",{model:{value:e.addTags,callback:function(t){e.addTags=t},expression:"addTags"}})],1),a("b-field",{class:{hidden:!e.addMissing}},[a("b-select",{attrs:{placeholder:"Force observable type"},model:{value:e.addType,callback:function(t){e.addType=t},expression:"addType"}},[a("option",{domProps:{value:null}},[e._v("Guess type")]),e._l(Object.keys(e.defaultTypes),(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(e.defaultTypes[t])+" ")])}))],2)],1)],1),a("b-field",{attrs:{label:"Search"}},[a("b-input",{attrs:{type:"textarea"},model:{value:e.textSearch,callback:function(t){e.textSearch=t},expression:"textSearch"}})],1),a("b-field",{staticClass:"file"},[a("b-upload",{model:{value:e.uploadFile,callback:function(t){e.uploadFile=t},expression:"uploadFile"}},[a("a",{staticClass:"button is-outlined"},[a("span",[e._v("Upload file")])])]),e.uploadFile?a("span",{staticClass:"file-name"},[e._v(" "+e._s(e.uploadFile.name)+" ")]):e._e()],1),a("small",[e._v(" Uploaded file will take precedence over text. Format is the same as text, one observable per line. ")]),a("br"),a("br"),a("b-field",[a("b-button",{attrs:{"icon-left":"search",type:"is-primary"},on:{click:e.searchObservables}},[e._v("Launch search")])],1)],1)]),e.searching?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-4 is-offset-4"},[a("b-progress",{attrs:{size:"is-medium","show-value":""}},[e._v(" Searching... ")])],1)]):e._e(),a("div",{staticClass:"columns"},[e.searchResults?a("div",{staticClass:"column"},[a("h1",{staticClass:"is-size-2"},[e._v("Search results")]),a("br"),a("search-results",{attrs:{searchResults:e.searchResults}})],1):e._e()])])},_=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("p",[a("strong",[e._v("Format")]),e._v(": one observable per line (for both text and file)")]),a("p",[e._v(" Use the checkbox to automatically "),a("strong",[e._v("add")]),e._v(" unknown observables to the database (write operation) ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-header info"},[a("p",{staticClass:"card-header-title"},[e._v("Advanced search")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{staticClass:"message tip"},[a("div",{staticClass:"message-body content "},[a("p",[e._v(" By default, the query will be matched against the "),a("code",[e._v("value")]),e._v(" attribute of the observables. To match against other attributes, use "),a("code",[e._v("attribute=query")]),e._v(". ")]),a("p",[e._v("Examples:")]),a("ul",[a("li",[a("strong",[e._v("Generic tag query")]),e._v(": "),a("code",[e._v("tags=crimeware")])]),a("li",[a("strong",[e._v("Gate URLs")]),e._v(": "),a("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),a("code",[e._v("on")]),e._v(")")]),a("li",[a("strong",[e._v("Ransomware C2s")]),e._v(": "),a("code",[e._v("tags=c2,ransomware")])]),a("li",[a("strong",[e._v("Context")]),e._v(": "),a("code",[e._v("context.source=FeodoTracker")])])])])])}],y=(a("d3b7"),a("ac1f"),a("1276"),a("bc3a")),w=a.n(y),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-taginput",{attrs:{label:"tags",data:e.filteredTags,autocomplete:"",icon:"tag",placeholder:"e.g. Zeus",field:"name",maxtags:e.maxtags,"allow-new":!0},on:{typing:e.getFilteredTags,input:e.updateSelected},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})},k=[],C=(a("a9e3"),a("2ef0")),T=a.n(C),E={name:"YetiTagInput",data:function(){return{tagName:"",selectedTags:this.value,filteredTags:[]}},props:{value:Array,maxtags:{type:Number,default:null}},methods:{getExistingTags:function(){var e=this;w.a.get("/api/tag/").then((function(t){return e.existingTags=t.data})).catch((function(e){return console.log(e)}))},updateSelected:function(){this.$emit("input",this.selectedTags)},getFilteredTags:T.a.debounce((function(e){var t=this;this.tagName=e;var a={filter:{name:this.tagName},params:{regex:!0,page:1}};w.a.post("/api/tagsearch/",a).then((function(e){return t.filteredTags=e.data})).catch((function(e){return console.log(e)}))}),300)},watch:{value:function(e){this.selectedTags=e}}},S=E,P=Object(u["a"])(S,x,k,!1,null,null,null),A=P.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-vertical"},[a("div",{staticClass:"tile"},[a("div",{staticClass:"tile is-parent"},[a("div",{staticClass:"tile is-child card"},[a("header",{staticClass:"card-header warning"},[a("p",{staticClass:"card-header-title"},[a("b-icon",{attrs:{pack:"fas",icon:"crosshairs",size:"is-small"}}),e._v(" Indicator matches "),a("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.matches.length))])],1)]),e.searchResults["matches"].length?a("div",{staticClass:"card-content"},[a("b-table",{attrs:{data:e.searchResults["matches"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name"}},[a("a",{attrs:{href:"#"}},[e._v(" "+e._s(t.row.name)+" ")])]),a("b-table-column",{attrs:{field:"observable",label:"Observable"}},[a("code",[e._v(e._s(t.row.observable.value))])]),a("b-table-column",{attrs:{field:"diamond",label:"Diamond edge"}},[e._v(" "+e._s(t.row.diamond)+" ")]),a("b-table-column",{attrs:{field:"suggested_tags",label:"Suggested tags"}},[a("b-taglist",e._l(t.row.suggested_tags,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"id",label:"ID"}},[e._v(" "+e._s(t.row.id)+" ")])]}}],null,!1,2823120252)})],1):e._e()])]),a("div",{staticClass:"tile is-parent"},[a("div",{staticClass:"tile is-child card"},[a("header",{staticClass:"card-header danger"},[a("p",{staticClass:"card-header-title"},[a("b-icon",{attrs:{pack:"fas",icon:"project-diagram",size:"is-small"}}),e._v(" Related entities "),a("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.entities.length))])],1)]),e.searchResults["entities"].length?a("div",{staticClass:"card-content"},[a("b-table",{attrs:{data:e.searchResults["entities"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name"}},[a("a",{attrs:{href:"#"}},[e._v(" "+e._s(t.row.name)+" ")])]),a("b-table-column",{attrs:{field:"type",label:"Type"}},[a("code",[e._v(e._s(t.row.type))])])]}}],null,!1,36590432)})],1):e._e()])])]),a("div",{staticClass:"tile"},[a("div",{staticClass:"tile is-parent"},[a("div",{staticClass:"tile is-child card"},[a("header",{staticClass:"card-header info"},[a("p",{staticClass:"card-header-title"},[a("b-icon",{attrs:{pack:"fas",icon:"database",size:"is-small"}}),e._v(" Observables found in database "),a("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.known.length))])],1)]),e.searchResults["known"].length?a("div",{staticClass:"card-content"},[a("b-table",{attrs:{data:e.searchResults["known"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"value",label:"Value"}},[a("router-link",{attrs:{to:{name:"ObservableDetails",params:{id:t.row.id}}}},[e._v(" "+e._s(t.row.value)+" ")])],1),a("b-table-column",{attrs:{field:"tags",label:"Tags"}},[a("b-taglist",e._l(t.row.tags,(function(t){return a("b-tag",{key:t.name,attrs:{type:t.fresh?"is-primary":""}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"context",label:"Context"}},[a("b-taglist",e._l(t.row.context,(function(t){return a("b-tag",{key:t.source},[e._v(" "+e._s(t.source)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"created",label:"Created on"}},[e._v(" "+e._s(new Date(t.row.created).toISOString())+" ")])]}}],null,!1,185947723)})],1):e._e()])])]),a("div",{staticClass:"tile"},[a("div",{staticClass:"tile is-parent"},[a("div",{staticClass:"tile is-child card"},[a("header",{staticClass:"card-header light"},[a("p",{staticClass:"card-header-title"},[a("b-icon",{attrs:{pack:"fas",icon:"question",size:"is-small"}}),e._v(" Unknown observables "),a("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.unknown.length))])],1)]),e.searchResults["unknown"].length?a("div",{staticClass:"card-content"},[a("ul",e._l(e.searchResults["unknown"],(function(t){return a("li",{key:t},[e._v(e._s(t))])})),0)]):e._e()])])])])])},$=[],I={name:"SearchResults",data:function(){return{}},props:["searchResults"]},U=I,R=(a("1028"),Object(u["a"])(U,O,$,!1,null,"2ef93083",null)),N=R.exports,j={Ip:"IP",AutonomousSystem:"Autonomous System",Url:"URL",Hostname:"Hostname",Hash:"Hash",File:"File",Certificate:"Certificate",CertificateSubject:"Certificate Subject",Email:"Email",Text:"Text",Bitcoin:"Bitcoin",Path:"Path",MacAddress:"MAC address"},G={name:"ObservableSearch",components:{YetiTagInput:A,SearchResults:N},data:function(){return{addMissing:!1,addTags:[],defaultTypes:j,addType:null,uploadFile:null,textSearch:"",searchResults:null,searchQuery:null,searching:!1,notFound:!1}},methods:{searchObservables:function(){var e=this;this.searching=!0,this.searchResults=null;var t={observables:this.textSearch.split("\n"),add_unknown:this.addMissing};w.a.post("/api/analysis/match",t).then((function(t){console.log(t),e.searchResults=t.data})).catch((function(e){return console.log(e)})).finally((function(){e.searching=!1}))},advancedSearchSubmit:function(e){this.$router.push({name:"ObservableList",query:{q:this.searchQuery}}),e.preventDefault()}}},D=G,F=(a("e7c3"),Object(u["a"])(D,v,_,!1,null,null,null)),L=F.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"observable-list columns"},[a("div",{staticClass:"column is-three-quarters"},[a("b-table",{staticClass:"observable-table",attrs:{data:e.observables,hoverable:!0,narrowed:!0,"checked-rows":e.tableSelectedItems,checkable:"",total:e.tableTotal,perPage:e.tablePerPage,"backend-pagination":"",loading:e.loading,paginated:""},on:{"update:checkedRows":function(t){e.tableSelectedItems=t},"update:checked-rows":function(t){e.tableSelectedItems=t},"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"value",label:"Value"}},[a("router-link",{attrs:{to:{name:"ObservableDetails",params:{id:t.row.id}}}},[e._v(" "+e._s(t.row.value)+" ")])],1),a("b-table-column",{attrs:{field:"tags",label:"Tags"}},[a("b-taglist",e._l(t.row.tags,(function(t){return a("b-tag",{key:t.name,attrs:{type:t.fresh?"is-primary":""}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"context",label:"Context"}},[a("b-taglist",e._l(new Set(t.row.context.map((function(e){return e.source}))),(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"created",label:"Created on"}},[e._v(" "+e._s(new Date(t.row.created).toISOString())+" ")]),a("b-table-column",{attrs:{field:"sources",label:"Sources"}},[a("b-taglist",e._l(t.row.sources,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1)]}}])},[a("template",{slot:"bottom-left"},[e.tableSelectedItems.length?a("div",[a("b",[e._v("Total selected")]),e._v(": "+e._s(e.tableSelectedItems.length)+" "),a("b-button",{attrs:{size:"is-small",type:"is-warning","icon-right":"ban"},on:{click:function(t){e.tableSelectedItems=[]}}},[e._v(" Clear selection ")])],1):e._e()])],2)],1),a("div",{staticClass:"column"},[a("section",[a("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("b-tab-item",{attrs:{label:"Search"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"field"},[a("b-input",{attrs:{type:"text",placeholder:"Search query + ⏎",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchObservables(t)}},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1),a("div",{staticClass:"field"},[a("b-checkbox",{model:{value:e.regexSearch,callback:function(t){e.regexSearch=t},expression:"regexSearch"}},[e._v(" Use regex (slower) ")])],1)]),a("br"),a("article",{staticClass:"message tip"},[a("div",{staticClass:"message-body content"},[a("p",[e._v(" You can run complex queries against the database using the input field above. ")]),a("p",[e._v(" By default, the query will be matched against the "),a("code",[e._v("value")]),e._v(" attribute of the observables. To match against other attributes, use "),a("code",[e._v("attribute=query")]),e._v(". ")]),a("p",[e._v("Examples:")]),a("ul",[a("li",[a("strong",[e._v("Generic tag query")]),e._v(": "),a("code",[e._v("tags=crimeware")])]),a("li",[a("strong",[e._v("Gate URLs")]),e._v(": "),a("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),a("code",[e._v("on")]),e._v(")")]),a("li",[a("strong",[e._v("Ransomware C2s")]),e._v(": "),a("code",[e._v("tags=c2,ransomware")])]),a("li",[a("strong",[e._v("Context")]),e._v(": "),a("code",[e._v("context.source=FeodoTracker")])])])])])]),a("b-tab-item",{attrs:{label:"Export"}},[a("b-field",{attrs:{label:"Select template",message:e.totalSelectedItems+" items will be exported."}},[a("b-select",{attrs:{placeholder:"Select a template",expanded:""},model:{value:e.selectedExportTemplate,callback:function(t){e.selectedExportTemplate=t},expression:"selectedExportTemplate"}},e._l(e.exportTemplates,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),0)],1),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{type:"is-primary"},on:{click:e.downloadExport}},[e._v(" Export selection ")])],1)],1),a("b-tab-item",{attrs:{label:"Bulk tag"}},[a("b-field",{attrs:{label:"Select tags",message:e.selectedTags.length+" tags will be applied to "+e.tableSelectedItems.length+" observables"}},[a("yeti-tag-input",{model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.changeTags("tag")}}},[e._v(" Add tag ")]),a("b-button",{attrs:{type:"is-danger"},on:{click:function(t){return e.changeTags("untag")}}},[e._v(" Remove tag ")])],1)],1)],1)],1)])])},M=[],z=(a("99af"),a("4de4"),a("c975"),a("d81d"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d"),{name:"ObservableList",components:{YetiTagInput:A},props:{searchQuery:{type:String,default:""}},data:function(){return{regexSearch:!1,observables:[],tablePage:1,tablePerPage:50,tableTotal:500,loading:!1,tableSelectedItems:[],exportTemplates:[],selectedExportTemplate:null,selectedTags:[],activeTab:0}},mounted:function(){this.getExportTemplates(),this.searchObservables()},methods:{onPageChange:function(e){this.tablePage=e,this.searchObservables(!1)},searchObservables:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a={filter:this.generateSearchParams(this.searchQuery),params:{regex:this.regexSearch,page:this.tablePage}};console.log(a),t&&this.countTotal(a),this.loading=!0,w.a.post("/api/observablesearch/",a).then((function(t){return e.observables=t.data})).catch((function(e){return console.log(e)})).finally((function(){e.loading=!1}))},generateSearchParams:function(e){var t={},a=e.split(" "),s="value";for(var n in a){var i=a[n].split("=");2==i.length?t[i[0]]=i[1].split(","):""!==a[n]&&(t[s]=a[n])}return t},changeTags:function(e){var t=this,a={tags:this.selectedTags.map((function(e){return e.name})),ids:this.tableSelectedItems.map((function(e){return e.id}))};w.a.post("/api/observable/bulk-".concat(e),a).then((function(){t.searchObservables(),t.$buefy.notification.open("".concat(a.tags.length," tags succesfully ").concat("tag"===e?"added":"removed",".")),t.selectedTags=[],t.tableSelectedItems=[]})).catch((function(e){return console.log(e)}))},getExportTemplates:function(){var e=this;w.a.get("/api/exporttemplate/").then((function(t){e.exportTemplates=t.data})).catch((function(e){console.log(e)}))},downloadExport:function(){var e={id:this.selectedExportTemplate};this.tableSelectedItems.length?e.observables=this.tableSelectedItems.map((function(e){return e.id})):(e.query={filter:this.generateSearchParams(this.searchQuery)},e.query.params={regex:this.regexSearch,page:this.tablePage}),console.log(e),w.a.post("/api/exporttemplate/export",e).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a"),s=e.headers["content-disposition"].split("filename=")[1];a.href=t,a.setAttribute("download",s),document.body.appendChild(a),a.click()})).catch((function(e){console.log(e)}))},countTotal:function(e){var t=this;this.tableTotal=500,w.a.post("/api/observablesearch/total",e).then((function(e){t.tableTotal=e.data.total})).catch((function(e){console.log(e)}))}},computed:{filterTags:function(){var e=this;return this.existingTags.filter((function(t){return t.name.toString().toLowerCase().indexOf(e.tagName.toLowerCase())>=0}))},totalSelectedItems:function(){return this.tableSelectedItems.length>0?this.tableSelectedItems.length:this.tableTotal}}}),Y=z,H=(a("c378"),Object(u["a"])(Y,q,M,!1,null,null,null)),Q=H.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.observable?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-8"},[a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-vertical is-parent"},[a("nav",{staticClass:"tile panel is-child"},[a("p",{staticClass:"panel-heading"},[a("b-taglist",{attrs:{attached:""}},[a("b-tag",{attrs:{size:"is-large",type:"is-dark"}},[e._v(e._s(e.observable.value))]),a("b-tag",{attrs:{size:"is-large",type:"is-info"}},[e._v(e._s(e.observable.type))])],1)],1),a("div",{staticClass:"panel-block"},[a("div",{staticClass:"content"},[e._v(e._s(e.observable.description||"No description provided"))])])]),a("div",{staticClass:"tile is-child"},[a("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("b-tab-item",[a("template",{slot:"header"},[a("b-icon",{attrs:{icon:"info"}}),a("span",[e._v(" Context "),a("b-tag",{attrs:{rounded:""}},[e._v(e._s(e.observable.context.length))])],1)],1),e._l(e.observable.context,(function(t,s){return a("nav",{key:s,staticClass:"panel"},[a("p",{staticClass:"panel-heading"},[e._v(e._s(t.source))]),a("div",{staticClass:"panel-block"},[a("table",{staticClass:"table"},[a("tbody",e._l(Object.keys(t).filter((function(e){return"source"!==e})),(function(s){return a("tr",{key:s},[a("th",[e._v(e._s(s))]),a("td",[e._v(e._s(t[s]))])])})),0)])])])}))],2),a("b-tab-item",[a("template",{slot:"header"},[a("b-icon",{attrs:{icon:"sitemap"}}),a("span",[e._v(" Related observables "),a("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(null==e.totalRelated?"?":e.totalRelated))])],1)],1),a("related-observables",{attrs:{id:e.id},on:{totalUpdated:function(t){return e.totalRelated=t}}})],2)],1)],1)])])]),a("div",{staticClass:"column"},[a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-vertical is-parent"},[a("nav",{staticClass:"tile panel is-child"},[a("p",{staticClass:"panel-heading"},[e._v("Info")]),a("div",{staticClass:"panel-block"},[a("observable-info-table",{attrs:{observable:e.observable}})],1)]),a("nav",{staticClass:"tile panel is-child"},[a("p",{staticClass:"panel-heading"},[e._v("Tags")]),a("div",{staticClass:"panel-block"},[a("b-field",[a("yeti-tag-input",{model:{value:e.newTags,callback:function(t){e.newTags=t},expression:"newTags"}}),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.saveTags}},[e._v("Save")])])],1)],1)])])])])]):e._e()},V=[],W=a("2909"),K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.links?a("b-table",{attrs:{data:e.links,hoverable:!0,narrowed:!0,loading:e.loading,paginated:"","backend-pagination":"",total:e.total,"per-page":e.perPage,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"value",label:"Value"}},[a("router-link",{attrs:{to:{name:"ObservableDetails",params:{id:t.row.target.id}}}},[e._v(" "+e._s(t.row.target.value)+" ")])],1),a("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(" "+e._s(t.row.description)+" ")]),a("b-table-column",{attrs:{field:"description",label:"Tags"}},[a("b-taglist",e._l(t.row.target.tags,(function(t){return a("b-tag",{key:t.name,attrs:{type:t.fresh?"is-primary":""}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"description",label:"Context"}},e._l(t.row.target.context,(function(t){return a("b-tag",{key:t.source},[e._v(" "+e._s(t.source)+" ")])})),1)]}}],null,!1,192142682)}):e._e()],1)},J=[],Z={name:"RelatedObservables",props:["id"],data:function(){return{links:[],page:1,perPage:10,total:500,loading:!1}},mounted:function(){this.fetchNeighbors(),this.countTotal()},methods:{fetchNeighbors:function(){var e=this,t={params:{page:this.page,range:this.perPage}};this.loading=!0,w.a.post("/api/neighbors/tuples/Observable/".concat(this.id,"/Observable"),t).then((function(t){e.links=t.data.links,e.links.map((function(t){t.target=t.dst.id===e.id?t.src:t.dst}))})).catch((function(e){console.log(e)})).finally((function(){return e.loading=!1}))},countTotal:function(){var e=this;w.a.get("/api/neighbors/tuples/Observable/".concat(this.id,"/Observable/total")).then((function(t){e.total=t.data.total,e.$emit("totalUpdated",e.total)})).catch((function(e){console.log(e)}))},onPageChange:function(e){this.page=e,this.fetchNeighbors()}},watch:{id:function(){this.page=1,this.total=500,this.fetchNeighbors(),this.countTotal()}}},X=Z,ee=Object(u["a"])(X,K,J,!1,null,null,null),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("table",{staticClass:"table is-fullwidth"},[a("tbody",[a("tr",[a("th",[e._v("Sources")]),a("td",[a("b-taglist",e._l(e.observable.sources,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1)]),a("tr",[a("th",[e._v("Created")]),a("td",[e._v(e._s(e.observable.created))])])]),"Hostname"==e.observable.type?a("tbody",[a("tr",[a("th",[e._v("Domain?")]),a("td",[e._v(e._s(e.observable.domain?"Yes":"No"))])]),a("tr",[a("th",[e._v("IDNA")]),a("td",[e._v(e._s(e.observable.idna))])])]):e._e(),"Url"==e.observable.type?a("tbody",[a("tr",[a("th",[e._v("Host")]),a("td",[e._v(e._s(e.observable.parsed_url.netloc))])]),a("tr",[a("th",[e._v("Path")]),a("td",[e._v(e._s(e.observable.parsed_url.path))])]),a("tr",[a("th",[e._v("Scheme")]),a("td",[e._v(e._s(e.observable.parsed_url.scheme))])]),a("tr",[a("th",[e._v("Port")]),a("td",[e._v(e._s(e.observable.parsed_url.port))])])]):e._e(),"Ip"==e.observable.type?a("tbody",[a("tr",[a("th",[e._v("IP version")]),a("td",[e._v(e._s(e.observable.version))])]),a("tr",[a("th",[e._v("Country")]),a("td",[e._v(e._s(e.observable.geoip.country||"N/A"))])]),a("tr",[a("th",[e._v("City")]),a("td",[e._v(e._s(e.observable.geoip.city||"N/A"))])])]):e._e()])},se=[],ne={name:"ObservableInfoTable",props:["observable"]},ie=ne,oe=Object(u["a"])(ie,ae,se,!1,null,null,null),le=oe.exports,re={props:["id"],components:{YetiTagInput:A,RelatedObservables:te,ObservableInfoTable:le},data:function(){return{observable:null,newTags:[],activeTab:null,totalRelated:null}},mounted:function(){this.getObservableDetails()},methods:{getObservableDetails:function(){var e=this;w.a.get("/api/observable/".concat(this.id)).then((function(t){e.observable=t.data,e.newTags=Object(W["a"])(e.observable.tags),e.activeTab=0})).catch((function(e){console.log(e)})).finally()},saveTags:function(){var e=this,t={strict:!0,tags:this.newTags.map((function(e){return e.name}))};w.a.post("/api/observable/".concat(this.id),t).then((function(t){e.observable=t.data})).catch((function(e){console.log(e)})).finally()}},watch:{id:"getObservableDetails"}},ce=re,ue=Object(u["a"])(ce,B,V,!1,null,"7f5f1fca",null),de=ue.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedlist"},[a("b-table",{attrs:{data:e.feeds,hoverable:!0,narrowed:!0,"row-class":e.getRowClass},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name"}},[a("strong",[e._v(e._s(t.row.name))])]),a("b-table-column",{attrs:{field:"frequency",label:"Runs every"}},[e._v(e._s(t.row.frequency))]),a("b-table-column",{attrs:{field:"last_run",label:"Last run"}},[e._v(e._s(t.row.last_run||"Never"))]),a("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(t.row.description))]),a("b-table-column",{attrs:{field:"status",label:"Status"}},[e._v(e._s(t.row.status||"N/A"))]),a("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[a("div",{staticClass:"toggle",on:{click:function(a){return e.toggle(t.row)}}},[a("b-switch",{attrs:{disabled:"Updating..."===t.row.status},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"feed.row.enabled"}})],1)]),a("b-table-column",{attrs:{field:"refresh",label:""}},[a("b-button",{attrs:{disabled:"Updating..."===t.row.status||!t.row.enabled,size:"is-small"},on:{click:function(a){return e.refresh(t.row)}}},[a("b-icon",{attrs:{pack:"fas",icon:"sync",size:"is-small","custom-class":"Updating..."===t.row.status?"fa-spin":""}})],1)],1)]}}])})],1)},be=[],fe={name:"FeedList",data:function(){return{feeds:[],timer:null}},mounted:function(){this.listFeeds()},created:function(){this.timer=setInterval(this.listFeeds,5e3)},beforeDestroy:function(){clearInterval(this.timer)},methods:{toggle:function(e){console.log(e);var t="/api/feed/"+e.id+"/toggle";w.a.post(t).then((function(){})).catch((function(e){console.log(e)}))},listFeeds:function(){var e=this;w.a.get("/api/feed/").then((function(t){return e.feeds=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},refresh:function(e){var t="/api/feed/"+e.id+"/refresh";w.a.post(t).then((function(){})).catch((function(e){console.log(e)}))},isRefreshing:function(e){return"Updating..."===e.status},getRowClass:function(e){return e.enabled?"OK"===e.status?"is-success":void 0:"disabled"}}},me=fe,ge=(a("9c02"),Object(u["a"])(me,pe,be,!1,null,"7c38eb62",null)),he=ge.exports,ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"scheduled"},[a("p",{staticClass:"title"},[e._v("Scheduled")]),a("p",{staticClass:"subtitle"},[e._v("Recurring analytics, triggered automatically on a fixed schedule.")]),a("b-table",{attrs:{data:e.scheduled,"default-sort":"name",narrowed:"","row-class":e.getRowClass},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name",sortable:""}},[a("strong",[e._v(e._s(t.row.name))])]),a("b-table-column",{attrs:{field:"frequency",label:"Runs every"}},[e._v(e._s(t.row.frequency))]),a("b-table-column",{attrs:{field:"last_run",label:"Last run"}},[e._v(e._s(t.row.last_run||"Never"))]),a("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(t.row.description))]),a("b-table-column",{attrs:{field:"status",label:"Status"}},[e._v(e._s(t.row.status||"N/A"))]),a("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[a("div",{staticClass:"toggle",on:{click:function(a){return e.toggle(t.row,"scheduled")}}},[a("b-switch",{attrs:{disabled:"Running..."===t.row.status},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"analytics.row.enabled"}})],1)]),a("b-table-column",{attrs:{field:"refresh",label:""}},[a("b-button",{attrs:{disabled:"Running..."===t.row.status||!t.row.enabled,size:"is-small"},on:{click:function(a){return e.refresh(t.row)}}},[a("b-icon",{attrs:{pack:"fas",icon:"sync",size:"is-small","custom-class":"Running..."===t.row.status?"fa-spin":""}})],1)],1)]}}])})],1),a("br"),a("br"),a("div",{staticClass:"oneshot"},[a("p",{staticClass:"title"},[e._v("One-shot")]),a("p",{staticClass:"subtitle"},[e._v("Analytics that are triggered manually on specific observable types.")]),a("b-table",{attrs:{data:e.oneshot,"default-sort":"group",narrowed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"group",label:"Grouping",sortable:""}},[e._v(" "+e._s(t.row.group)+" ")]),a("b-table-column",{attrs:{field:"name",label:"Name",sortable:""}},[a("strong",[e._v(e._s(t.row.name))])]),a("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[a("b-taglist",e._l(t.row.acts_on,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(" "+e._s(t.row.description)+" "),t.row.available?e._e():a("span",{staticClass:"setting-warning"},[e._v(" This plugin requires settings that are not yet defined. ")])]),a("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[a("div",{staticClass:"toggle",on:{click:function(a){return e.toggle(t.row,"oneshot")}}},[a("b-switch",{model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"analytics.row.enabled"}})],1)])]}}])})],1),a("br"),a("br"),a("div",{staticClass:"scheduled"},[a("p",{staticClass:"title"},[e._v("Inline")]),a("p",{staticClass:"subtitle"},[e._v("Analytics that trigger when an observable is added to the Yeti database.")]),a("b-table",{attrs:{data:e.inline,narrowed:"","default-sort":"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name"}},[a("strong",[e._v(e._s(t.row.name))])]),a("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[a("b-taglist",e._l(t.row.acts_on,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(t.row.description))]),a("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[a("div",{staticClass:"toggle",on:{click:function(a){return e.toggle(t.row,"inline")}}},[a("b-switch",{model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"analytics.row.enabled"}})],1)])]}}])})],1)])},_e=[],ye={name:"AnalyticsList",data:function(){return{scheduled:[],oneshot:[],inline:[]}},methods:{getAnalytics:function(e){var t=this;w.a.get("/api/analytics/".concat(e,"/")).then((function(a){t[e]=a.data})).catch((function(e){console.log(e)})).finally((function(){}))},toggle:function(e,t){w.a.post("/api/analytics/".concat(t,"/").concat(e.id,"/toggle")).then((function(t){e.enabled=t.data.status})).catch((function(e){console.log(e)})).finally((function(){}))},refresh:function(e){w.a.post("/api/analytics/scheduled/".concat(e.id,"/refresh")).then((function(){})).catch((function(e){console.log(e)})).finally((function(){})),console.log(e)},isRunning:function(e){return"Running..."===e.status},getRowClass:function(e){return e.enabled?"OK"===e.status?"is-success":"ERROR"===e.status?"is-danger":void 0:"disabled"}},mounted:function(){this.getAnalytics("scheduled"),this.getAnalytics("oneshot"),this.getAnalytics("inline")}},we=ye,xe=(a("f7ed"),Object(u["a"])(we,ve,_e,!1,null,"7807cb50",null)),ke=xe.exports,Ce=function(){var e=this,t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-9 exportlist"},[s("b-table",{attrs:{data:t.exports,hoverable:!0,narrowed:!0,"row-class":t.getRowClass},on:{click:function(t){return e.selectedExport=JSON.parse(JSON.stringify(t))}},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{field:"name",label:"Name"}},[s("strong",[t._v(t._s(e.row.name))])]),s("b-table-column",{attrs:{field:"frequency",label:"Runs every"}},[t._v(t._s(e.row.frequency))]),s("b-table-column",{attrs:{field:"last_run",label:"Last run"}},[t._v(t._s(e.row.last_run||"Never"))]),s("b-table-column",{attrs:{field:"description",label:"Description"}},[t._v(t._s(e.row.description))]),s("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[t._v(t._s(e.row.acts_on))]),s("b-table-column",{attrs:{field:"ignore",label:"Ignore"}},[s("b-taglist",t._l(e.row.ignore_tags,(function(e){return s("b-tag",{key:e},[t._v(t._s(e))])})),1)],1),s("b-table-column",{attrs:{field:"include",label:"include"}},[s("b-taglist",t._l(e.row.include_tags,(function(e){return s("b-tag",{key:e},[t._v(t._s(e))])})),1)],1),s("b-table-column",{attrs:{field:"exclude",label:"exclude"}},[s("b-taglist",t._l(e.row.exclude_tags,(function(e){return s("b-tag",{key:e},[t._v(t._s(e))])})),1)],1),s("b-table-column",{attrs:{field:"singleExport.template",label:"Template"}},[t._v(t._s(e.row.template))]),s("b-table-column",{attrs:{field:"status",label:"Status"}},[t._v(t._s(e.row.status||"N/A"))]),s("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[s("div",{staticClass:"toggle",on:{click:function(a){return t.toggle(e.row)}}},[s("b-switch",{attrs:{disabled:"Updating..."===e.row.status},model:{value:e.row.enabled,callback:function(a){t.$set(e.row,"enabled",a)},expression:"singleExport.row.enabled"}})],1)]),s("b-table-column",{attrs:{field:"refresh","custom-key":"refresh"}},[s("b-button",{attrs:{disabled:"Updating..."===e.row.status||!e.row.enabled,size:"is-small"},on:{click:function(a){return t.refresh(e.row)}}},[s("b-icon",{attrs:{disabled:!e.row.enabled,pack:"fas",icon:"sync",size:"is-small","custom-class":"Updating..."===e.row.status?"fa-spin":""}})],1)],1),s("b-table-column",{attrs:{field:"download","custom-key":"download"}},[s("b-button",{attrs:{disabled:!e.row.enabled,type:"is-link","icon-left":"file-download",size:"is-small"},on:{click:function(a){return t.downloadExport(e.row)}}})],1)]}}])})],1),s("div",{staticClass:"column is-3"},[s("b-field",{attrs:{label:"Name"}},[s("b-input",{ref:"exportName",attrs:{required:""},model:{value:t.selectedExport.name,callback:function(e){t.$set(t.selectedExport,"name",e)},expression:"selectedExport.name"}})],1),s("b-field",{attrs:{label:"Description"}},[s("b-input",{model:{value:t.selectedExport.description,callback:function(e){t.$set(t.selectedExport,"description",e)},expression:"selectedExport.description"}})],1),s("b-field",{attrs:{label:"Include tags"}},[s("yeti-tag-input",{model:{value:t.selectedExport.include_tags,callback:function(e){t.$set(t.selectedExport,"include_tags",e)},expression:"selectedExport.include_tags"}})],1),s("b-field",{attrs:{label:"Ignore tags"}},[s("yeti-tag-input",{model:{value:t.selectedExport.ignore_tags,callback:function(e){t.$set(t.selectedExport,"ignore_tags",e)},expression:"selectedExport.ignore_tags"}})],1),s("b-field",{attrs:{label:"Exclude tags"}},[s("yeti-tag-input",{model:{value:t.selectedExport.exclude_tags,callback:function(e){t.$set(t.selectedExport,"exclude_tags",e)},expression:"selectedExport.exclude_tags"}})],1),s("b-field",[s("b-select",{ref:"exportActsOn",attrs:{placeholder:"Select type to export",required:"",expanded:""},model:{value:t.selectedExport.acts_on,callback:function(e){t.$set(t.selectedExport,"acts_on",e)},expression:"selectedExport.acts_on"}},t._l(Object.keys(t.defaultTypes),(function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(t.defaultTypes[e]))])})),0)],1),s("b-field",[s("b-select",{ref:"exportTemplate",attrs:{placeholder:"Select template to use",required:"",expanded:""},model:{value:t.selectedExport.template,callback:function(e){t.$set(t.selectedExport,"template",e)},expression:"selectedExport.template"}},t._l(t.exportTemplates,(function(e){return s("option",{key:e},[t._v(t._s(e))])})),0)],1),s("b-field",{attrs:{grouped:""}},[t.selectedExport.id?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:t.updateExport}},[t._v("Save changes")])]):t._e(),t.selectedExport.id?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:t.confirmDeleteExport}},[t._v("Delete export")])]):t._e(),t.selectedExport.id?t._e():s("p",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:t.updateExport}},[t._v("Add new export")])]),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-light",on:{click:function(e){t.selectedExport={}}}},[t._v("Clear form")])])])],1)])},Te=[],Ee=(a("a4d3"),a("e01a"),{Ip:"IP",AutonomousSystem:"Autonomous System",Url:"URL",Hostname:"Hostname",Hash:"Hash",File:"File",Certificate:"Certificate",CertificateSubject:"Certificate Subject",Email:"Email",Text:"Text",Bitcoin:"Bitcoin address",Path:"Path",MacAddress:"MAC address"}),Se={name:"ExportList",components:{YetiTagInput:A},data:function(){return{defaultTypes:Ee,exports:[],exportTemplates:[],newExport:{},selectedExport:{},timerListExports:null,timerListTemplates:null}},mounted:function(){this.listExports(),this.listExportTemplates()},created:function(){this.timerListExports=setInterval(this.listExports,5e3),this.timerListTemplates=setInterval(this.listExportTemplates,2e3)},beforeDestroy:function(){clearInterval(this.timerListExports),clearInterval(this.timerListTemplates)},methods:{toggle:function(e){console.log(e);var t="/api/export/"+e.id+"/toggle";w.a.post(t).then((function(){})).catch((function(e){console.log(e)}))},listExports:function(){var e=this;w.a.get("/api/export/").then((function(t){return e.exports=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},listExportTemplates:function(){var e=this;w.a.get("/api/exporttemplate/").then((function(t){return e.exportTemplates=t.data.map((function(e){return e.name}))})).catch((function(e){console.log(e)})).finally((function(){}))},refresh:function(e){var t="/api/export/"+e.id+"/refresh";w.a.post(t).then((function(){})).catch((function(e){console.log(e)}))},isRefreshing:function(e){return"Updating..."===e.status},getRowClass:function(e){return e.enabled?"OK"===e.status?"is-success":void 0:"disabled"},updateExport:function(){var e=this,t=this.$refs.exportActsOn.checkHtml5Validity();if(t&=this.$refs.exportTemplate.checkHtml5Validity(),t&=this.$refs.exportName.checkHtml5Validity(),!t)return!1;var a={acts_on:this.selectedExport.acts_on,description:this.selectedExport.description,name:this.selectedExport.name,template:this.selectedExport.template};this.selectedExport.exclude_tags||(this.selectedExport.exclude_tags=[]),this.selectedExport.ignore_tags||(this.selectedExport.ignore_tags=[]),this.selectedExport.include_tags||(this.selectedExport.include_tags=[]),a.exclude_tags=this.selectedExport.exclude_tags.map((function(e){return e.name||e})),a.ignore_tags=this.selectedExport.ignore_tags.map((function(e){return e.name||e})),a.include_tags=this.selectedExport.include_tags.map((function(e){return e.name||e})),w.a.post("/api/export/".concat(this.selectedExport.id||""),a).then((function(){return e.listExports()})).catch((function(e){return console.log(e)})).finally((function(){}))},confirmDeleteExport:function(){this.$buefy.dialog.confirm({title:"Delete export",message:"You're about to <b>delete</b> export <code>".concat(this.selectedExport.name,"</code>. Proceed?"),confirmText:"Delete Export",type:"is-danger",hasIcon:!0,onConfirm:this.deleteExport})},deleteExport:function(){var e=this;w.a.delete("/api/export/".concat(this.selectedExport.id)).then((function(){e.listExports(),e.selectedExport={}})).catch((function(e){return console.log(e)})).finally((function(){}))},downloadExport:function(e){w.a.get("/api/export/".concat(e.id,"/content")).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a"),s=e.headers["content-disposition"].split("filename=")[1];a.href=t,a.setAttribute("download",s),document.body.appendChild(a),a.click()})).catch((function(e){console.log(e)}))}}},Pe=Se,Ae=(a("e1d9"),Object(u["a"])(Pe,Ce,Te,!1,null,"c037de8a",null)),Oe=Ae.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-4"},[a("b-table",{attrs:{data:e.templates,hoverable:!0,narrowed:!0},on:{click:e.selectTemplate},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Name"}},[e._v(" "+e._s(t.row.name)+" ")]),a("b-table-column",{attrs:{field:"id",label:"ID"}},[e._v(" "+e._s(t.row.id)+" ")])]}}])})],1),a("div",{staticClass:"column is-8"},[a("b-field",{attrs:{label:"Name"}},[a("b-input",{ref:"templateName",attrs:{required:""},model:{value:e.templateName,callback:function(t){e.templateName=t},expression:"templateName"}})],1),a("b-field",{attrs:{label:"Template content"}},[a("b-input",{ref:"templateContent",attrs:{required:"",type:"textarea"},model:{value:e.templateContent,callback:function(t){e.templateContent=t},expression:"templateContent"}})],1),a("b-field",{attrs:{grouped:""}},[e.templateId?a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.updateTemplate}},[e._v("Save changes")])]):e._e(),e.templateId?a("p",{staticClass:"control"},[a("button",{staticClass:"button is-danger",on:{click:e.confirmDeleteTemplate}},[e._v("Delete template")])]):e._e(),e.templateId?e._e():a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.updateTemplate}},[e._v("Add new template")])]),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-light",on:{click:e.deselectTemplate}},[e._v("Clear form")])])]),e._v(" Example template body: "),e._m(0)],1)])},Ie=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{pre:!0},[a("pre",[e._v("<arbitrary>\n{% for obs in elements %}{{ obs.value }}\n{% endfor %}\n</arbitrary>")])])}],Ue={name:"TemplateList",data:function(){return{templates:[],templateName:null,templateContent:null,templateId:null}},mounted:function(){this.listExportTemplates()},methods:{listExportTemplates:function(){var e=this;w.a.get("/api/exporttemplate/").then((function(t){e.templates=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},selectTemplate:function(e){this.templateName=e.name,this.templateContent=e.template,this.templateId=e.id},deselectTemplate:function(){this.templateName=this.templateContent=this.templateId=null},updateTemplate:function(){var e=this,t=this.$refs.templateName.checkHtml5Validity();if(t&=this.$refs.templateContent.checkHtml5Validity(),t){var a={name:this.templateName,template:this.templateContent};w.a.post("/api/exporttemplate/".concat(this.templateId||""),a).then((function(){e.deselectTemplate(),e.listExportTemplates()})).catch((function(e){console.log(e)})).finally((function(){}))}},confirmDeleteTemplate:function(){this.$buefy.dialog.confirm({title:"Delete template",message:"You're about to <b>delete</b> Template <code>".concat(this.templateName,"</code>. Proceed?"),confirmText:"Delete template",type:"is-danger",hasIcon:!0,onConfirm:this.deleteTemplate})},deleteTemplate:function(){var e=this;w.a.delete("/api/exporttemplate/".concat(this.templateId)).then((function(){e.deselectTemplate()})).catch((function(e){console.log(e)})).finally((function(){e.listExportTemplates()}))}}},Re=Ue,Ne=Object(u["a"])(Re,$e,Ie,!1,null,null,null),je=Ne.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-7"},[a("div",{staticClass:"card"},[e._m(0),a("div",{staticClass:"card-content"},[e.profile?a("table",{staticClass:"table is-fullwidth"},[a("tbody",[a("tr",[a("th",[e._v("Username")]),a("td",[e._v(e._s(e.profile.username))]),a("td")]),a("tr",[a("th",[e._v("API key")]),a("td",[a("code",[e._v(e._s(e.profile.api_key))])]),a("td",[a("b-button",{staticClass:"button is-outline reset-button",attrs:{size:"is-small"},on:{click:function(t){return e.resetApiKey(e.profile)}}},[a("span",[e._v("Reset key")])])],1)]),a("tr",[a("th",[e._v("Groups")]),a("td",[a("b-taglist",e._l(e.profile.groups,(function(t){return a("b-tag",{key:t.groupname,attrs:{type:"is-info"}},[e._v(" "+e._s(t.groupname)+" ")])})),1)],1)])])]):e._e()])])]),a("div",{staticClass:"column is-5"},[a("div",{staticClass:"card"},[e._m(1),"local"===e.systemAuth?a("div",{staticClass:"card-content"},[a("b-field",[a("b-input",{attrs:{type:"password",placeholder:"Current password"},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}})],1),a("b-field",[a("b-input",{attrs:{type:"password",placeholder:"New password","password-reveal":""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),a("p",{staticClass:"control"},[a("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.changeUserPassword()}}},[e._v("Save")])],1)],1):e._e(),"oidc"===e.systemAuth?a("div",{staticClass:"card-content"},[e._v(" Authentication is handled by Open ID Connect. There is no password to change. ")]):e._e()])])]),a("div",{staticClass:"columns"},[e.profile?a("div",{staticClass:"column"},[a("b-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("b-tab-item",{attrs:{label:"Permissions"}},[a("table",{staticClass:"table is-fullwidth"},[a("tbody",[a("tr",[a("th",[e._v("Permission type")]),a("th",[e._v("Read")]),a("th",[e._v("Write")]),a("th",[e._v("Refresh")]),a("th",[e._v("Toggle")])]),e._l(Object.keys(e.profile.permissions),(function(t){return a("tr",{key:t},[a("td",[e._v(e._s(t))]),a("td",[a("b-checkbox",{attrs:{disabled:null==e.profile.permissions[t].read||!e.isAdmin},model:{value:e.profile.permissions[t].read,callback:function(a){e.$set(e.profile.permissions[t],"read",a)},expression:"profile.permissions[type].read"}})],1),a("td",[a("b-checkbox",{attrs:{disabled:null==e.profile.permissions[t].write||!e.isAdmin},model:{value:e.profile.permissions[t].write,callback:function(a){e.$set(e.profile.permissions[t],"write",a)},expression:"profile.permissions[type].write"}})],1),a("td",[a("b-checkbox",{attrs:{disabled:null==e.profile.permissions[t].refresh||!e.isAdmin},model:{value:e.profile.permissions[t].refresh,callback:function(a){e.$set(e.profile.permissions[t],"refresh",a)},expression:"profile.permissions[type].refresh"}})],1),a("td",[a("b-checkbox",{attrs:{disabled:null==e.profile.permissions[t].toggle||!e.isAdmin},model:{value:e.profile.permissions[t].toggle,callback:function(a){e.$set(e.profile.permissions[t],"toggle",a)},expression:"profile.permissions[type].toggle"}})],1)])}))],2)]),a("p",{staticClass:"control"},[e.isAdmin?a("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.saveUserPermissions()}}},[e._v("Save permissions")]):e._e()],1)]),a("b-tab-item",{attrs:{label:"Misc settings"}},[a("p",{staticClass:"title is-4"},[e._v("Miscellaneous settings")]),a("p",{staticClass:"subtitle is-6"},[e._v(" Any Yeti object can register per-user settings for specific tweaking. This is especially useful for API keys or individual credentials. ")]),e._l(Object.keys(e.profile.available_settings),(function(t){return a("b-field",{key:e.profile.available_settings[t].name,attrs:{label:e.profile.available_settings[t].name}},[a("b-input",{attrs:{placeholder:e.profile.available_settings[t].description},model:{value:e.profile.settings[t],callback:function(a){e.$set(e.profile.settings,t,a)},expression:"profile.settings[setting_name]"}})],1)})),a("p",{staticClass:"control"},[a("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.saveUserSettings()}}},[e._v("Save settings")])],1)],2)],1)],1):e._e()])])},De=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"card-header is-info"},[a("p",{staticClass:"card-header-title"},[e._v("Profile info")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"card-header is-warning"},[a("p",{staticClass:"card-header-title"},[e._v("Change password")])])}],Fe=(a("5319"),{name:"UserProfile",data:function(){return{profile:null,currentPassword:null,newPassword:null,availableSettings:[],activeTab:0}},props:{id:{type:String,default:null}},methods:{getUserProfile:function(){var e=this;console.log("userprofile"),w.a.get(this.getEndpoint("")).then((function(t){e.profile=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},resetApiKey:function(e){var t=this;w.a.post(this.getEndpoint("reset-api")).then((function(a){e.api_key=a.data.api_key,t.$buefy.notification.open({message:"API key for user <strong>".concat(e.username,"</strong> succesfully reset."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},changeUserPassword:function(){var e=this,t={current:this.currentPassword,new:this.newPassword};w.a.post(this.getEndpoint("change-password"),t).then((function(){e.$buefy.notification.open({message:"Password succesfully changed.",type:"is-success"})})).catch((function(t){e.$buefy.notification.open({message:"Error: "+t.response.data.error,type:"is-danger"})})).finally((function(){e.currentPassword=null,e.newPassword=null}))},saveUserSettings:function(){var e=this;w.a.post(this.getEndpoint("settings"),this.profile.settings).then((function(){e.$buefy.notification.open({message:"Settings successfully updated.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},saveUserPermissions:function(){var e=this,t="/api/useradmin/permissions";null!==this.id&&(t+="/".concat(this.id)),w.a.post(t,this.profile.permissions).then((function(t){e.profile.permissions=t.data.permissions,e.$buefy.notification.open({message:"Permissions successfully updated.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},getEndpoint:function(e){return null!==this.id?"/api/useradmin/".concat(e,"/").concat(this.id).replace("//","/"):"/api/users/".concat(e)}},computed:{isAdmin:function(){return this.$store.getters.isAdmin},tokenSubject:function(){return this.$store.getters.tokenSubject},systemAuth:function(){return this.$store.getters.appConfig.auth.module}},mounted:function(){this.getUserProfile()},watch:{id:function(){this.getUserProfile()}}}),Le=Fe,qe=(a("7c1c"),Object(u["a"])(Le,Ge,De,!1,null,"7a1084eb",null)),Me=qe.exports,ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-9"},[a("b-table",{attrs:{data:e.users,paginated:"","backend-pagination":"",total:e.totalUsers},on:{"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"username",label:"Username"}},[a("router-link",{attrs:{to:{name:"UserProfileAdmin",params:{id:t.row.id}}}},[e._v(" "+e._s(t.row.username)+" ")])],1),a("b-table-column",{attrs:{field:"api_key",label:"API key"}},[a("code",[e._v(e._s(t.row.api_key))]),a("b-button",{staticClass:"button is-outline reset-button",attrs:{size:"is-small"},on:{click:function(a){return e.resetApiKey(t.row)}}},[a("span",[e._v("Reset key")])])],1),a("b-table-column",{attrs:{field:"admin",label:"Admin"}},[a("b-checkbox",{nativeOn:{click:function(a){return e.toggleAdminUser(t.row)}},model:{value:t.row.permissions.admin,callback:function(a){e.$set(t.row.permissions,"admin",a)},expression:"user.row.permissions.admin"}})],1),a("b-table-column",{attrs:{field:"enabled",label:"Enabled"}},[a("b-checkbox",{nativeOn:{click:function(a){return e.toggleUser(t.row)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"user.row.enabled"}})],1),a("b-table-column",{attrs:{"custom-key":"remove",label:"Remove"}},[a("b-button",{staticClass:"button is-warning",attrs:{size:"is-small"},on:{click:function(a){return e.confirmDeleteUser(t.row)}}},[a("b-icon",{attrs:{pack:"fas",icon:"trash-alt",size:"is-small"}}),a("span",[e._v("Remove")])],1)],1)]}}])})],1),a("div",{staticClass:"column is-3"},[a("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("b-tab-item",{attrs:{label:"Search users"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"field"},[a("b-input",{attrs:{type:"text",placeholder:"Filter user list",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.listUsers(t)}},model:{value:e.userFilter,callback:function(t){e.userFilter=t},expression:"userFilter"}})],1)]),a("br"),a("article",{staticClass:"message tip"},[a("div",{staticClass:"message-body content"},[a("p",[e._v(" You can reset a user's API key by clicking on the "),a("code",[e._v("reset")]),e._v(" button. ")]),a("p",[e._v(" To temporarily prevent a user from logging in, you can disable their account by clicking on the checkbox ")]),a("p",[a("strong",[e._v("Warning")]),e._v(": Removing users cannot be undone")])])])]),a("b-tab-item",{attrs:{label:"Add user"}},[a("form",[a("b-field",{attrs:{label:"Username"}},[a("b-input",{model:{value:e.newUsername,callback:function(t){e.newUsername=t},expression:"newUsername"}})],1),a("b-field",{attrs:{label:"Password"}},[a("b-input",{model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),a("b-field",{attrs:{grouped:""}},[a("b-checkbox",{staticClass:"control",model:{value:e.newAdmin,callback:function(t){e.newAdmin=t},expression:"newAdmin"}},[e._v("Admin")]),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.addUser}},[e._v("Add user")])])],1)],1),a("br"),a("article",{staticClass:"message tip"},[a("div",{staticClass:"message-body content"},[a("p",[e._v(" The "),a("code",[e._v("yeti")]),e._v(" user exists to enable anonymous access to Yeti. Disable it after logging in as a new user if you only want to allow authenticated access. ")])])])])],1)],1)])},Ye=[],He={name:"UserAdmin",data:function(){return{users:[],userFilter:"",page:1,totalUsers:100,activeTab:1,newUsername:null,newPassword:null,newAdmin:!1}},mounted:function(){this.listUsers(),this.getTotalUsers()},methods:{listUsers:function(){var e=this,t=this.searchParams;w.a.post("/api/useradminsearch/",t).then((function(t){e.users=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},onPageChange:function(e){this.page=e,this.listUsers()},getTotalUsers:function(){var e=this,t=this.searchParams;w.a.post("/api/useradminsearch/total",t).then((function(t){e.totalUsers=t.data.total})).catch((function(e){console.log(e)})).finally((function(){}))},clearForm:function(){this.newUsername=this.newPassword=null,this.newAdmin=!1},addUser:function(e){var t=this;e.preventDefault(),w.a.post("/api/createuser",{username:this.newUsername,password:this.newPassword,admin:this.newAdmin}).then((function(e){t.getTotalUsers(),t.listUsers(),t.clearForm(),t.$buefy.notification.open({message:"Success! User <strong>".concat(e.data.username,"</strong> succesfully added."),type:"is-success"})})).catch((function(e){t.$buefy.notification.open({message:"Error: "+e.response.data.error,type:"is-danger"})})).finally((function(){}))},toggleUser:function(e){var t=this;w.a.post("/api/useradmin/toggle/".concat(e.id)).then((function(){t.$buefy.notification.open({message:"Changes saved.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},toggleAdminUser:function(e){var t=this;w.a.post("/api/useradmin/toggle-admin/".concat(e.id)).then((function(){t.$buefy.notification.open({message:"Changes saved.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},confirmDeleteUser:function(e){var t=this;this.$buefy.dialog.confirm({title:"Delete User",message:"You're about to <strong>delete</strong> user <code>".concat(e.username,"</code>. Proceed?"),confirmText:"Delete User",type:"is-danger",hasIcon:!0,onConfirm:function(){t.deleteUser(e)}})},deleteUser:function(e){var t=this;w.a.post("/api/useradmin/remove/".concat(e.id)).then((function(){t.getTotalUsers(),t.listUsers(),t.$buefy.notification.open({message:"User <strong>".concat(e.username,"</strong> succesfully deleted."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},resetApiKey:function(e){var t=this;w.a.post("/api/useradmin/reset-api/".concat(e.id)).then((function(a){e.api_key=a.data.api_key,t.$buefy.notification.open({message:"API key for user <strong>".concat(e.username,"</strong> succesfully reset."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))}},computed:{searchParams:function(){var e={params:{page:this.page,regex:!0,ignorecase:!0}};return this.userFilter&&(e.filter={username:this.userFilter}),e}}},Qe=He,Be=(a("6996"),Object(u["a"])(Qe,ze,Ye,!1,null,null,null)),Ve=Be.exports,We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-8"},[a("b-table",{staticClass:"group-table",attrs:{data:e.groups,paginated:"","backend-pagination":"",hoverable:"",total:e.totalGroups},on:{"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"groupname",label:"Group name"}},[e._v(e._s(t.row.groupname))]),a("b-table-column",{attrs:{field:"enabled",label:"Enabled"}},[a("b-checkbox",{nativeOn:{click:function(a){return e.toggleGroup(t.row)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"group.row.enabled"}})],1),a("b-table-column",{attrs:{"custom-key":"edit",label:"",width:"60"}},[a("b-icon",{attrs:{pack:"fas",icon:"edit"},nativeOn:{click:function(a){return e.editGroup(t.row)}}})],1),a("b-table-column",{attrs:{"custom-key":"remove",label:"",width:"60"}},[a("b-icon",{attrs:{pack:"fas",icon:"trash-alt",type:"is-danger"},nativeOn:{click:function(a){return e.confirmDeleteGroup(t.row)}}})],1)]}}])})],1),a("div",{staticClass:"column is-4"},[a("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("b-tab-item",{attrs:{label:"Search groups"}},[a("div",{staticClass:"search"},[a("div",{staticClass:"field"},[a("b-input",{attrs:{type:"text",placeholder:"Filter group list",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.listGroups(t)}},model:{value:e.groupFilter,callback:function(t){e.groupFilter=t},expression:"groupFilter"}})],1)]),a("br")]),a("b-tab-item",{attrs:{label:"Add group"}},[a("form",[a("b-field",{attrs:{label:"Group name"}},[a("b-input",{model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}})],1),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.addGroup}},[e._v("Add group")])])],1),a("br")]),a("b-tab-item",{attrs:{label:"Edit group"}},[a("edit-group",{attrs:{groupId:e.selectedGroup}})],1)],1)],1)])},Ke=[],Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.group?a("div",[a("h1",{staticClass:"is-size-4"},[e._v(" Editing group: "),a("b",{staticClass:"has-text-weight-medium"},[e._v(e._s(e.group.groupname))])]),a("br"),a("b-field",{attrs:{label:""}},[a("b-autocomplete",{attrs:{data:e.users,placeholder:"Search for users to add",icon:"search",clearable:"",field:"username"},on:{select:function(t){return e.addMember(t)}},nativeOn:{keyup:[function(t){return e.listUsers(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:function(){return e.addMember(e.findUser(e.username))}()}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}},[a("template",{slot:"empty"},[e._v("No results found")])],2)],1),a("b-table",{staticClass:"group-members",attrs:{data:e.group.members},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b-table-column",{attrs:{field:"name",label:"Username"}},[e._v(e._s(t.row.username))]),a("b-table-column",{attrs:{field:"admin",label:"Is admin?"}},[a("b-checkbox",{attrs:{value:e.isGroupAdmin(t.row)},nativeOn:{click:function(a){return e.toggleAdmin(t.row)}}})],1),a("b-table-column",{attrs:{field:"remove",label:"",width:"60"}},[a("b-icon",{attrs:{pack:"fas",icon:"minus-circle",type:"is-danger"},nativeOn:{click:function(a){return e.removeMember(t.row)}}})],1)]}}],null,!1,4025472522)})],1):e._e()},Ze=[],Xe=(a("7db0"),{name:"EditGroup",props:["groupId"],data:function(){return{group:null,users:[],username:null,selected:null}},mounted:function(){this.listUsers()},methods:{getGroupDetails:function(){var e=this;w.a.get("/api/groupadmin/".concat(this.groupId)).then((function(t){e.group=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},isGroupAdmin:function(e){return this.group.admins.map((function(e){return e.id})).indexOf(e.id)>=0},findUser:function(e){return this.users.find((function(t){return t.username===e}))},addMember:function(e){var t=this;if(console.log(e),null!==e){var a={uid:e.id,gid:this.group.id};w.a.post("/api/groupadmin/add-member",a).then((function(a){t.group=a.data,t.$buefy.notification.open({message:"Member <strong>".concat(e.username,"</strong> succesfully added to <strong>").concat(t.group.groupname,"</strong>."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))}},removeMember:function(e){var t=this,a={uid:e.id,gid:this.group.id};w.a.post("/api/groupadmin/remove-member",a).then((function(a){t.group=a.data,t.$buefy.notification.open({message:"Member <strong>".concat(e.username,"</strong> succesfully removed from <strong>").concat(t.group.groupname,"</strong>."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},listUsers:function(){var e=this;w.a.post("/api/useradminsearch/",this.searchParams).then((function(t){e.users=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},toggleAdmin:function(e){var t={uid:e.id,gid:this.group.id};w.a.post("/api/groupadmin/toggle-admin",t).then((function(e){console.log(e)})).catch((function(e){console.log(e)})).finally((function(){}))}},computed:{searchParams:function(){var e={params:{page:1,regex:!0,ignorecase:!0}};return this.username&&(e.filter={username:this.username}),e}},watch:{groupId:"getGroupDetails"}}),et=Xe,tt=(a("fbaf"),Object(u["a"])(et,Je,Ze,!1,null,"16fff3cb",null)),at=tt.exports,st={name:"GroupAdmin",components:{EditGroup:at},data:function(){return{groups:[],totalGroups:500,page:1,activeTab:0,newGroupName:null,groupFilter:null,selectedGroup:null}},mounted:function(){this.listGroups(),this.getTotalGroups()},methods:{listGroups:function(){var e=this,t=this.searchParams;w.a.post("/api/groupadminsearch/",t).then((function(t){e.groups=t.data})).catch((function(e){console.log(e)})).finally((function(){}))},onPageChange:function(e){this.page=e,this.listGroups()},toggleGroup:function(e){var t=this;w.a.post("/api/groupadmin/toggle/".concat(e.id)).then((function(){t.$buefy.notification.open({message:"Changes saved.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},confirmDeleteGroup:function(e){var t=this;this.$buefy.dialog.confirm({title:"Delete group",message:"You're about to <strong>delete</strong> group <code>".concat(e.groupname,"</code>. Proceed?"),confirmText:"Delete group",type:"is-danger",hasIcon:!0,onConfirm:function(){t.deleteGroup(e)}})},deleteGroup:function(e){var t=this;w.a.delete("/api/groupadmin/".concat(e.id)).then((function(){t.getTotalGroups(),t.listGroups(),t.$buefy.notification.open({message:"Group <strong>".concat(e.groupname,"</strong> succesfully deleted."),type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){}))},getTotalGroups:function(){var e=this;w.a.post("/api/groupadminsearch/total",this.searchParams).then((function(t){e.totalGroups=t.data.total})).catch((function(e){console.log(e)})).finally((function(){}))},addGroup:function(e){var t=this;e.preventDefault(),w.a.post("/api/creategroup",{groupname:this.newGroupName}).then((function(e){t.getTotalGroups(),t.listGroups(),t.clearForm(),t.$buefy.notification.open({message:"Success! Group <strong>".concat(e.data.groupname,"</strong> succesfully added."),type:"is-success"})})).catch((function(e){t.$buefy.notification.open({message:"Error: "+e.response.data.error,type:"is-danger"})})).finally((function(){}))},clearForm:function(){this.newGroupName=null},editGroup:function(e){this.activeTab=2,this.selectedGroup=e.id}},computed:{searchParams:function(){var e={params:{page:this.page,regex:!0,ignorecase:!0}};return this.groupFilter&&(e.filter={groupname:this.groupFilter}),e}}},nt=st,it=(a("e442"),Object(u["a"])(nt,We,Ke,!1,null,"64b0dae0",null)),ot=it.exports,lt=function(){var e=this,t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-9"},[s("b-table",{attrs:{data:t.tags,total:t.tableTotal,"backend-pagination":"",loading:t.loading,perPage:50,paginated:"",hoverable:!0,narrowed:!0,"current-page":t.tablePage},on:{click:function(t){return e.selectedTag=JSON.parse(JSON.stringify(t))},"page-change":t.onPageChange},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{field:"name",label:"name"}},[s("b-tag",[t._v(t._s(e.row.name))])],1),s("b-table-column",{attrs:{field:"default_expiration",label:"Default expiration"}},[t._v(" "+t._s(e.row.default_expiration)+" ")]),s("b-table-column",{attrs:{field:"count",label:"Count"}},[t._v(t._s(e.row.count))]),s("b-table-column",{attrs:{field:"produces",label:"Produces"}},[s("b-taglist",t._l(e.row.produces,(function(e){return s("b-tag",{key:e},[t._v(" "+t._s(e)+" ")])})),1)],1),s("b-table-column",{attrs:{field:"replaces",label:"Replaces"}},[s("b-taglist",t._l(e.row.replaces,(function(e){return s("b-tag",{key:e},[t._v(" "+t._s(e)+" ")])})),1)],1),s("b-table-column",{attrs:{field:"created",label:"Created"}},[t._v(t._s(e.row.created))])]}}])})],1),s("div",{staticClass:"column is-3"},[s("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[s("b-tab-item",{attrs:{label:"Edit tag"}},[s("b-field",{attrs:{label:"Name"}},[s("b-input",{model:{value:t.selectedTag.name,callback:function(e){t.$set(t.selectedTag,"name",e)},expression:"selectedTag.name"}})],1),s("b-field",{attrs:{label:"Produced tags"}},[s("yeti-tag-input",{model:{value:t.selectedTag.produces,callback:function(e){t.$set(t.selectedTag,"produces",e)},expression:"selectedTag.produces"}})],1),s("b-field",{attrs:{label:"Replaces"}},[s("yeti-tag-input",{model:{value:t.selectedTag.replaces,callback:function(e){t.$set(t.selectedTag,"replaces",e)},expression:"selectedTag.replaces"}})],1),s("b-field",{attrs:{label:"Expiration (seconds)"}},[s("b-input",{model:{value:t.selectedTag.default_expiration,callback:function(e){t.$set(t.selectedTag,"default_expiration",e)},expression:"selectedTag.default_expiration"}})],1),s("b-field",{attrs:{grouped:""}},[t.selectedTag.id?s("p",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:t.updateTag}},[t._v("Save changes")])]):t._e(),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-light",on:{click:function(e){t.selectedTag={}}}},[t._v("Clear form")])])])],1),s("b-tab-item",{attrs:{label:"Merge tag"}},[s("tag-merge")],1)],1),s("b-tabs",{attrs:{position:"is-centered"}},[s("b-tab-item",{attrs:{label:"Filter tags"}},[s("b-field",{attrs:{label:"Name"}},[s("b-input",{nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchTags(e)}},model:{value:t.tagFilter,callback:function(e){t.tagFilter=e},expression:"tagFilter"}})],1)],1)],1)],1)])},rt=[],ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-field",{attrs:{label:"Merge"}},[a("yeti-tag-input",{model:{value:e.merge,callback:function(t){e.merge=t},expression:"merge"}})],1),a("b-field",{attrs:{label:"Merge into"}},[a("yeti-tag-input",{attrs:{maxtags:1},model:{value:e.mergeInto,callback:function(t){e.mergeInto=t},expression:"mergeInto"}})],1),a("b-field",[a("b-checkbox",{model:{value:e.permanent,callback:function(t){e.permanent=t},expression:"permanent"}},[e._v("Make merge permanent")])],1),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:e.mergeTags}},[e._v("Merge")])])],1)},ut=[],dt={name:"TagsMerge",components:{YetiTagInput:A},data:function(){return{merge:null,mergeInto:null,permanent:!1}},methods:{mergeTags:function(){var e=this;if(this.merge&&this.mergeInto){var t={make_dict:this.permanent,merge_into:this.mergeInto[0].name,merge:this.merge.map((function(e){return e.name}))};this.clearForm(),w.a.post("/api/tag/merge",t).then((function(){e.$buefy.notification.open({message:"Changes succesfully changed.",type:"is-success"})})).catch((function(e){console.log(e)})).finally((function(){e.clearForm()}))}},clearForm:function(){this.mergeInto=[],this.merge=[]}}},pt=dt,bt=Object(u["a"])(pt,ct,ut,!1,null,null,null),ft=bt.exports,mt={name:"TagsAdmin",components:{YetiTagInput:A,TagMerge:ft},data:function(){return{tags:[],selectedTag:{},activeTab:0,tablePage:1,tableTotal:500,loading:!1,tagFilter:""}},mounted:function(){this.searchTags()},methods:{searchTags:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a={filter:{name:this.tagFilter},params:{regex:!0,page:this.tablePage}};console.log(a),t&&this.countTotal(a),this.loading=!0,w.a.post("/api/tagsearch/",a).then((function(t){return e.tags=t.data,0===e.tags.length&&(e.tablePage=1),e.tags})).catch((function(e){return console.log(e)})).finally((function(){e.loading=!1}))},countTotal:function(e){var t=this;this.tableTotal=500,w.a.post("/api/tagsearch/total",e).then((function(e){t.tableTotal=e.data.total})).catch((function(e){console.log(e)}))},onPageChange:function(e){this.tablePage=e,this.searchTags(!1)},updateTag:function(){var e=this,t={name:this.selectedTag.name,produces:this.selectedTag.produces.map((function(e){return e.name||e})),replaces:this.selectedTag.replaces.map((function(e){return e.name||e})),default_expiration:this.selectedTag.default_expiration};w.a.post("/api/tag/".concat(this.selectedTag.id),t).then((function(){e.getTags()})).catch((function(e){console.log(e)})).finally((function(){}))}}},gt=mt,ht=Object(u["a"])(gt,lt,rt,!1,null,null,null),vt=ht.exports,_t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-6"},[a("h1",{staticClass:"is-size-2"},[e._v("Worker status")]),e.infoLoading?a("b-progress",{attrs:{size:"is-medium","show-value":""}},[e._v(" Pinging Celery workers... ")]):e._e(),e.info?a("table",{staticClass:"table is-narrow is-fullwidth"},[a("tbody",[e._m(0),e._l(Object.keys(e.info.registered),(function(t){return a("tr",{key:t},[a("td",[e._v(e._s(t))]),a("td",[a("b-taglist",e._l(e.info.registered[t].processes,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("td",[e._v(e._s(e.info.registered[t].active?"Yes":"No"))]),a("td",[a("b-button",{on:{click:function(a){return e.restartWorker(t)}}},[e._v("Restart")])],1)])}))],2)]):e._e(),e.info?a("table",{staticClass:"table is-narrow is-fullwidth"},[a("tbody",[e._m(1),e._l(Object.keys(e.info.active),(function(t){return a("tr",{key:t},[a("td",[e._v(e._s(t))]),a("td",[a("b-taglist",e._l(e.info.active[t].running,(function(t){return a("b-tag",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1)])}))],2)]):e._e(),a("div",{staticClass:"buttons"},[a("b-button",{attrs:{type:"is-danger"},on:{click:function(t){return e.restartWorker("all")}}},[e._v("Restart All workers")])],1)],1),a("div",{staticClass:"column is-6"},[a("h1",{staticClass:"is-size-2"},[e._v("System config")]),a("pre",[e._v(e._s(e.appConfig))])])])])},yt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("th",[e._v("Registered worker")]),a("th",[e._v("Process IDs")]),a("th",[e._v("Active")]),a("th",[e._v("Restart")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("th",[e._v("Workers")]),a("th",[e._v("Active tasks")])])}],wt={name:"System",data:function(){return{info:null,infoLoading:!1}},mounted:function(){this.getWorkerInfo()},methods:{getWorkerInfo:function(){var e=this;this.infoLoading=!0,w.a.get("/api/system/").then((function(t){e.info=t.data,e.infoLoading=!1})).catch((function(e){console.log(e)}))},restartWorker:function(e){var t=this;w.a.get("/api/system/restart/worker/".concat(e)).then((function(e){t.$buefy.notification.open({message:e.data.message,type:"success"==e.data.status?"is-success":"is-danger"})})).catch((function(e){console.log(e)}))}},computed:{appConfig:function(){return this.$store.getters.appConfig}}},xt=wt,kt=Object(u["a"])(xt,_t,yt,!1,null,null,null),Ct=kt.exports,Tt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-4 is-offset-4"},[a("div",{staticClass:"card is-wide has-text-centered loginform"},[a("div",{staticClass:"card-content"},[a("p",{staticClass:"title"},[e._v("Log in to Yeti")]),a("form",{on:{submit:e.logIn}},[a("b-field",{attrs:{label:"Username"}},[a("b-input",{model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1),a("b-field",{attrs:{label:"Password"}},[a("b-input",{attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("b-button",{attrs:{type:"is-primary","native-type":"submit"}},[e._v("Login")])],1)])])])])},Et=[],St={name:"Login",data:function(){return{user:null,password:null,loading:!1}},methods:{logIn:function(e){var t=this;console.log("submitted"),e.preventDefault(),this.loading=!0,this.$store.dispatch("login",{user:this.user,password:this.password}).then((function(){console.log("Successfully logged in!"),t.$router.push("/")})).catch((function(e){t.$buefy.notification.open({message:e.response.data.error,type:"is-danger"})})).finally((function(){t.loading=!1}))}}},Pt=St,At=(a("d6db"),Object(u["a"])(Pt,Tt,Et,!1,null,null,null)),Ot=At.exports,$t=a("2f62");s["a"].use($t["a"]);var It={user:null,appConfig:null},Ut={login:function(e,t){var a=e.commit;return new Promise((function(e,s){a("authRequest"),w.a.post("/api/auth/login",t).then((function(t){!0===t.data.authenticated&&(w.a.get("/api/users").then((function(e){return a("authSuccess",e.data)})),e(t))})).catch((function(e){a("authError",e),s(e)}))}))},logout:function(e){var t=e.commit;return new Promise((function(e){w.a.post("/api/auth/logout").then((function(a){t("logout"),e(a)}))}))},refresh:function(e){var t=e.commit;return new Promise((function(e,a){w.a.get("/api/users/").then((function(a){console.log("Session refresh success"),t("authSuccess",a.data),e(a)})).catch((function(e){console.log("Session refresh fail"),a(e)}))}))},getAppConfig:function(e){var t=e.commit;w.a.get("/api/system/config").then((function(e){t("setAppConfig",e.data)}))}},Rt={authRequest:function(e){e.user=null},authSuccess:function(e,t){e.user=t},authError:function(e,t){console.log(t),e.user=null},logout:function(e){e.user=null},setAppConfig:function(e,t){e.appConfig=t}},Nt={isAuthenticated:function(e){return!!e.user},isAdmin:function(e){return!!e.user&&!!e.user.permissions.admin},tokenSubject:function(e){return e.user.username},appConfig:function(e){return e.appConfig}},jt=new $t["a"].Store({state:It,actions:Ut,mutations:Rt,getters:Nt}),Gt=jt;s["a"].use(h["a"]);var Dt=[{path:"/",name:"ObservableSearch",component:L},{path:"/browse",name:"ObservableList",component:Q,props:function(e){return{searchQuery:e.query.q}}},{path:"/observable/:id([a-z0-9]{24})",name:"ObservableDetails",component:de,props:!0},{path:"/feeds",name:"Feeds",component:he},{path:"/analytics",name:"Analytics",component:ke},{path:"/exports",name:"Exports",component:Oe},{path:"/templates",name:"Templates",component:je},{path:"/profile/:id([a-z0-9]{24})",name:"UserProfileAdmin",component:Me,props:!0},{path:"/profile",name:"UserProfile",component:Me},{path:"/admin/users",name:"UserAdmin",component:Ve},{path:"/admin/groups",name:"GroupAdmin",component:ot},{path:"/admin/tags",name:"TagsAdmin",component:vt},{path:"/admin/system",name:"SystemView",component:Ct},{path:"/login",name:"Login",component:Ot}],Ft=new h["a"]({mode:"history",base:"/",linkActiveClass:"is-active",routes:Dt});Ft.beforeEach((function(e,t,a){"Login"==e.name?a():null===Gt.state.user?Gt.dispatch("refresh").then((function(){console.log("redirecting to "+e.fullPath),a({path:e.fullPath})})).catch((function(){console.log("redirecting to /auth/login"),window.location.href="/auth/login"})):a()}));var Lt=Ft,qt=a("289d"),Mt=a("ecee"),zt=a("c074"),Yt=a("ad3d");s["a"].config.productionTip=!1,Mt["c"].add(zt["a"]),s["a"].component("vue-fontawesome",Yt["a"]),s["a"].use(qt["a"],{defaultIconComponent:"vue-fontawesome",defaultIconPack:"fas"}),new s["a"]({router:Lt,store:Gt,render:function(e){return e(g)},created:function(){this.$store.dispatch("getAppConfig")}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var s=a("9c0c"),n=a.n(s);n.a},"5dfc":function(e,t,a){"use strict";var s=a("1a12"),n=a.n(s);n.a},6996:function(e,t,a){"use strict";var s=a("9fa7"),n=a.n(s);n.a},"7b8c":function(e,t,a){},"7c1c":function(e,t,a){"use strict";var s=a("c6b1"),n=a.n(s);n.a},"8ddc":function(e,t,a){},"9c02":function(e,t,a){"use strict";var s=a("29ba"),n=a.n(s);n.a},"9c0c":function(e,t,a){},"9fa7":function(e,t,a){},bb6c:function(e,t,a){},bfe7:function(e,t,a){},c378:function(e,t,a){"use strict";var s=a("7b8c"),n=a.n(s);n.a},c6b1:function(e,t,a){},d6db:function(e,t,a){"use strict";var s=a("e67a"),n=a.n(s);n.a},e1d9:function(e,t,a){"use strict";var s=a("bb6c"),n=a.n(s);n.a},e442:function(e,t,a){"use strict";var s=a("3a99"),n=a.n(s);n.a},e67a:function(e,t,a){},e7c3:function(e,t,a){"use strict";var s=a("8ddc"),n=a.n(s);n.a},efae:function(e,t,a){},f7ed:function(e,t,a){"use strict";var s=a("08a8"),n=a.n(s);n.a},fbaf:function(e,t,a){"use strict";var s=a("efae"),n=a.n(s);n.a}});
//# sourceMappingURL=app.98b8705b.js.map