(function(e){function t(t){for(var s,n,o=t[0],r=t[1],c=t[2],u=0,p=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);d&&d(t);while(p.length)p.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],s=!0,o=1;o<a.length;o++){var r=a[o];0!==i[r]&&(s=!1)}s&&(l.splice(t--,1),e=n(n.s=a[0]))}return e}var s={},i={app:0},l=[];function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=s,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=r;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"03fd":function(e,t,a){},"117f":function(e,t,a){"use strict";a("f3ec")},"1a13":function(e,t,a){},"1d39":function(e,t,a){},"1fe5":function(e,t,a){"use strict";a("692f")},"223d":function(e,t,a){},"271a":function(e,t,a){},3900:function(e,t,a){"use strict";a("856e")},"43ac":function(e,t,a){},4678:function(e,t,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(e){var t=l(e);return a(t)}function l(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=l,e.exports=i,i.id="4678"},"479b":function(e,t,a){"use strict";a("678b")},"548d":function(e,t,a){"use strict";a("271a")},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),i=function(){var e=this,t=e._self._c;return t("div",[t("navbar"),t("div",{staticClass:"container is-fluid",attrs:{id:"app"}},[t("router-view")],1)],1)},l=[],n=function(){var e=this,t=e._self._c;return t("b-navbar",{staticClass:"yeti-navbar",attrs:{shadow:!0,type:"is-dark"}},[t("template",{slot:"brand"},[t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}})],1),e.isAuthenticated?t("template",{slot:"start"},[t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[e._v("Search")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/browse"}}},[e._v("Browse observables")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/entities"}}},[e._v("Entities")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/indicators"}}},[e._v("Indicators")]),t("b-navbar-dropdown",{attrs:{label:"Scheduling"}},[t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/feeds"}}},[e._v("Feeds")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/analytics"}}},[e._v("Analytics")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/exports"}}},[e._v("Exports")])],1),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/templates"}}},[e._v("Templates")])],1):e._e(),t("template",{slot:"end"},[e.isAdmin?t("b-navbar-dropdown",{attrs:{label:"Admin"}},[t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/users"}}},[e._v("Users")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/groups"}}},[e._v("Groups")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/tags"}}},[e._v("Tags")]),t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/admin/system"}}},[e._v("System")])],1):e._e(),e.isAuthenticated?t("b-navbar-dropdown",{attrs:{label:e.tokenSubject}},[t("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/profile"}}},[e._v(" Profile ")]),e.localAuth?t("b-navbar-item",{attrs:{tag:"a"},on:{click:function(t){return e.logout()}}},[e._v(" Logout ")]):e._e()],1):e._e(),t("b-navbar-item",{attrs:{tag:"div"}},[t("div",{staticClass:"buttons"},[e.isAuthenticated?e._e():t("a",{staticClass:"button is-primary",attrs:{href:"/auth/login"}},[e._v("Log in")])])])],1)],2)},o=[],r={name:"Navbar",methods:{logout(){this.$store.dispatch("logout").then(()=>{window.location.href="/login"}),console.log("logout")}},computed:{isAuthenticated(){return this.$store.getters.isAuthenticated},isAdmin(){return this.$store.getters.isAdmin},tokenSubject(){return this.$store.getters.tokenSubject},localAuth(){var e=this.$store.getters.appConfig;return null!==e?"local"===e.auth.module:null}}},c=r,d=(a("9785"),a("2877")),u=Object(d["a"])(c,n,o,!1,null,null,null),p=u.exports,b={components:{Navbar:p}},m=b,h=(a("a5c5"),Object(d["a"])(m,i,l,!1,null,null,null)),f=h.exports,g=a("8c4f"),v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"observable-search"},[t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-one-third"},[t("h1",{staticClass:"is-size-2"},[e._v("Search & add")]),e._m(0),t("div",{staticClass:"card"},[e._m(1),t("div",{staticClass:"card-content"},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("form",{on:{submit:e.advancedSearchSubmit}},[t("b-input",{attrs:{type:"text",placeholder:"Search query + ‚èé",icon:"search"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1)])]),t("br"),e._m(2)])])]),t("div",{staticClass:"column is-two-thirds"},[t("b-field",{staticClass:"add-tags",attrs:{grouped:""}},[t("b-field",[t("b-checkbox",{staticClass:"add-missing-control",model:{value:e.addMissing,callback:function(t){e.addMissing=t},expression:"addMissing"}},[e._v("Add and tag missing observables")])],1),t("b-field",{class:{hidden:!e.addMissing}},[t("b-taginput",{attrs:{icon:"tag",placeholder:"e.g. CobaltStrike"},model:{value:e.addTags,callback:function(t){e.addTags=t},expression:"addTags"}})],1),t("b-field",{class:{hidden:!e.addMissing}},[t("b-select",{attrs:{placeholder:"Force observable type"},model:{value:e.addType,callback:function(t){e.addType=t},expression:"addType"}},[t("option",{domProps:{value:null}},[e._v("Guess type")]),e._l(Object.keys(e.defaultTypes),(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(e.defaultTypes[a])+" ")])}))],2)],1)],1),t("b-field",{attrs:{label:"Search"}},[t("b-input",{attrs:{type:"textarea"},model:{value:e.textSearch,callback:function(t){e.textSearch=t},expression:"textSearch"}})],1),t("b-field",{staticClass:"file"},[t("b-upload",{model:{value:e.uploadFile,callback:function(t){e.uploadFile=t},expression:"uploadFile"}},[t("a",{staticClass:"button is-outlined"},[t("span",[e._v("Upload file")])])]),e.uploadFile?t("span",{staticClass:"file-name"},[e._v(" "+e._s(e.uploadFile.name)+" ")]):e._e()],1),t("small",[e._v(" Uploaded file will take precedence over text. Format is the same as text, one observable per line. ")]),t("br"),t("br"),t("b-field",[t("b-button",{attrs:{"icon-left":"search",type:"is-primary"},on:{click:e.searchObservables}},[e._v("Launch search")])],1)],1)]),e.searching?t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-4 is-offset-4"},[t("b-progress",{attrs:{size:"is-medium","show-value":""}},[e._v(" Searching... ")])],1)]):e._e(),t("div",{staticClass:"columns"},[e.searchResults?t("div",{staticClass:"column"},[t("h1",{staticClass:"is-size-2"},[e._v("Search results")]),t("br"),t("search-results",{attrs:{searchResults:e.searchResults}})],1):e._e()])])},y=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("p",[t("strong",[e._v("Format")]),e._v(": one observable per line (for both text and file)")]),t("p",[e._v(" Use the checkbox to automatically "),t("strong",[e._v("add")]),e._v(" unknown observables to the database (write operation) ")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"card-header info"},[t("p",{staticClass:"card-header-title"},[e._v("Advanced search")])])},function(){var e=this,t=e._self._c;return t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" By default, the query will be matched against the "),t("code",[e._v("value")]),e._v(" attribute of the observables. To match against other attributes, use "),t("code",[e._v("attribute=query")]),e._v(". ")]),t("p",[e._v("Examples:")]),t("ul",[t("li",[t("strong",[e._v("Generic tag query")]),e._v(": "),t("code",[e._v("tags=crimeware")])]),t("li",[t("strong",[e._v("Gate URLs")]),e._v(": "),t("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),t("code",[e._v("on")]),e._v(")")]),t("li",[t("strong",[e._v("Ransomware C2s")]),e._v(": "),t("code",[e._v("tags=c2,ransomware")])]),t("li",[t("strong",[e._v("Context")]),e._v(": "),t("code",[e._v("context.source=FeodoTracker")])])])])])}],_=(a("14d9"),a("bc3a")),k=a.n(_),w=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical"},[t("div",{staticClass:"tile"},[t("div",{staticClass:"tile is-parent"},[t("div",{staticClass:"tile is-child card"},[t("header",{staticClass:"card-header warning"},[t("p",{staticClass:"card-header-title"},[t("b-icon",{attrs:{pack:"fas",icon:"crosshairs",size:"is-small"}}),e._v(" Indicator matches "),t("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.matches.length))])],1)]),e.searchResults["matches"].length?t("div",{staticClass:"card-content"},[t("b-table",{attrs:{data:e.searchResults["matches"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[t("a",{attrs:{href:"#"}},[e._v(" "+e._s(a.row.name)+" ")])]),t("b-table-column",{attrs:{field:"observable",label:"Observable"}},[t("code",[e._v(e._s(a.row.observable.value))])]),t("b-table-column",{attrs:{field:"diamond",label:"Diamond edge"}},[e._v(" "+e._s(a.row.diamond)+" ")]),t("b-table-column",{attrs:{field:"suggested_tags",label:"Suggested tags"}},[t("b-taglist",e._l(a.row.suggested_tags,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"id",label:"ID"}},[e._v(" "+e._s(a.row.id)+" ")])]}}],null,!1,2823120252)})],1):e._e()])]),t("div",{staticClass:"tile is-parent"},[t("div",{staticClass:"tile is-child card"},[t("header",{staticClass:"card-header danger"},[t("p",{staticClass:"card-header-title"},[t("b-icon",{attrs:{pack:"fas",icon:"project-diagram",size:"is-small"}}),e._v(" Related entities "),t("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.entities.length))])],1)]),e.searchResults["entities"].length?t("div",{staticClass:"card-content"},[t("b-table",{attrs:{data:e.searchResults["entities"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[t("a",{attrs:{href:"#"}},[e._v(" "+e._s(a.row.name)+" ")])]),t("b-table-column",{attrs:{field:"type",label:"Type"}},[t("code",[e._v(e._s(a.row.type))])])]}}],null,!1,36590432)})],1):e._e()])])]),t("div",{staticClass:"tile"},[t("div",{staticClass:"tile is-parent"},[t("div",{staticClass:"tile is-child card"},[t("header",{staticClass:"card-header info"},[t("p",{staticClass:"card-header-title"},[t("b-icon",{attrs:{pack:"fas",icon:"database",size:"is-small"}}),e._v(" Observables found in database "),t("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.known.length))])],1)]),e.searchResults["known"].length?t("div",{staticClass:"card-content"},[t("b-table",{attrs:{data:e.searchResults["known"],narrowed:!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"value",label:"Value"}},[t("router-link",{attrs:{to:{name:"ObservableDetails",params:{id:a.row.id}}}},[e._v(" "+e._s(a.row.value)+" ")])],1),t("b-table-column",{attrs:{field:"tags",label:"Tags"}},[t("b-taglist",e._l(a.row.tags,(function(a){return t("b-tag",{key:a.name,attrs:{type:a.fresh?"is-primary":""}},[e._v(" "+e._s(a.name)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"context",label:"Context"}},[t("b-taglist",e._l(a.row.context,(function(a){return t("b-tag",{key:a.source},[e._v(" "+e._s(a.source)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"created",label:"Created on"}},[e._v(" "+e._s(new Date(a.row.created).toISOString())+" ")])]}}],null,!1,185947723)})],1):e._e()])])]),t("div",{staticClass:"tile"},[t("div",{staticClass:"tile is-parent"},[t("div",{staticClass:"tile is-child card"},[t("header",{staticClass:"card-header light"},[t("p",{staticClass:"card-header-title"},[t("b-icon",{attrs:{pack:"fas",icon:"question",size:"is-small"}}),e._v(" Unknown observables "),t("b-tag",{attrs:{rounded:"",type:"is-dark"}},[e._v(e._s(e.searchResults.unknown.length))])],1)]),e.searchResults["unknown"].length?t("div",{staticClass:"card-content"},[t("ul",e._l(e.searchResults["unknown"],(function(a){return t("li",{key:a},[e._v(e._s(a))])})),0)]):e._e()])])])])])},x=[],C={name:"SearchResults",data(){return{}},props:["searchResults"]},T=C,j=(a("b2d4"),Object(d["a"])(T,w,x,!1,null,"2ef93083",null)),E=j.exports,O={Ip:"IP",AutonomousSystem:"Autonomous System",Url:"URL",Hostname:"Hostname",Hash:"Hash",File:"File",Certificate:"Certificate",CertificateSubject:"Certificate Subject",Email:"Email",Text:"Text",Bitcoin:"Bitcoin",Path:"Path",MacAddress:"MAC address"},S={name:"ObservableSearch",components:{SearchResults:E},data(){return{addMissing:!1,addTags:[],defaultTypes:O,addType:null,uploadFile:null,textSearch:"",searchResults:null,searchQuery:null,searching:!1,notFound:!1}},methods:{searchObservables(){this.searching=!0,this.searchResults=null;var e={observables:this.textSearch.split("\n"),add_unknown:this.addMissing,add_tags:this.addTags};k.a.post("/api/analysis/match",e).then(e=>{console.log(e),this.searchResults=e.data}).catch(e=>console.log(e)).finally(()=>{this.searching=!1})},advancedSearchSubmit(e){this.$router.push({name:"ObservableList",query:{q:this.searchQuery}}),e.preventDefault()}}},I=S,$=(a("90c7"),Object(d["a"])(I,v,y,!1,null,null,null)),P=$.exports,R=function(){var e=this,t=e._self._c;return t("div",{staticClass:"observable-list columns"},[t("div",{staticClass:"column is-three-quarters"},[t("b-table",{staticClass:"observable-table",attrs:{data:e.observables,hoverable:!0,narrowed:!0,"checked-rows":e.tableSelectedItems,checkable:"",total:e.tableTotal,perPage:e.tablePerPage,"backend-pagination":"",loading:e.loading,paginated:""},on:{"update:checkedRows":function(t){e.tableSelectedItems=t},"update:checked-rows":function(t){e.tableSelectedItems=t},"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"value",label:"Value"}},[t("router-link",{attrs:{to:{name:"ObservableDetails",params:{id:a.row.id}}}},[e._v(" "+e._s(a.row.value)+" ")])],1),t("b-table-column",{attrs:{field:"tags",label:"Tags"}},[t("b-taglist",e._l(a.row.tags,(function(a){return t("b-tag",{key:a.name,attrs:{type:a.fresh?"is-primary":""}},[e._v(" "+e._s(a.name)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"context",label:"Context"}},[t("b-taglist",e._l(new Set(a.row.context.map(e=>e.source)),(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"created",label:"Created on (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.created,!0)}},[e._v(e._s(e.formatTimestamp(a.row.created)))])]),t("b-table-column",{attrs:{field:"sources",label:"Sources"}},[t("b-taglist",e._l(a.row.sources,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1)]}}])},[t("template",{slot:"bottom-left"},[e.tableSelectedItems.length?t("div",[t("b",[e._v("Total selected")]),e._v(": "+e._s(e.tableSelectedItems.length)+" "),t("b-button",{attrs:{size:"is-small",type:"is-warning","icon-right":"ban"},on:{click:function(t){e.tableSelectedItems=[]}}},[e._v(" Clear selection ")])],1):e._e()])],2)],1),t("div",{staticClass:"column"},[t("section",[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Search"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("b-input",{attrs:{type:"text",placeholder:"Search query + ‚èé",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchObservables.apply(null,arguments)}},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1),t("div",{staticClass:"field"},[t("b-checkbox",{model:{value:e.regexSearch,callback:function(t){e.regexSearch=t},expression:"regexSearch"}},[e._v(" Use regex (slower) ")])],1)]),t("br"),t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" You can run complex queries against the database using the input field above. ")]),t("p",[e._v(" By default, the query will be matched against the "),t("code",[e._v("value")]),e._v(" attribute of the observables. To match against other attributes, use "),t("code",[e._v("attribute=query")]),e._v(". ")]),t("p",[e._v("Examples:")]),t("ul",[t("li",[t("strong",[e._v("Generic tag query")]),e._v(": "),t("code",[e._v("tags=crimeware")])]),t("li",[t("strong",[e._v("Gate URLs")]),e._v(": "),t("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),t("code",[e._v("on")]),e._v(")")]),t("li",[t("strong",[e._v("Ransomware C2s")]),e._v(": "),t("code",[e._v("tags=c2,ransomware")])]),t("li",[t("strong",[e._v("Context")]),e._v(": "),t("code",[e._v("context.source=FeodoTracker")])])])])])]),t("b-tab-item",{attrs:{label:"Export"}},[t("b-field",{attrs:{label:"Select template",message:e.totalSelectedItems+" items will be exported."}},[t("b-select",{attrs:{placeholder:"Select a template",expanded:""},model:{value:e.selectedExportTemplate,callback:function(t){e.selectedExportTemplate=t},expression:"selectedExportTemplate"}},e._l(e.exportTemplates,(function(a){return t("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),0)],1),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-primary"},on:{click:e.downloadExport}},[e._v(" Export selection ")])],1)],1),t("b-tab-item",{attrs:{label:"Bulk tag"}},[t("b-field",{attrs:{label:"Select tags",message:e.selectedTags.length+" tags will be applied to "+e.tableSelectedItems.length+" observables"}},[t("yeti-tag-input",{model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})],1),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.changeTags("tag")}}},[e._v(" Add tag ")]),t("b-button",{attrs:{type:"is-danger"},on:{click:function(t){return e.changeTags("untag")}}},[e._v(" Remove tag ")])],1)],1)],1)],1)])])},A=[],L=function(){var e=this,t=e._self._c;return t("b-taginput",{attrs:{label:"tags",data:e.filteredTags,autocomplete:"",icon:"tag",placeholder:"e.g. Zeus",field:"name",maxtags:e.maxtags,"allow-new":!0},on:{typing:e.getFilteredTags,input:e.updateSelected},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})},U=[],N=a("2ef0"),F=a.n(N),D={name:"YetiTagInput",data(){return{tagName:"",selectedTags:this.value,filteredTags:[]}},props:{value:Array,maxtags:{type:Number,default:null}},methods:{getExistingTags(){k.a.get("/api/tag/").then(e=>this.existingTags=e.data).catch(e=>console.log(e))},updateSelected(){this.selectedTags=this.selectedTags.map(e=>"string"===typeof e?{name:e}:e),this.$emit("input",this.selectedTags)},getFilteredTags:F.a.debounce((function(e){this.tagName=e;var t={filter:{name:this.tagName},params:{regex:!0,page:1}};k.a.post("/api/tagsearch/",t).then(e=>this.filteredTags=e.data).catch(e=>console.log(e))}),300)},watch:{value:function(e){this.selectedTags=e}}},z=D,G=Object(d["a"])(z,L,U,!1,null,null,null),q=G.exports,M=a("7f45"),Y=a.n(M);function Q(e,t){if(!e)return"Never";let a=Y.a.utc(e);return t?a.tz(Y.a.tz.guess()).format("YYYY-MM-DD HH:mm:ss Z"):a.format("YYYY-MM-DD HH:mm:ss")}var H={formatTimestamp:Q},B=H,K={name:"ObservableList",components:{YetiTagInput:q},props:{searchQuery:{type:String,default:""}},data(){return{regexSearch:!1,observables:[],tablePage:1,tablePerPage:50,tableTotal:500,loading:!1,tableSelectedItems:[],exportTemplates:[],selectedExportTemplate:null,selectedTags:[],activeTab:0}},mounted(){this.getExportTemplates(),this.searchObservables()},methods:{onPageChange(e){this.tablePage=e,this.searchObservables(!1)},searchObservables(e=!0){var t={filter:this.generateSearchParams(this.searchQuery),params:{regex:this.regexSearch,page:this.tablePage}};console.log(t),e&&this.countTotal(t),this.loading=!0,k.a.post("/api/observablesearch/",t).then(e=>this.observables=e.data).catch(e=>console.log(e)).finally(()=>{this.loading=!1})},generateSearchParams(e){var t={},a=e.split(" "),s="value";for(var i in a){var l=a[i].split("=");2==l.length?t[l[0]]=l[1].split(","):""!==a[i]&&(t[s]=a[i])}return t},changeTags(e){var t={tags:this.selectedTags.map(e=>e.name),ids:this.tableSelectedItems.map(e=>e.id)};k.a.post("/api/observable/bulk-"+e,t).then(()=>{this.searchObservables(),this.$buefy.notification.open(`${t.tags.length} tags succesfully ${"tag"===e?"added":"removed"}.`),this.selectedTags=[],this.tableSelectedItems=[]}).catch(e=>console.log(e))},getExportTemplates(){k.a.get("/api/exporttemplate/").then(e=>{this.exportTemplates=e.data}).catch(e=>{console.log(e)})},downloadExport(){var e={id:this.selectedExportTemplate};this.tableSelectedItems.length?e.observables=this.tableSelectedItems.map(e=>e.id):(e.query={filter:this.generateSearchParams(this.searchQuery)},e.query.params={regex:this.regexSearch,page:this.tablePage}),console.log(e),k.a.post("/api/exporttemplate/export",e).then(e=>{var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a"),s=e.headers["content-disposition"].split("filename=")[1];a.href=t,a.setAttribute("download",s),document.body.appendChild(a),a.click()}).catch(e=>{console.log(e)})},countTotal(e){this.tableTotal=500,k.a.post("/api/observablesearch/total",e).then(e=>{this.tableTotal=e.data.total}).catch(e=>{console.log(e)})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}},computed:{filterTags(){return this.existingTags.filter(e=>e.name.toString().toLowerCase().indexOf(this.tagName.toLowerCase())>=0)},totalSelectedItems(){return this.tableSelectedItems.length>0?this.tableSelectedItems.length:this.tableTotal}}},V=K,W=(a("3900"),Object(d["a"])(V,R,A,!1,null,null,null)),J=W.exports,Z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"entity-list columns"},[t("div",{staticClass:"column is-three-quarters"},[t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeMainTab,callback:function(t){e.activeMainTab=t},expression:"activeMainTab"}},e._l(e.entityTypes,(function(a){return t("b-tab-item",{key:a.type,attrs:{label:a.name}},[t("object-list",{ref:a.type+"ObjectList",refInFor:!0,attrs:{"search-type":"entity","search-subtype":a.type,fields:a.fields,"search-query":e.searchQuery}})],1)})),1)],1),t("div",{staticClass:"column"},[t("section",[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Search"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("b-input",{attrs:{type:"text",placeholder:"Search query + ‚èé",icon:"search"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1)]),t("br"),t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" You can run complex queries against the database using the input field above. ")]),t("p",[e._v(" By default, the query will be matched against the "),t("code",[e._v("value")]),e._v(" attribute of the entities. To match against other attributes, use "),t("code",[e._v("attribute=query")]),e._v(". ")]),t("p",[e._v("Examples:")]),t("ul",[t("li",[t("strong",[e._v("Generic tag query")]),e._v(": "),t("code",[e._v("tags=crimeware")])]),t("li",[t("strong",[e._v("Gate URLs")]),e._v(": "),t("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),t("code",[e._v("on")]),e._v(")")]),t("li",[t("strong",[e._v("Ransomware C2s")]),e._v(": "),t("code",[e._v("tags=c2,ransomware")])]),t("li",[t("strong",[e._v("Context")]),e._v(": "),t("code",[e._v("context.source=FeodoTracker")])])])])])]),t("b-tab-item",{attrs:{label:"New entity"}},[t("b-field",{attrs:{label:"Entity type"}},[t("b-select",{attrs:{placeholder:"Select an entity type",expanded:""},model:{value:e.selectedEntityType,callback:function(t){e.selectedEntityType=t},expression:"selectedEntityType"}},e._l(e.entityTypes,(function(a){return t("option",{key:a.name,domProps:{value:a}},[e._v(" "+e._s(a.name)+" ")])})),0)],1),e.selectedEntityType?t("div",[e._l(e.selectedEntityType.fields,(function(a){return t("b-field",{key:a.field,attrs:{label:a.label}},["text"===a.type?t("b-input",{model:{value:e.newEntity[a.field],callback:function(t){e.$set(e.newEntity,a.field,t)},expression:"newEntity[field.field]"}}):e._e(),"longtext"===a.type?t("b-input",{attrs:{type:"textarea"},model:{value:e.newEntity[a.field],callback:function(t){e.$set(e.newEntity,a.field,t)},expression:"newEntity[field.field]"}}):e._e(),"option"===a.type?t("b-select",{model:{value:e.newEntity[a.field],callback:function(t){e.$set(e.newEntity,a.field,t)},expression:"newEntity[field.field]"}},e._l(a.choices,(function(a,s){return t("option",{key:a,domProps:{value:String(s+1)}},[e._v(" "+e._s(a)+" "+e._s(s))])})),0):e._e(),"list"===a.type?t("b-taginput",{attrs:{label:"Tags",icon:"tag"},model:{value:e.newEntity[a.field],callback:function(t){e.$set(e.newEntity,a.field,t)},expression:"newEntity[field.field]"}}):e._e()],1)})),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-primary"},on:{click:e.saveEntity}},[e._v(" Save ")])],1)],2):e._e()],1)],1)],1)])])},X=[],ee=function(){var e=this,t=e._self._c;return t("b-table",{staticClass:"object-table",attrs:{data:e.objects,hoverable:!0,narrowed:!0,checkable:e.checkable,total:e.tableTotal,perPage:e.tablePerPage,"backend-pagination":"",loading:e.loading,paginated:""},on:{"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"created",label:"Created on (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.created,!0)}},[e._v(e._s(e.formatTimestamp(a.row.created)))])]),e._l(e.fields.filter(e=>e.displayList),(function(s){return t("b-table-column",{key:s.field,attrs:{field:s.field,label:s.label}},["value"===s.field||"name"===s.field?t("span",[t("router-link",{attrs:{to:{name:"value"===s?"ObservableDetails":"EntityDetails",params:{id:a.row.id}}}},[e._v(" "+e._s(a.row[s.field])+" ")])],1):"code"===s.type||"longcode"===s.type?t("code",[e._v(" "+e._s(a.row[s.field])+" ")]):"tags"===s.field||"aliases"===s.field?t("b-taglist",e._l(a.row[s.field],(function(a){return t("b-tag",{key:a.name?a.name:a,attrs:{type:a.fresh?"is-primary":""}},[e._v(" "+e._s(a.name?a.name:a)+" ")])})),1):"longtext"!==s.type?t("span",[e._v(e._s(a.row[s.field]))]):e._e()],1)}))]}}])})},te=[],ae={name:"objectList",components:{},props:{searchQuery:{type:String,default:""},searchType:{type:String,default:"entity"},searchSubtype:{type:String,default:""},fields:{type:Array,default:()=>[]},checkable:{type:Boolean,default:!1}},data(){return{regexSearch:!0,ignoreCase:!0,objects:[],tablePage:1,tablePerPage:50,tableTotal:500,loading:!1}},mounted(){this.searchObjects()},created(){this.$watch("searchQuery",F.a.debounce((function(){this.searchObjects()}),300))},methods:{onPageChange(e){this.tablePage=e,this.searchObjects(!1)},searchObjects(){var e={filter:this.generateSearchParams(this.searchQuery),params:{regex:this.regexSearch,ignorecase:this.ignoreCase,page:this.tablePage}};this.countTotal(e),this.loading=!0,k.a.post(`/api/${this.searchType}search/`,e).then(e=>{this.objects=e.data,this.loading=!1}).catch(e=>{console.log(e)}).finally(()=>{this.loading=!1})},generateSearchParams(e){var t={},a=e.split(" "),s="name";for(var i in a){var l=a[i].split("=");2==l.length?t[l[0]]=l[1].split(","):""!==a[i]&&(t[s]=a[i])}return""!==this.searchSubtype&&(t["_cls"]=""+this.searchSubtype),t},countTotal(e){this.tableTotal=500,k.a.post(`/api/${this.searchType}search/total`,e).then(e=>{this.tableTotal=e.data.total}).catch(e=>{console.log(e)})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}},computed:{detailView(){let e=this.searchType.charAt(0).toUpperCase()+this.searchType.slice(1);return e+"Details"}}},se=ae,ie=(a("7ff2"),Object(d["a"])(se,ee,te,!1,null,null,null)),le=ie.exports;const ne=[{name:"Malware",type:"malware",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"tags",type:"list",label:"Relevant tags",displayList:!0},{field:"family",type:"text",label:"Family",displayList:!0},{field:"aliases",type:"list",label:"Aliases",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"bug"},{name:"TTP",type:"ttp",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"tags",type:"list",label:"Relevant tags",displayList:!0},{field:"killchain",type:"option",label:"Killchain Stage",choices:["reconnaissance","weaponization","delivery","exploitation","installation","command-and-control","actions-on-objectives"],displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"bolt"},{name:"Actor",type:"actor",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"tags",type:"list",label:"Relevant tags",displayList:!0},{field:"aliases",type:"list",label:"Aliases",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"user-secret"},{name:"Campaign",type:"campaign",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"tags",type:"list",label:"Relevant tags",displayList:!0},{field:"aliases",type:"list",label:"Aliases",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"bullhorn"},{name:"Exploit",type:"exploit",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"tags",type:"list",label:"Relevant tags",displayList:!0},{field:"aliases",type:"list",label:"Aliases",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"code"}];var oe={name:"entityList",components:{ObjectList:le},data(){return{entities:[],tablePage:1,tablePerPage:50,tableTotal:500,loading:!1,entityTypes:ne,selectedEntityType:null,newEntity:{},activeTab:0,activeMainTab:0,searchQuery:""}},methods:{saveEntity(){this.newEntity.type=this.selectedEntityType.type,k.a.post("/api/entity/",this.newEntity).then(e=>{this.$buefy.toast.open({message:`Entity ${e.name} saved`,type:"is-success"}),this.$refs[this.newEntity.type+"ObjectList"][0].searchObjects(),this.newEntity={}}).catch(e=>{console.log(e),this.$buefy.toast.open({message:"Error saving entity: "+e,type:"is-danger"})})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}},computed:{}},re=oe,ce=(a("9484"),Object(d["a"])(re,Z,X,!1,null,null,null)),de=ce.exports,ue=function(){var e=this,t=e._self._c;return e.entity?t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-8"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[t("b-taglist",{attrs:{attached:""}},[t("b-tag",{attrs:{size:"is-large",type:"is-dark"}},[e._v(e._s(e.entity.name))]),t("b-tag",{attrs:{size:"is-large",type:"is-info"}},[e._v(e._s(e.entity.type))])],1)],1),t("div",{staticClass:"panel-block"},[t("div",{staticClass:"content"},[e._v(e._s(e.entity.description||"No description provided"))])])]),t("div",{staticClass:"tile is-child"},[t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:"sitemap"}}),t("span",[e._v(" Observables "),t("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(null==e.totalRelatedObservables?"?":e.totalRelatedObservables))])],1)],1),t("related-objects",{attrs:{"source-type":"Entity","target-type":"Observable",id:e.id},on:{totalUpdated:t=>e.totalRelatedObservables=t}})],2)],1)],1)])])]),t("div",{staticClass:"column"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Info "),t("b-button",{attrs:{size:"is-small"},on:{click:e.editEntity}},[e._v(" Edit ")])],1),t("div",{staticClass:"panel-block"},[t("table",{staticClass:"table is-fullwidth"},["malware"==e.entity.type?t("tbody",[t("tr",[t("th",[e._v("Family")]),t("td",[e._v(e._s(e.entity.family))])]),t("tr",[t("th",[e._v("Aliases")]),t("td",[t("b-taglist",e._l(e.entity.aliases,(function(a){return t("b-tag",{key:a},[e._v(e._s(a))])})),1)],1)])]):e._e(),"ttp"==e.entity.type?t("tbody",[t("tr",[t("th",[e._v("Killchain stage")]),t("td",[e._v(e._s(e.entity.killchain))])])]):e._e()])])]),t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Relevant tags")]),t("div",{staticClass:"panel-block"},[t("b-field",{staticClass:"expanded"},[t("b-taginput",{attrs:{expanded:"",icon:"tag",placeholder:"e.g. CobaltStrike"},model:{value:e.entity.tags,callback:function(t){e.$set(e.entity,"tags",t)},expression:"entity.tags"}}),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.saveTags}},[e._v("Save")])])],1)],1),t("small",{staticClass:"panel-block"},[e._v("Observables tagged with these tags will be linked to this entity.")])]),t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Related entities")]),t("div",{staticClass:"panel-block"},[t("related-objects",{directives:[{name:"show",rawName:"v-show",value:e.totalRelatedEntities>0,expression:"totalRelatedEntities > 0"}],ref:"relatdEntitiesList",staticStyle:{width:"100%"},attrs:{"source-type":"Entity","inline-icons":"",fields:["name"],"target-type":"Entity",id:e.id},on:{totalUpdated:t=>e.totalRelatedEntities=t}})],1),t("div",{staticClass:"panel-block"},[t("b-field",{staticClass:"expanded"},[t("b-autocomplete",{attrs:{"open-on-focus":!0,"keep-first":!0,field:"name",clearable:!0,data:e.filteredEntities,placeholder:"Link new entity...",expanded:""},on:{select:t=>e.linkedEntity=t},model:{value:e.linkedEntityNameFilter,callback:function(t){e.linkedEntityNameFilter=t},expression:"linkedEntityNameFilter"}}),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.linkEntity}},[e._v("Link")])])],1)],1)])])])])]):e._e()},pe=[],be=function(){var e=this,t=e._self._c;return t("div",[e.links?t("b-table",{attrs:{data:e.links,hoverable:!0,narrowed:!0,loading:e.loading,paginated:e.total>e.perPage,"backend-pagination":"",total:e.total,"per-page":e.perPage,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[e._l(e.fields,(function(s){return t("b-table-column",{key:s,attrs:{field:s,label:e.getLabelForField(s)}},["value"===s||"name"===s?t("span",[a.row.target.type&&e.inlineIcons?t("b-icon",{attrs:{size:"is-small",icon:e.getIconForType(a.row.target.type)}}):e._e(),t("router-link",{attrs:{to:{name:"value"===s?"ObservableDetails":"EntityDetails",params:{id:a.row.target.id}}}},[e._v(" "+e._s(a.row.target[s])+" ")])],1):"tags"===s?t("b-taglist",e._l(a.row.target.tags,(function(a){return t("b-tag",{key:a.name?a.name:a,attrs:{type:a.fresh?"is-primary":""}},[e._v(" "+e._s(a.name?a.name:a)+" ")])})),1):t("span",[e._v(e._s(a.row.target[s]))])],1)})),t("b-table-column",{attrs:{field:"relation",label:"Relation"}},[e._v(" "+e._s(a.row.description||"N/A")+" ")]),t("b-table-column",{attrs:{field:"unlink",label:"Controls",width:"10"}},[t("b-button",{attrs:{type:"is-text","icon-left":"unlink",size:"is-small"},on:{click:function(t){return e.unlink(a.row.id)}}})],1)]}}],null,!1,1961158283)}):e._e()],1)},me=[];const he=[{name:"Regular expression",type:"regex",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"pattern",type:"code",label:"Pattern",displayList:!0},{field:"location",type:"text",label:"Location",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"bolt"},{name:"Yara rule",type:"yara",fields:[{field:"name",type:"text",label:"Name",displayList:!0},{field:"pattern",type:"longcode",label:"Rule text",displayList:!0},{field:"location",type:"text",label:"Location",displayList:!0},{field:"description",type:"longtext",label:"Description",displayList:!1}],icon:"bolt"}];var fe={name:"RelatedEntities",props:{id:{type:String,required:!0},fields:{type:Array,default:()=>["value","tags"]},sourceType:{type:String,default:"Observable"},targetType:{type:String,default:"Observable"},inlineIcons:{type:Boolean,default:!1}},data(){return{links:[],page:1,perPage:10,total:500,loading:!1,objectTypes:ne.concat(he)}},mounted(){this.fetchNeighbors(),this.countTotal()},methods:{getLabelForField(e){switch(e){case"tags":return"Observable"===this.targetType?"Tags":"Relevant tags";default:return e.charAt(0).toUpperCase()+e.slice(1)}},fetchNeighbors(){var e={params:{page:this.page,range:this.perPage}};this.loading=!0,k.a.post(`/api/neighbors/tuples/${this.sourceType}/${this.id}/${this.targetType}`,e).then(e=>{this.links=e.data.links,this.links.map(e=>{e.target=e.dst.id===this.id?e.src:e.dst})}).catch(e=>{console.log(e)}).finally(()=>this.loading=!1)},unlink(e){k.a.delete("/api/link/"+e).then(()=>{this.fetchNeighbors(),this.countTotal()}).catch(e=>{console.log(e)})},countTotal(){k.a.get(`/api/neighbors/tuples/${this.sourceType}/${this.id}/${this.targetType}/total`).then(e=>{this.total=e.data.total,this.$emit("totalUpdated",this.total)}).catch(e=>{console.log(e)})},getIconForType(e){return this.objectTypes.find(t=>t.type===e).icon},onPageChange(e){this.page=e,this.fetchNeighbors()}},watch:{id:function(){this.page=1,this.total=500,this.fetchNeighbors(),this.countTotal()}}},ge=fe,ve=Object(d["a"])(ge,be,me,!1,null,null,null),ye=ve.exports,_e=function(){var e=this,t=e._self._c;return e.localObject?t("div",{staticClass:"modal-card"},[t("header",{staticClass:"modal-card-head"},[e.localObject.id?t("p",{staticClass:"modal-card-title"},[e._v("Editing "+e._s(e.localObject.id))]):t("p",{staticClass:"modal-card-title"},[e._v("New "+e._s(e.objectType.name))])]),t("section",{staticClass:"modal-card-body"},[e._l(e.objectType.fields,(function(a){return t("b-field",{key:a.field,attrs:{label:a.label}},["text"===a.type?t("b-input",{model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}}):e._e(),"code"===a.type?t("b-input",{attrs:{"custom-class":"longcode"},model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}}):e._e(),"longtext"===a.type?t("b-input",{attrs:{type:"textarea"},model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}}):e._e(),"longcode"===a.type?t("b-input",{attrs:{type:"textarea","custom-class":"longcode"},model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}}):e._e(),"option"===a.type?t("b-select",{model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}},e._l(a.choices,(function(a,s){return t("option",{key:a,domProps:{value:String(s+1)}},[e._v(" "+e._s(a)+" "+e._s(s))])})),0):e._e(),"list"===a.type?t("b-taginput",{attrs:{label:"Tags",icon:"tag"},model:{value:e.localObject[a.field],callback:function(t){e.$set(e.localObject,a.field,t)},expression:"localObject[field.field]"}}):e._e()],1)})),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-primary"},on:{click:e.saveObject}},[e._v(" Save ")])],1)],2)]):e._e()},ke=[],we={components:{},props:{object:{type:Object,default:()=>{}},objectTypeName:{type:String,default:"",required:!0},endpoint:{type:String,default:"",required:!0}},data(){return{objectTypes:ne.concat(he),localObject:{...this.object}}},mounted(){},methods:{saveObject(){k.a.post(`/api/${this.endpoint}/${this.object.id}`,this.localObject).then(e=>{this.$parent.close(),this.$buefy.toast.open({message:"Update succesful!",type:"is-success"}),this.$emit("refresh",e.data)}).catch(e=>{this.$buefy.toast.open({message:"Error saving object: "+e,type:"is-danger"})}).finally()}},computed:{objectType(){return this.objectTypes.find(e=>e.type===this.objectTypeName)}}},xe=we,Ce=Object(d["a"])(xe,_e,ke,!1,null,null,null),Te=Ce.exports,je={props:["id"],components:{RelatedObjects:ye},data(){return{entity:null,newTags:[],activeTab:null,totalRelatedObservables:null,totalRelatedEntities:0,linkedEntityNameFilter:"",linkedEntity:null,entities:[]}},mounted(){this.getentityDetails(),this.getEntityAutocomplete()},methods:{getentityDetails(){k.a.get("/api/entity/"+this.id).then(e=>{this.entity=e.data,this.activeTab=0}).catch(e=>{console.log(e)}).finally()},editEntity(){this.$buefy.modal.open({parent:this,component:Te,hasModalCard:!0,customClass:"custom-class custom-class-2",trapFocus:!0,props:{objectTypeName:this.entity.type,object:this.entity,endpoint:"entity"},events:{refresh:e=>{console.log(e),this.entity=e}}})},getEntityAutocomplete(){k.a.post("/api/entitysearch/",{name:""}).then(e=>{this.entities=e.data}).catch(e=>{console.log(e)}).finally()},linkEntity(){var e={type_src:"entity",type_dst:"entity",link_src:this.entity.id,link_dst:this.linkedEntity.id,source:"web"};k.a.post("/api/link/",e).then(()=>{this.$refs.relatdEntitiesList.fetchNeighbors(),this.linkedEntityNameFilter="",this.linkedEntity=null}).catch(e=>{console.log(e)}).finally()},saveTags(){var e={tags:this.entity.tags};k.a.post("/api/entity/"+this.id,e).then(e=>{this.entity=e.data}).catch(e=>{console.log(e)}).finally()}},computed:{filteredEntities(){return this.entities.filter(e=>e.name.toLowerCase().includes(this.linkedEntityNameFilter.toLowerCase())&&e.id!=this.entity.id)}},watch:{id:"getentityDetails"}},Ee=je,Oe=(a("9766"),Object(d["a"])(Ee,ue,pe,!1,null,"5bb6c4a5",null)),Se=Oe.exports,Ie=function(){var e=this,t=e._self._c;return t("div",{staticClass:"indicator-list columns"},[t("div",{staticClass:"column is-three-quarters"},[t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeMainTab,callback:function(t){e.activeMainTab=t},expression:"activeMainTab"}},e._l(e.indicatorTypes,(function(a){return t("b-tab-item",{key:a.type,attrs:{label:a.name}},[t("object-list",{ref:a.type+"ObjectList",refInFor:!0,attrs:{"search-type":"indicator","search-subtype":a.type,fields:a.fields,"search-query":e.searchQuery}})],1)})),1)],1),t("div",{staticClass:"column"},[t("section",[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Search"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("b-input",{attrs:{type:"text",placeholder:"Search query + ‚èé",icon:"search"},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1)]),t("br"),t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" You can run complex queries against the database using the input field above. ")]),t("p",[e._v(" By default, the query will be matched against the "),t("code",[e._v("value")]),e._v(" attribute of the indicators. To match against other attributes, use "),t("code",[e._v("attribute=query")]),e._v(". ")]),t("p",[e._v("Examples:")]),t("ul",[t("li",[t("strong",[e._v("Generic tag query")]),e._v(": "),t("code",[e._v("tags=crimeware")])]),t("li",[t("strong",[e._v("Gate URLs")]),e._v(": "),t("code",[e._v("tags=zeus .php$")]),e._v(" (regex "),t("code",[e._v("on")]),e._v(")")]),t("li",[t("strong",[e._v("Ransomware C2s")]),e._v(": "),t("code",[e._v("tags=c2,ransomware")])]),t("li",[t("strong",[e._v("Context")]),e._v(": "),t("code",[e._v("context.source=FeodoTracker")])])])])])]),t("b-tab-item",{attrs:{label:"New indicator"}},[t("b-field",{attrs:{label:"Indicator type"}},[t("b-select",{attrs:{placeholder:"Select an indicator type",expanded:""},model:{value:e.selectedindicatorType,callback:function(t){e.selectedindicatorType=t},expression:"selectedindicatorType"}},e._l(e.indicatorTypes,(function(a){return t("option",{key:a.name,domProps:{value:a}},[e._v(" "+e._s(a.name)+" ")])})),0)],1),e.selectedindicatorType?t("div",[e._l(e.selectedindicatorType.fields,(function(a){return t("b-field",{key:a.field,attrs:{label:a.label}},["text"===a.type?t("b-input",{model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}}):e._e(),"code"===a.type?t("b-input",{attrs:{"custom-class":"longcode"},model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}}):e._e(),"longtext"===a.type?t("b-input",{attrs:{type:"textarea"},model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}}):e._e(),"longcode"===a.type?t("b-input",{attrs:{type:"textarea","custom-class":"longcode"},model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}}):e._e(),"option"===a.type?t("b-select",{model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}},e._l(a.choices,(function(a,s){return t("option",{key:a,domProps:{value:String(s+1)}},[e._v(" "+e._s(a)+" "+e._s(s))])})),0):e._e(),"list"===a.type?t("b-taginput",{attrs:{label:"Tags",icon:"tag"},model:{value:e.newIndicator[a.field],callback:function(t){e.$set(e.newIndicator,a.field,t)},expression:"newIndicator[field.field]"}}):e._e()],1)})),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-primary"},on:{click:e.saveIndicator}},[e._v(" Save ")])],1)],2):e._e()],1)],1)],1)])])},$e=[],Pe={name:"IndicatorList",components:{ObjectList:le},data(){return{indicators:[],tablePage:1,tablePerPage:50,tableTotal:500,loading:!1,indicatorTypes:he,selectedindicatorType:null,newIndicator:{},activeTab:0,activeMainTab:0,searchQuery:""}},methods:{saveIndicator(){this.newIndicator.type=this.selectedindicatorType.type,k.a.post("/api/indicator/",this.newIndicator).then(e=>{this.$buefy.toast.open({message:`indicator ${e.name} saved`,type:"is-success"}),this.$refs[this.newIndicator.type+"ObjectList"][0].searchObjects(),this.newIndicator={},this.searchIndicators()}).catch(e=>{this.$buefy.toast.open({message:"Error saving indicator: "+e,type:"is-danger"})})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}},computed:{}},Re=Pe,Ae=(a("725d"),Object(d["a"])(Re,Ie,$e,!1,null,null,null)),Le=Ae.exports,Ue=function(){var e=this,t=e._self._c;return e.indicator?t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-8"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[t("b-taglist",{attrs:{attached:""}},[t("b-tag",{attrs:{size:"is-large",type:"is-dark"}},[e._v(e._s(e.indicator.name))]),t("b-tag",{attrs:{size:"is-large",type:"is-info"}},[e._v(e._s(e.indicator.type))])],1)],1),t("div",{staticClass:"panel-block"},[t("div",{staticClass:"content"},[e._v(e._s(e.indicator.description||"No description provided"))])]),t("div",{staticClass:"panel-block"},[t("div",{staticClass:"content"},[t("code",[e._v(e._s(e.indicator.pattern))])])])]),t("div",{staticClass:"tile is-child"},[t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:"sitemap"}}),t("span",[e._v(" Observables "),t("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(null==e.totalRelatedObservables?"?":e.totalRelatedObservables))])],1)],1),t("related-objects",{attrs:{"source-type":"indicator","target-type":"Observable",id:e.id},on:{totalUpdated:t=>e.totalRelatedObservables=t}})],2)],1)],1)])])]),t("div",{staticClass:"column"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Info "),t("b-button",{attrs:{size:"is-small"},on:{click:e.editIndicator}},[e._v(" Edit ")])],1),t("div",{staticClass:"panel-block"},[t("table",{staticClass:"table is-fullwidth"},[t("tbody",[t("tr",[t("th",[e._v("Location")]),t("td",[e._v(e._s(e.indicator.location))])])])])])]),t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Related indicators")]),t("div",{staticClass:"panel-block"},[t("related-objects",{directives:[{name:"show",rawName:"v-show",value:e.totalRelatedIndicators>0,expression:"totalRelatedIndicators > 0"}],ref:"relatdIndicatorsList",staticStyle:{width:"100%"},attrs:{"source-type":"Indicator","inline-icons":"",fields:["name"],"target-type":"Indicator",id:e.id},on:{totalUpdated:t=>e.totalRelatedIndicators=t}})],1),t("div",{staticClass:"panel-block"},[t("b-field",{staticClass:"expanded"},[t("b-autocomplete",{attrs:{"open-on-focus":!0,"keep-first":!0,field:"name",clearable:!0,data:e.filteredIndicators,placeholder:"Link new indicator...",expanded:""},on:{select:t=>e.linkedIndicator=t},model:{value:e.linkedIndicatorNameFilter,callback:function(t){e.linkedIndicatorNameFilter=t},expression:"linkedIndicatorNameFilter"}}),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.linkIndicator}},[e._v("Link")])])],1)],1)]),t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Related entities")]),t("div",{staticClass:"panel-block"},[t("related-objects",{directives:[{name:"show",rawName:"v-show",value:e.totalRelatedEntities>0,expression:"totalRelatedEntities > 0"}],ref:"relatdEntitiesList",staticStyle:{width:"100%"},attrs:{"source-type":"Indicator","inline-icons":"",fields:["name"],"target-type":"Entity",id:e.id},on:{totalUpdated:t=>e.totalRelatedEntities=t}})],1),t("div",{staticClass:"panel-block"},[t("b-field",{staticClass:"expanded"},[t("b-autocomplete",{attrs:{"open-on-focus":!0,"keep-first":!0,field:"name",clearable:!0,data:e.filteredEntities,placeholder:"Link new indicator...",expanded:""},on:{select:t=>e.linkedEntity=t},model:{value:e.linkedEntityNameFilter,callback:function(t){e.linkedEntityNameFilter=t},expression:"linkedEntityNameFilter"}}),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.linkEntity}},[e._v("Link")])])],1)],1)])])])])]):e._e()},Ne=[],Fe={props:["id"],components:{RelatedObjects:ye},data(){return{indicator:null,newTags:[],activeTab:null,totalRelatedObservables:null,totalRelatedIndicators:0,totalRelatedEntities:0,linkedIndicatorNameFilter:"",linkedEntityNameFilter:"",linkedIndicator:null,entities:[],indicators:[]}},mounted(){this.getindicatorDetails(),this.getIndicatorAutocomplete(),this.getEntityAutocomplete()},methods:{getindicatorDetails(){k.a.get("/api/indicator/"+this.id).then(e=>{this.indicator=e.data,this.activeTab=0}).catch(e=>{console.log(e)}).finally()},editIndicator(){this.$buefy.modal.open({parent:this,component:Te,hasModalCard:!0,customClass:"custom-class custom-class-2",trapFocus:!0,props:{objectTypeName:this.indicator.type,object:this.indicator,endpoint:"indicator"},events:{refresh:e=>{console.log(e),this.indicator=e}}})},getIndicatorAutocomplete(){k.a.post("/api/indicatorsearch/",{name:""}).then(e=>{this.indicators=e.data}).catch(e=>{console.log(e)}).finally()},getEntityAutocomplete(){k.a.post("/api/entitysearch/",{name:""}).then(e=>{this.entities=e.data}).catch(e=>{console.log(e)}).finally()},linkIndicator(){var e={type_src:"indicator",type_dst:"indicator",link_src:this.indicator.id,link_dst:this.linkedIndicator.id,source:"web"};k.a.post("/api/link/",e).then(()=>{this.$refs.relatdIndicatorsList.fetchNeighbors(),this.$refs.relatdIndicatorsList.countTotal(),this.linkedIndicatorNameFilter="",this.linkedIndicator=null}).catch(e=>{console.log(e)}).finally()},linkEntity(){var e={type_src:"indicator",type_dst:"entity",link_src:this.indicator.id,link_dst:this.linkedEntity.id,source:"web"};k.a.post("/api/link/",e).then(()=>{this.$refs.relatdEntitiesList.fetchNeighbors(),this.$refs.relatdEntitiesList.countTotal(),this.linkedEntityNameFilter="",this.linkedEntity=null}).catch(e=>{console.log(e)}).finally()},saveTags(){var e={tags:this.indicator.tags};k.a.post("/api/indicator/"+this.id,e).then(e=>{this.indicator=e.data}).catch(e=>{console.log(e)}).finally()}},computed:{filteredIndicators(){return this.indicators.filter(e=>e.name.toLowerCase().includes(this.linkedIndicatorNameFilter.toLowerCase())&&e.id!=this.indicator.id)},filteredEntities(){return this.entities.filter(e=>e.name.toLowerCase().includes(this.linkedEntityNameFilter.toLowerCase()))}},watch:{id:"getindicatorDetails"}},De=Fe,ze=(a("b1ff"),Object(d["a"])(De,Ue,Ne,!1,null,"3175725a",null)),Ge=ze.exports,qe=function(){var e=this,t=e._self._c;return e.observable?t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-8"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[t("b-taglist",{attrs:{attached:""}},[t("b-tag",{attrs:{size:"is-large",type:"is-dark"}},[e._v(e._s(e.observable.value))]),t("b-tag",{attrs:{size:"is-large",type:"is-info"}},[e._v(e._s(e.observable.type))])],1)],1),t("div",{staticClass:"panel-block"},[t("div",{staticClass:"content"},[e._v(e._s(e.observable.description||"No description provided"))])])]),t("div",{staticClass:"tile is-child"},[t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:"info"}}),t("span",[e._v(" Context "),t("b-tag",{attrs:{rounded:""}},[e._v(e._s(e.observable.context.length))])],1)],1),e._l(e.observable.context,(function(a,s){return t("nav",{key:s,staticClass:"panel"},[t("p",{staticClass:"panel-heading"},[e._v(e._s(a.source))]),t("div",{staticClass:"panel-block"},[t("table",{staticClass:"table"},[t("tbody",e._l(Object.keys(a).filter(e=>"source"!==e),(function(s){return t("tr",{key:s},[t("th",[e._v(e._s(s))]),t("td",[e._v(e._s(a[s]))])])})),0)])])])}))],2),t("b-tab-item",[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:"sitemap"}}),t("span",[e._v(" Related observables "),t("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(null==e.totalRelatedObservables?"?":e.totalRelatedObservables))])],1)],1),t("related-objects",{attrs:{id:e.id,"source-type":"Observable","target-type":"Observable"},on:{totalUpdated:t=>e.totalRelatedObservables=t}})],2),t("b-tab-item",[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:"sitemap"}}),t("span",[e._v(" Related Entities "),t("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(e.globalRelatedEntities))])],1)],1),t("b-tabs",{attrs:{position:"is-left",animated:!1},model:{value:e.activeSubTab,callback:function(t){e.activeSubTab=t},expression:"activeSubTab"}},e._l(e.entityTypes,(function(a){return t("b-tab-item",{key:a.name},[t("template",{slot:"header"},[t("b-icon",{attrs:{icon:a.icon}}),t("span",[e._v(" "+e._s(a.name)+" "),t("b-tag",{attrs:{rounded:""}},[e._v(" "+e._s(null==e.totalRelatedEntities[a.type]?"?":e.totalRelatedEntities[a.type]))])],1)],1),t("related-objects",{attrs:{id:e.id,fields:["name","tags"],"source-type":"Observable","target-type":a.type},on:{totalUpdated:t=>e.totalRelatedEntities[a.type]=t}})],2)})),1)],2)],1)],1)])])]),t("div",{staticClass:"column"},[t("div",{staticClass:"tile is-ancestor"},[t("div",{staticClass:"tile is-vertical is-parent"},[t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Info")]),t("div",{staticClass:"panel-block"},[t("observable-info-table",{attrs:{observable:e.observable}})],1)]),t("nav",{staticClass:"tile panel is-child"},[t("p",{staticClass:"panel-heading"},[e._v("Tags")]),t("div",{staticClass:"panel-block"},[t("b-field",[t("yeti-tag-input",{model:{value:e.newTags,callback:function(t){e.newTags=t},expression:"newTags"}}),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.saveTags}},[e._v("Save")])])],1)],1)])])])])]):e._e()},Me=[],Ye=(a("13d5"),function(){var e=this,t=e._self._c;return t("table",{staticClass:"table is-fullwidth"},[t("tbody",[t("tr",[t("th",[e._v("Sources")]),t("td",[t("b-taglist",e._l(e.observable.sources,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1)]),t("tr",[t("th",[e._v("Created")]),t("td",[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(e.observable.created,!0)}},[e._v(e._s(e.formatTimestamp(e.observable.created))+" UTC")])])])]),"Hostname"==e.observable.type?t("tbody",[t("tr",[t("th",[e._v("Domain?")]),t("td",[e._v(e._s(e.observable.domain?"Yes":"No"))])]),t("tr",[t("th",[e._v("IDNA")]),t("td",[e._v(e._s(e.observable.idna))])])]):e._e(),"Url"==e.observable.type?t("tbody",[t("tr",[t("th",[e._v("Host")]),t("td",[e._v(e._s(e.observable.parsed_url.netloc))])]),t("tr",[t("th",[e._v("Path")]),t("td",[e._v(e._s(e.observable.parsed_url.path))])]),t("tr",[t("th",[e._v("Scheme")]),t("td",[e._v(e._s(e.observable.parsed_url.scheme))])]),t("tr",[t("th",[e._v("Port")]),t("td",[e._v(e._s(e.observable.parsed_url.port))])])]):e._e(),"Ip"==e.observable.type?t("tbody",[t("tr",[t("th",[e._v("IP version")]),t("td",[e._v(e._s(e.observable.version))])]),t("tr",[t("th",[e._v("Country")]),t("td",[e._v(e._s(e.observable.geoip.country||"N/A"))])]),t("tr",[t("th",[e._v("City")]),t("td",[e._v(e._s(e.observable.geoip.city||"N/A"))])])]):e._e()])}),Qe=[],He={name:"ObservableInfoTable",props:["observable"],methods:{formatTimestamp(e,t){return B.formatTimestamp(e,t)}}},Be=He,Ke=Object(d["a"])(Be,Ye,Qe,!1,null,null,null),Ve=Ke.exports,We={props:["id"],components:{YetiTagInput:q,RelatedObjects:ye,ObservableInfoTable:Ve},data(){return{observable:null,newTags:[],activeTab:null,activeSubTab:null,totalRelatedObservables:null,totalRelatedEntities:{malware:null,ttp:null,actor:null,campaign:null,exploit:null},entityTypes:ne}},mounted(){this.getObservableDetails()},methods:{getObservableDetails(){k.a.get("/api/observable/"+this.id).then(e=>{this.observable=e.data,this.newTags=[...this.observable.tags],this.activeTab=0}).catch(e=>{console.log(e)}).finally()},saveTags(){var e={strict:!0,tags:this.newTags.map(e=>e.name)};k.a.post("/api/observable/"+this.id,e).then(e=>{this.observable=e.data}).catch(e=>{console.log(e)}).finally()}},computed:{globalRelatedEntities(){return Object.values(this.totalRelatedEntities).reduce((e,t)=>e+t,0)}},watch:{id:"getObservableDetails"}},Je=We,Ze=Object(d["a"])(Je,qe,Me,!1,null,"6af56e2a",null),Xe=Ze.exports,et=function(){var e=this,t=e._self._c;return t("div",{staticClass:"feedlist"},[t("b-table",{attrs:{data:e.feeds,hoverable:!0,narrowed:!0,"row-class":e.getRowClass},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[t("strong",[e._v(e._s(a.row.name))])]),t("b-table-column",{attrs:{field:"frequency",label:"Runs every",width:"130"}},[e._v(e._s(a.row.frequency))]),t("b-table-column",{attrs:{field:"last_run",label:"Last run (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.last_run,!0)}},[e._v(e._s(e.formatTimestamp(a.row.last_run)))])]),t("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(a.row.description))]),t("b-table-column",{attrs:{field:"status",label:"Status"}},[e._v(e._s(a.row.status||"N/A"))]),t("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[t("div",{staticClass:"toggle",on:{click:function(t){return e.toggle(a.row)}}},[t("b-switch",{attrs:{disabled:"Updating..."===a.row.status},model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"feed.row.enabled"}})],1)]),t("b-table-column",{attrs:{field:"refresh",label:""}},[t("b-button",{attrs:{disabled:"Updating..."===a.row.status||!a.row.enabled,size:"is-small"},on:{click:function(t){return e.refresh(a.row)}}},[t("b-icon",{attrs:{pack:"fas",icon:"sync",size:"is-small","custom-class":"Updating..."===a.row.status?"fa-spin":""}})],1)],1)]}}])})],1)},tt=[],at={name:"FeedList",data(){return{feeds:[],timer:null}},mounted(){this.listFeeds()},created(){this.timer=setInterval(this.listFeeds,5e3)},beforeDestroy(){clearInterval(this.timer)},methods:{toggle(e){console.log(e);var t="/api/feed/"+e.id+"/toggle";k.a.post(t).then(()=>{}).catch(e=>{console.log(e)})},listFeeds(){k.a.get("/api/feed/").then(e=>this.feeds=e.data).catch(e=>{console.log(e)}).finally(()=>{})},refresh(e){var t="/api/feed/"+e.id+"/refresh";k.a.post(t).then(()=>{}).catch(e=>{console.log(e)})},isRefreshing(e){return"Updating..."===e.status},getRowClass(e){return e.enabled?"OK"===e.status?"is-success":"Updating..."===e.status?"is-warning":"ERROR"===e.status?"is-danger":void 0:"disabled"},formatTimestamp(e,t){return B.formatTimestamp(e,t)}}},st=at,it=(a("7c20"),Object(d["a"])(st,et,tt,!1,null,"e4c57088",null)),lt=it.exports,nt=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"scheduled"},[t("p",{staticClass:"title"},[e._v("Scheduled")]),t("p",{staticClass:"subtitle"},[e._v("Recurring analytics, triggered automatically on a fixed schedule.")]),t("b-table",{attrs:{data:e.scheduled,"default-sort":"name",narrowed:"","row-class":e.getRowClass},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name",sortable:""}},[t("strong",[e._v(e._s(a.row.name))])]),t("b-table-column",{attrs:{field:"frequency",label:"Runs every",width:"130"}},[e._v(e._s(a.row.frequency))]),t("b-table-column",{attrs:{field:"last_run",label:"Last run (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.last_run,!0)}},[e._v(e._s(e.formatTimestamp(a.row.last_run)))])]),t("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(a.row.description))]),t("b-table-column",{attrs:{field:"status",label:"Status"}},[e._v(e._s(a.row.status||"N/A"))]),t("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[t("div",{staticClass:"toggle",on:{click:function(t){return e.toggle(a.row,"scheduled")}}},[t("b-switch",{attrs:{disabled:"Running..."===a.row.status},model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"analytics.row.enabled"}})],1)]),t("b-table-column",{attrs:{field:"refresh",label:""}},[t("b-button",{attrs:{disabled:"Running..."===a.row.status||!a.row.enabled,size:"is-small"},on:{click:function(t){return e.refresh(a.row)}}},[t("b-icon",{attrs:{pack:"fas",icon:"sync",size:"is-small","custom-class":"Running..."===a.row.status?"fa-spin":""}})],1)],1)]}}])})],1),t("br"),t("br"),t("div",{staticClass:"oneshot"},[t("p",{staticClass:"title"},[e._v("One-shot")]),t("p",{staticClass:"subtitle"},[e._v("Analytics that are triggered manually on specific observable types.")]),t("b-table",{attrs:{data:e.oneshot,"default-sort":"group",narrowed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"group",label:"Grouping",sortable:""}},[e._v(" "+e._s(a.row.group)+" ")]),t("b-table-column",{attrs:{field:"name",label:"Name",sortable:""}},[t("strong",[e._v(e._s(a.row.name))])]),t("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[t("b-taglist",e._l(a.row.acts_on,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(" "+e._s(a.row.description)+" "),a.row.available?e._e():t("span",{staticClass:"setting-warning"},[e._v(" This plugin requires settings that are not yet defined. ")])]),t("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[t("div",{staticClass:"toggle",on:{click:function(t){return e.toggle(a.row,"oneshot")}}},[t("b-switch",{model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"analytics.row.enabled"}})],1)])]}}])})],1),t("br"),t("br"),t("div",{staticClass:"scheduled"},[t("p",{staticClass:"title"},[e._v("Inline")]),t("p",{staticClass:"subtitle"},[e._v("Analytics that trigger when an observable is added to the Yeti database.")]),t("b-table",{attrs:{data:e.inline,narrowed:"","default-sort":"name"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[t("strong",[e._v(e._s(a.row.name))])]),t("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[t("b-taglist",e._l(a.row.acts_on,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(a.row.description))]),t("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[t("div",{staticClass:"toggle",on:{click:function(t){return e.toggle(a.row,"inline")}}},[t("b-switch",{model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"analytics.row.enabled"}})],1)])]}}])})],1)])},ot=[],rt={name:"AnalyticsList",data(){return{scheduled:[],oneshot:[],inline:[]}},methods:{getAnalytics(e){k.a.get(`/api/analytics/${e}/`).then(t=>{this[e]=t.data}).catch(e=>{console.log(e)}).finally(()=>{})},toggle(e,t){k.a.post(`/api/analytics/${t}/${e.id}/toggle`).then(t=>{e.enabled=t.data.status}).catch(e=>{console.log(e)}).finally(()=>{})},refresh(e){k.a.post(`/api/analytics/scheduled/${e.id}/refresh`).then(()=>{}).catch(e=>{console.log(e)}).finally(()=>{}),console.log(e)},isRunning(e){return"Running..."===e.status},getRowClass(e){return e.enabled?"OK"===e.status?"is-success":"Updating..."===e.status?"is-warning":"ERROR"===e.status?"is-danger":void 0:"disabled"},formatTimestamp(e,t){return B.formatTimestamp(e,t)}},mounted(){this.getAnalytics("scheduled"),this.getAnalytics("oneshot"),this.getAnalytics("inline")}},ct=rt,dt=(a("548d"),Object(d["a"])(ct,nt,ot,!1,null,"e2d50e3e",null)),ut=dt.exports,pt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-9 exportlist"},[t("b-table",{attrs:{data:e.exports,hoverable:!0,narrowed:!0,"row-class":e.getRowClass},on:{click:e=>this.selectedExport=JSON.parse(JSON.stringify(e))},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[t("strong",[e._v(e._s(a.row.name))])]),t("b-table-column",{attrs:{field:"frequency",label:"Runs every",width:"130"}},[e._v(e._s(a.row.frequency))]),t("b-table-column",{attrs:{field:"last_run",label:"Last run (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.last_run,!0)}},[e._v(e._s(e.formatTimestamp(a.row.last_run)))])]),t("b-table-column",{attrs:{field:"description",label:"Description"}},[e._v(e._s(a.row.description))]),t("b-table-column",{attrs:{field:"acts_on",label:"Acts on"}},[e._v(e._s(a.row.acts_on))]),t("b-table-column",{attrs:{field:"ignore",label:"Ignore"}},[t("b-taglist",e._l(a.row.ignore_tags,(function(a){return t("b-tag",{key:a},[e._v(e._s(a))])})),1)],1),t("b-table-column",{attrs:{field:"include",label:"include"}},[t("b-taglist",e._l(a.row.include_tags,(function(a){return t("b-tag",{key:a},[e._v(e._s(a))])})),1)],1),t("b-table-column",{attrs:{field:"exclude",label:"exclude"}},[t("b-taglist",e._l(a.row.exclude_tags,(function(a){return t("b-tag",{key:a},[e._v(e._s(a))])})),1)],1),t("b-table-column",{attrs:{field:"singleExport.template",label:"Template"}},[e._v(e._s(a.row.template))]),t("b-table-column",{attrs:{field:"status",label:"Status"}},[e._v(e._s(a.row.status||"N/A"))]),t("b-table-column",{attrs:{field:"toggle",label:"Toggle"}},[t("div",{staticClass:"toggle",on:{click:function(t){return e.toggle(a.row)}}},[t("b-switch",{attrs:{disabled:"Updating..."===a.row.status},model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"singleExport.row.enabled"}})],1)]),t("b-table-column",{attrs:{field:"refresh","custom-key":"refresh"}},[t("b-button",{attrs:{disabled:"Updating..."===a.row.status||!a.row.enabled,size:"is-small"},on:{click:function(t){return e.refresh(a.row)}}},[t("b-icon",{attrs:{disabled:!a.row.enabled,pack:"fas",icon:"sync",size:"is-small","custom-class":"Updating..."===a.row.status?"fa-spin":""}})],1)],1),t("b-table-column",{attrs:{field:"download","custom-key":"download"}},[t("b-button",{attrs:{disabled:!a.row.enabled,type:"is-link","icon-left":"file-download",size:"is-small"},on:{click:function(t){return e.downloadExport(a.row)}}})],1)]}}])})],1),t("div",{staticClass:"column is-3"},[t("b-field",{attrs:{label:"Name"}},[t("b-input",{ref:"exportName",attrs:{required:""},model:{value:e.selectedExport.name,callback:function(t){e.$set(e.selectedExport,"name",t)},expression:"selectedExport.name"}})],1),t("b-field",{attrs:{label:"Description"}},[t("b-input",{model:{value:e.selectedExport.description,callback:function(t){e.$set(e.selectedExport,"description",t)},expression:"selectedExport.description"}})],1),t("b-field",{attrs:{label:"Include tags"}},[t("yeti-tag-input",{model:{value:e.selectedExport.include_tags,callback:function(t){e.$set(e.selectedExport,"include_tags",t)},expression:"selectedExport.include_tags"}})],1),t("b-field",{attrs:{label:"Ignore tags"}},[t("yeti-tag-input",{model:{value:e.selectedExport.ignore_tags,callback:function(t){e.$set(e.selectedExport,"ignore_tags",t)},expression:"selectedExport.ignore_tags"}})],1),t("b-field",{attrs:{label:"Exclude tags"}},[t("yeti-tag-input",{model:{value:e.selectedExport.exclude_tags,callback:function(t){e.$set(e.selectedExport,"exclude_tags",t)},expression:"selectedExport.exclude_tags"}})],1),t("b-field",[t("b-select",{ref:"exportActsOn",attrs:{placeholder:"Select type to export",required:"",expanded:""},model:{value:e.selectedExport.acts_on,callback:function(t){e.$set(e.selectedExport,"acts_on",t)},expression:"selectedExport.acts_on"}},e._l(Object.keys(e.defaultTypes),(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(e._s(e.defaultTypes[a]))])})),0)],1),t("b-field",[t("b-select",{ref:"exportTemplate",attrs:{placeholder:"Select template to use",required:"",expanded:""},model:{value:e.selectedExport.template,callback:function(t){e.$set(e.selectedExport,"template",t)},expression:"selectedExport.template"}},e._l(e.exportTemplates,(function(a){return t("option",{key:a},[e._v(e._s(a))])})),0)],1),t("b-field",{attrs:{grouped:""}},[e.selectedExport.id?t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.updateExport}},[e._v("Save changes")])]):e._e(),e.selectedExport.id?t("p",{staticClass:"control"},[t("button",{staticClass:"button is-danger",on:{click:e.confirmDeleteExport}},[e._v("Delete export")])]):e._e(),e.selectedExport.id?e._e():t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.updateExport}},[e._v("Add new export")])]),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-light",on:{click:function(t){e.selectedExport={}}}},[e._v("Clear form")])])])],1)])},bt=[],mt={Ip:"IP",AutonomousSystem:"Autonomous System",Url:"URL",Hostname:"Hostname",Hash:"Hash",File:"File",Certificate:"Certificate",CertificateSubject:"Certificate Subject",Email:"Email",Text:"Text",Bitcoin:"Bitcoin address",Path:"Path",MacAddress:"MAC address"},ht={name:"ExportList",components:{YetiTagInput:q},data(){return{defaultTypes:mt,exports:[],exportTemplates:[],newExport:{},selectedExport:{},timerListExports:null,timerListTemplates:null}},mounted(){this.listExports(),this.listExportTemplates()},created(){this.timerListExports=setInterval(this.listExports,5e3),this.timerListTemplates=setInterval(this.listExportTemplates,2e3)},beforeDestroy(){clearInterval(this.timerListExports),clearInterval(this.timerListTemplates)},methods:{toggle(e){console.log(e);var t="/api/export/"+e.id+"/toggle";k.a.post(t).then(()=>{}).catch(e=>{console.log(e)})},listExports(){k.a.get("/api/export/").then(e=>this.exports=e.data).catch(e=>{console.log(e)}).finally(()=>{})},listExportTemplates(){k.a.get("/api/exporttemplate/").then(e=>this.exportTemplates=e.data.map(e=>e.name)).catch(e=>{console.log(e)}).finally(()=>{})},refresh(e){var t="/api/export/"+e.id+"/refresh";k.a.post(t).then(()=>{}).catch(e=>{console.log(e)})},isRefreshing(e){return"Updating..."===e.status},getRowClass(e){return e.enabled?"OK"===e.status?"is-success":void 0:"disabled"},updateExport(){var e=this.$refs.exportActsOn.checkHtml5Validity();if(e&=this.$refs.exportTemplate.checkHtml5Validity(),e&=this.$refs.exportName.checkHtml5Validity(),!e)return!1;var t={acts_on:this.selectedExport.acts_on,description:this.selectedExport.description,name:this.selectedExport.name,template:this.selectedExport.template};this.selectedExport.exclude_tags||(this.selectedExport.exclude_tags=[]),this.selectedExport.ignore_tags||(this.selectedExport.ignore_tags=[]),this.selectedExport.include_tags||(this.selectedExport.include_tags=[]),t.exclude_tags=this.selectedExport.exclude_tags.map(e=>e.name||e),t.ignore_tags=this.selectedExport.ignore_tags.map(e=>e.name||e),t.include_tags=this.selectedExport.include_tags.map(e=>e.name||e),k.a.post("/api/export/"+(this.selectedExport.id||""),t).then(()=>this.listExports()).catch(e=>console.log(e)).finally(()=>{})},confirmDeleteExport(){this.$buefy.dialog.confirm({title:"Delete export",message:`You're about to <b>delete</b> export <code>${this.selectedExport.name}</code>. Proceed?`,confirmText:"Delete Export",type:"is-danger",hasIcon:!0,onConfirm:this.deleteExport})},deleteExport(){k.a.delete("/api/export/"+this.selectedExport.id).then(()=>{this.listExports(),this.selectedExport={}}).catch(e=>console.log(e)).finally(()=>{})},downloadExport(e){k.a.get(`/api/export/${e.id}/content`).then(e=>{var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a"),s=e.headers["content-disposition"].split("filename=")[1];a.href=t,a.setAttribute("download",s),document.body.appendChild(a),a.click()}).catch(e=>{console.log(e)})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}}},ft=ht,gt=(a("117f"),Object(d["a"])(ft,pt,bt,!1,null,"2d7246f8",null)),vt=gt.exports,yt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-4"},[t("b-table",{attrs:{data:e.templates,hoverable:!0,narrowed:!0},on:{click:e.selectTemplate},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Name"}},[e._v(" "+e._s(a.row.name)+" ")]),t("b-table-column",{attrs:{field:"id",label:"ID"}},[e._v(" "+e._s(a.row.id)+" ")])]}}])})],1),t("div",{staticClass:"column is-8"},[t("b-field",{attrs:{label:"Name"}},[t("b-input",{ref:"templateName",attrs:{required:""},model:{value:e.templateName,callback:function(t){e.templateName=t},expression:"templateName"}})],1),t("b-field",{attrs:{label:"Template content"}},[t("b-input",{ref:"templateContent",attrs:{required:"",type:"textarea"},model:{value:e.templateContent,callback:function(t){e.templateContent=t},expression:"templateContent"}})],1),t("b-field",{attrs:{grouped:""}},[e.templateId?t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.updateTemplate}},[e._v("Save changes")])]):e._e(),e.templateId?t("p",{staticClass:"control"},[t("button",{staticClass:"button is-danger",on:{click:e.confirmDeleteTemplate}},[e._v("Delete template")])]):e._e(),e.templateId?e._e():t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.updateTemplate}},[e._v("Add new template")])]),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-light",on:{click:e.deselectTemplate}},[e._v("Clear form")])])]),e._v(" Example template body: "),e._m(0)],1)])},_t=[function(){var e=this,t=e._self._c;return t("span",{pre:!0},[t("pre",[e._v("<arbitrary>\n{% for obs in elements %}{{ obs.value }}\n{% endfor %}\n</arbitrary>")])])}],kt={name:"TemplateList",data(){return{templates:[],templateName:null,templateContent:null,templateId:null}},mounted(){this.listExportTemplates()},methods:{listExportTemplates(){k.a.get("/api/exporttemplate/").then(e=>{this.templates=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},selectTemplate(e){this.templateName=e.name,this.templateContent=e.template,this.templateId=e.id},deselectTemplate(){this.templateName=this.templateContent=this.templateId=null},updateTemplate(){var e=this.$refs.templateName.checkHtml5Validity();if(e&=this.$refs.templateContent.checkHtml5Validity(),e){var t={name:this.templateName,template:this.templateContent};k.a.post("/api/exporttemplate/"+(this.templateId||""),t).then(()=>{this.deselectTemplate(),this.listExportTemplates()}).catch(e=>{console.log(e)}).finally(()=>{})}},confirmDeleteTemplate(){this.$buefy.dialog.confirm({title:"Delete template",message:`You're about to <b>delete</b> Template <code>${this.templateName}</code>. Proceed?`,confirmText:"Delete template",type:"is-danger",hasIcon:!0,onConfirm:this.deleteTemplate})},deleteTemplate(){k.a.delete("/api/exporttemplate/"+this.templateId).then(()=>{this.deselectTemplate()}).catch(e=>{console.log(e)}).finally(()=>{this.listExportTemplates()})}}},wt=kt,xt=Object(d["a"])(wt,yt,_t,!1,null,null,null),Ct=xt.exports,Tt=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-7"},[t("div",{staticClass:"card"},[e._m(0),t("div",{staticClass:"card-content"},[e.profile?t("table",{staticClass:"table is-fullwidth"},[t("tbody",[t("tr",[t("th",[e._v("Username")]),t("td",[e._v(e._s(e.profile.username))]),t("td")]),t("tr",[t("th",[e._v("API key")]),t("td",[t("code",[e._v(e._s(e.profile.api_key))])]),t("td",[t("b-button",{staticClass:"button is-outline reset-button",attrs:{size:"is-small"},on:{click:function(t){return e.resetApiKey(e.profile)}}},[t("span",[e._v("Reset key")])])],1)]),t("tr",[t("th",[e._v("Groups")]),t("td",[t("b-taglist",e._l(e.profile.groups,(function(a){return t("b-tag",{key:a.groupname,attrs:{type:"is-info"}},[e._v(" "+e._s(a.groupname)+" ")])})),1)],1)])])]):e._e()])])]),t("div",{staticClass:"column is-5"},[t("div",{staticClass:"card"},[e._m(1),"local"===e.systemAuth?t("div",{staticClass:"card-content"},[t("b-field",[t("b-input",{attrs:{type:"password",placeholder:"Current password"},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}})],1),t("b-field",[t("b-input",{attrs:{type:"password",placeholder:"New password","password-reveal":""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),t("p",{staticClass:"control"},[t("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.changeUserPassword()}}},[e._v("Save")])],1)],1):e._e(),"oidc"===e.systemAuth?t("div",{staticClass:"card-content"},[e._v(" Authentication is handled by Open ID Connect. There is no password to change. ")]):e._e()])])]),t("div",{staticClass:"columns"},[e.profile?t("div",{staticClass:"column"},[t("b-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Permissions"}},[t("table",{staticClass:"table is-fullwidth"},[t("tbody",[t("tr",[t("th",[e._v("Permission type")]),t("th",[e._v("Read")]),t("th",[e._v("Write")]),t("th",[e._v("Refresh")]),t("th",[e._v("Toggle")])]),e._l(Object.keys(e.profile.permissions),(function(a){return t("tr",{key:a},[t("td",[e._v(e._s(a))]),t("td",[t("b-checkbox",{attrs:{disabled:null==e.profile.permissions[a].read||!e.isAdmin},model:{value:e.profile.permissions[a].read,callback:function(t){e.$set(e.profile.permissions[a],"read",t)},expression:"profile.permissions[type].read"}})],1),t("td",[t("b-checkbox",{attrs:{disabled:null==e.profile.permissions[a].write||!e.isAdmin},model:{value:e.profile.permissions[a].write,callback:function(t){e.$set(e.profile.permissions[a],"write",t)},expression:"profile.permissions[type].write"}})],1),t("td",[t("b-checkbox",{attrs:{disabled:null==e.profile.permissions[a].refresh||!e.isAdmin},model:{value:e.profile.permissions[a].refresh,callback:function(t){e.$set(e.profile.permissions[a],"refresh",t)},expression:"profile.permissions[type].refresh"}})],1),t("td",[t("b-checkbox",{attrs:{disabled:null==e.profile.permissions[a].toggle||!e.isAdmin},model:{value:e.profile.permissions[a].toggle,callback:function(t){e.$set(e.profile.permissions[a],"toggle",t)},expression:"profile.permissions[type].toggle"}})],1)])}))],2)]),t("p",{staticClass:"control"},[e.isAdmin?t("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.saveUserPermissions()}}},[e._v("Save permissions")]):e._e()],1)]),t("b-tab-item",{attrs:{label:"Misc settings"}},[t("p",{staticClass:"title is-4"},[e._v("Miscellaneous settings")]),t("p",{staticClass:"subtitle is-6"},[e._v(" Any Yeti object can register per-user settings for specific tweaking. This is especially useful for API keys or individual credentials. ")]),e._l(Object.keys(e.profile.available_settings),(function(a){return t("b-field",{key:e.profile.available_settings[a].name,attrs:{label:e.profile.available_settings[a].name}},[t("b-input",{attrs:{placeholder:e.profile.available_settings[a].description},model:{value:e.profile.settings[a],callback:function(t){e.$set(e.profile.settings,a,t)},expression:"profile.settings[setting_name]"}})],1)})),t("p",{staticClass:"control"},[t("b-button",{attrs:{type:"is-primary"},on:{click:function(t){return e.saveUserSettings()}}},[e._v("Save settings")])],1)],2)],1)],1):e._e()])])},jt=[function(){var e=this,t=e._self._c;return t("header",{staticClass:"card-header is-info"},[t("p",{staticClass:"card-header-title"},[e._v("Profile info")])])},function(){var e=this,t=e._self._c;return t("header",{staticClass:"card-header is-warning"},[t("p",{staticClass:"card-header-title"},[e._v("Change password")])])}],Et={name:"UserProfile",data(){return{profile:null,currentPassword:null,newPassword:null,availableSettings:[],activeTab:0}},props:{id:{type:String,default:null}},methods:{getUserProfile(){console.log("userprofile"),k.a.get(this.getEndpoint("")).then(e=>{this.profile=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},resetApiKey(e){k.a.post(this.getEndpoint("reset-api")).then(t=>{e.api_key=t.data.api_key,this.$buefy.notification.open({message:`API key for user <strong>${e.username}</strong> succesfully reset.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},changeUserPassword(){var e={current:this.currentPassword,new:this.newPassword};k.a.post(this.getEndpoint("change-password"),e).then(()=>{this.$buefy.notification.open({message:"Password succesfully changed.",type:"is-success"})}).catch(e=>{this.$buefy.notification.open({message:"Error: "+e.response.data.error,type:"is-danger"})}).finally(()=>{this.currentPassword=null,this.newPassword=null})},saveUserSettings(){k.a.post(this.getEndpoint("settings"),this.profile.settings).then(()=>{this.$buefy.notification.open({message:"Settings successfully updated.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},saveUserPermissions(){var e="/api/useradmin/permissions";null!==this.id&&(e+="/"+this.id),k.a.post(e,this.profile.permissions).then(e=>{this.profile.permissions=e.data.permissions,this.$buefy.notification.open({message:"Permissions successfully updated.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},getEndpoint(e){return null!==this.id?`/api/useradmin/${e}/${this.id}`.replace("//","/"):"/api/users/"+e}},computed:{isAdmin(){return this.$store.getters.isAdmin},tokenSubject(){return this.$store.getters.tokenSubject},systemAuth(){return this.$store.getters.appConfig.auth.module}},mounted(){this.getUserProfile()},watch:{id:function(){this.getUserProfile()}}},Ot=Et,St=(a("d315"),Object(d["a"])(Ot,Tt,jt,!1,null,"7a1084eb",null)),It=St.exports,$t=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-9"},[t("b-table",{attrs:{data:e.users,paginated:"","backend-pagination":"",total:e.totalUsers},on:{"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"username",label:"Username"}},[t("router-link",{attrs:{to:{name:"UserProfileAdmin",params:{id:a.row.id}}}},[e._v(" "+e._s(a.row.username)+" ")])],1),t("b-table-column",{attrs:{field:"api_key",label:"API key"}},[t("code",[e._v(e._s(a.row.api_key))]),t("b-button",{staticClass:"button is-outline reset-button",attrs:{size:"is-small"},on:{click:function(t){return e.resetApiKey(a.row)}}},[t("span",[e._v("Reset key")])])],1),t("b-table-column",{attrs:{field:"admin",label:"Admin"}},[t("b-checkbox",{nativeOn:{click:function(t){return e.toggleAdminUser(a.row)}},model:{value:a.row.permissions.admin,callback:function(t){e.$set(a.row.permissions,"admin",t)},expression:"user.row.permissions.admin"}})],1),t("b-table-column",{attrs:{field:"enabled",label:"Enabled"}},[t("b-checkbox",{nativeOn:{click:function(t){return e.toggleUser(a.row)}},model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"user.row.enabled"}})],1),t("b-table-column",{attrs:{"custom-key":"remove",label:"Remove"}},[t("b-button",{staticClass:"button is-warning",attrs:{size:"is-small"},on:{click:function(t){return e.confirmDeleteUser(a.row)}}},[t("b-icon",{attrs:{pack:"fas",icon:"trash-alt",size:"is-small"}}),t("span",[e._v("Remove")])],1)],1)]}}])})],1),t("div",{staticClass:"column is-3"},[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Search users"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("b-input",{attrs:{type:"text",placeholder:"Filter user list",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.listUsers.apply(null,arguments)}},model:{value:e.userFilter,callback:function(t){e.userFilter=t},expression:"userFilter"}})],1)]),t("br"),t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" You can reset a user's API key by clicking on the "),t("code",[e._v("reset")]),e._v(" button. ")]),t("p",[e._v(" To temporarily prevent a user from logging in, you can disable their account by clicking on the checkbox ")]),t("p",[t("strong",[e._v("Warning")]),e._v(": Removing users cannot be undone")])])])]),t("b-tab-item",{attrs:{label:"Add user"}},[t("form",[t("b-field",{attrs:{label:"Username"}},[t("b-input",{model:{value:e.newUsername,callback:function(t){e.newUsername=t},expression:"newUsername"}})],1),t("b-field",{attrs:{label:"Password"}},[t("b-input",{model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),t("b-field",{attrs:{grouped:""}},[t("b-checkbox",{staticClass:"control",model:{value:e.newAdmin,callback:function(t){e.newAdmin=t},expression:"newAdmin"}},[e._v("Admin")]),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.addUser}},[e._v("Add user")])])],1)],1),t("br"),t("article",{staticClass:"message tip"},[t("div",{staticClass:"message-body content"},[t("p",[e._v(" The "),t("code",[e._v("yeti")]),e._v(" user exists to enable anonymous access to Yeti. Disable it after logging in as a new user if you only want to allow authenticated access. ")])])])])],1)],1)])},Pt=[],Rt={name:"UserAdmin",data(){return{users:[],userFilter:"",page:1,totalUsers:100,activeTab:1,newUsername:null,newPassword:null,newAdmin:!1}},mounted(){this.listUsers(),this.getTotalUsers()},methods:{listUsers(){var e=this.searchParams;k.a.post("/api/useradminsearch/",e).then(e=>{this.users=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},onPageChange(e){this.page=e,this.listUsers()},getTotalUsers(){var e=this.searchParams;k.a.post("/api/useradminsearch/total",e).then(e=>{this.totalUsers=e.data.total}).catch(e=>{console.log(e)}).finally(()=>{})},clearForm(){this.newUsername=this.newPassword=null,this.newAdmin=!1},addUser(e){e.preventDefault(),k.a.post("/api/createuser",{username:this.newUsername,password:this.newPassword,admin:this.newAdmin}).then(e=>{this.getTotalUsers(),this.listUsers(),this.clearForm(),this.$buefy.notification.open({message:`Success! User <strong>${e.data.username}</strong> succesfully added.`,type:"is-success"})}).catch(e=>{this.$buefy.notification.open({message:"Error: "+e.response.data.error,type:"is-danger"})}).finally(()=>{})},toggleUser(e){k.a.post("/api/useradmin/toggle/"+e.id).then(()=>{this.$buefy.notification.open({message:"Changes saved.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},toggleAdminUser(e){k.a.post("/api/useradmin/toggle-admin/"+e.id).then(()=>{this.$buefy.notification.open({message:"Changes saved.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},confirmDeleteUser(e){this.$buefy.dialog.confirm({title:"Delete User",message:`You're about to <strong>delete</strong> user <code>${e.username}</code>. Proceed?`,confirmText:"Delete User",type:"is-danger",hasIcon:!0,onConfirm:()=>{this.deleteUser(e)}})},deleteUser(e){k.a.post("/api/useradmin/remove/"+e.id).then(()=>{this.getTotalUsers(),this.listUsers(),this.$buefy.notification.open({message:`User <strong>${e.username}</strong> succesfully deleted.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},resetApiKey(e){k.a.post("/api/useradmin/reset-api/"+e.id).then(t=>{e.api_key=t.data.api_key,this.$buefy.notification.open({message:`API key for user <strong>${e.username}</strong> succesfully reset.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})}},computed:{searchParams(){var e={params:{page:this.page,regex:!0,ignorecase:!0}};return this.userFilter&&(e.filter={username:this.userFilter}),e}}},At=Rt,Lt=(a("1fe5"),Object(d["a"])(At,$t,Pt,!1,null,null,null)),Ut=Lt.exports,Nt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-8"},[t("b-table",{staticClass:"group-table",attrs:{data:e.groups,paginated:"","backend-pagination":"",hoverable:"",total:e.totalGroups},on:{"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"groupname",label:"Group name"}},[e._v(e._s(a.row.groupname))]),t("b-table-column",{attrs:{field:"enabled",label:"Enabled"}},[t("b-checkbox",{nativeOn:{click:function(t){return e.toggleGroup(a.row)}},model:{value:a.row.enabled,callback:function(t){e.$set(a.row,"enabled",t)},expression:"group.row.enabled"}})],1),t("b-table-column",{attrs:{"custom-key":"edit",label:"",width:"60"}},[t("b-icon",{attrs:{pack:"fas",icon:"edit"},nativeOn:{click:function(t){return e.editGroup(a.row)}}})],1),t("b-table-column",{attrs:{"custom-key":"remove",label:"",width:"60"}},[t("b-icon",{attrs:{pack:"fas",icon:"trash-alt",type:"is-danger"},nativeOn:{click:function(t){return e.confirmDeleteGroup(a.row)}}})],1)]}}])})],1),t("div",{staticClass:"column is-4"},[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Search groups"}},[t("div",{staticClass:"search"},[t("div",{staticClass:"field"},[t("b-input",{attrs:{type:"text",placeholder:"Filter group list",icon:"search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.listGroups.apply(null,arguments)}},model:{value:e.groupFilter,callback:function(t){e.groupFilter=t},expression:"groupFilter"}})],1)]),t("br")]),t("b-tab-item",{attrs:{label:"Add group"}},[t("form",[t("b-field",{attrs:{label:"Group name"}},[t("b-input",{model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}})],1),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.addGroup}},[e._v("Add group")])])],1),t("br")]),t("b-tab-item",{attrs:{label:"Edit group"}},[t("edit-group",{attrs:{groupId:e.selectedGroup}})],1)],1)],1)])},Ft=[],Dt=function(){var e=this,t=e._self._c;return e.group?t("div",[t("h1",{staticClass:"is-size-4"},[e._v(" Editing group: "),t("b",{staticClass:"has-text-weight-medium"},[e._v(e._s(e.group.groupname))])]),t("br"),t("b-field",{attrs:{label:""}},[t("b-autocomplete",{attrs:{data:e.users,placeholder:"Search for users to add",icon:"search",clearable:"",field:"username"},on:{select:t=>e.addMember(t)},nativeOn:{keyup:[function(t){return e.listUsers.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(()=>e.addMember(e.findUser(e.username))).apply(null,arguments)}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}},[t("template",{slot:"empty"},[e._v("No results found")])],2)],1),t("b-table",{staticClass:"group-members",attrs:{data:e.group.members},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"Username"}},[e._v(e._s(a.row.username))]),t("b-table-column",{attrs:{field:"admin",label:"Is admin?"}},[t("b-checkbox",{attrs:{value:e.isGroupAdmin(a.row)},nativeOn:{click:function(t){return e.toggleAdmin(a.row)}}})],1),t("b-table-column",{attrs:{field:"remove",label:"",width:"60"}},[t("b-icon",{attrs:{pack:"fas",icon:"minus-circle",type:"is-danger"},nativeOn:{click:function(t){return e.removeMember(a.row)}}})],1)]}}],null,!1,4025472522)})],1):e._e()},zt=[],Gt={name:"EditGroup",props:["groupId"],data(){return{group:null,users:[],username:null,selected:null}},mounted(){this.listUsers()},methods:{getGroupDetails(){k.a.get("/api/groupadmin/"+this.groupId).then(e=>{this.group=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},isGroupAdmin(e){return this.group.admins.map(e=>e.id).indexOf(e.id)>=0},findUser(e){return this.users.find(t=>t.username===e)},addMember(e){if(console.log(e),null!==e){var t={uid:e.id,gid:this.group.id};k.a.post("/api/groupadmin/add-member",t).then(t=>{this.group=t.data,this.$buefy.notification.open({message:`Member <strong>${e.username}</strong> succesfully added to <strong>${this.group.groupname}</strong>.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})}},removeMember(e){var t={uid:e.id,gid:this.group.id};k.a.post("/api/groupadmin/remove-member",t).then(t=>{this.group=t.data,this.$buefy.notification.open({message:`Member <strong>${e.username}</strong> succesfully removed from <strong>${this.group.groupname}</strong>.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},listUsers(){k.a.post("/api/useradminsearch/",this.searchParams).then(e=>{this.users=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},toggleAdmin(e){var t={uid:e.id,gid:this.group.id};k.a.post("/api/groupadmin/toggle-admin",t).then(e=>{console.log(e)}).catch(e=>{console.log(e)}).finally(()=>{})}},computed:{searchParams(){var e={params:{page:1,regex:!0,ignorecase:!0}};return this.username&&(e.filter={username:this.username}),e}},watch:{groupId:"getGroupDetails"}},qt=Gt,Mt=(a("634d"),Object(d["a"])(qt,Dt,zt,!1,null,"16fff3cb",null)),Yt=Mt.exports,Qt={name:"GroupAdmin",components:{EditGroup:Yt},data(){return{groups:[],totalGroups:500,page:1,activeTab:0,newGroupName:null,groupFilter:null,selectedGroup:null}},mounted(){this.listGroups(),this.getTotalGroups()},methods:{listGroups(){var e=this.searchParams;k.a.post("/api/groupadminsearch/",e).then(e=>{this.groups=e.data}).catch(e=>{console.log(e)}).finally(()=>{})},onPageChange(e){this.page=e,this.listGroups()},toggleGroup(e){k.a.post("/api/groupadmin/toggle/"+e.id).then(()=>{this.$buefy.notification.open({message:"Changes saved.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},confirmDeleteGroup(e){this.$buefy.dialog.confirm({title:"Delete group",message:`You're about to <strong>delete</strong> group <code>${e.groupname}</code>. Proceed?`,confirmText:"Delete group",type:"is-danger",hasIcon:!0,onConfirm:()=>{this.deleteGroup(e)}})},deleteGroup(e){k.a.delete("/api/groupadmin/"+e.id).then(()=>{this.getTotalGroups(),this.listGroups(),this.$buefy.notification.open({message:`Group <strong>${e.groupname}</strong> succesfully deleted.`,type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{})},getTotalGroups(){k.a.post("/api/groupadminsearch/total",this.searchParams).then(e=>{this.totalGroups=e.data.total}).catch(e=>{console.log(e)}).finally(()=>{})},addGroup(e){e.preventDefault(),k.a.post("/api/creategroup",{groupname:this.newGroupName}).then(e=>{this.getTotalGroups(),this.listGroups(),this.clearForm(),this.$buefy.notification.open({message:`Success! Group <strong>${e.data.groupname}</strong> succesfully added.`,type:"is-success"})}).catch(e=>{this.$buefy.notification.open({message:"Error: "+e.response.data.error,type:"is-danger"})}).finally(()=>{})},clearForm(){this.newGroupName=null},editGroup(e){this.activeTab=2,this.selectedGroup=e.id}},computed:{searchParams(){var e={params:{page:this.page,regex:!0,ignorecase:!0}};return this.groupFilter&&(e.filter={groupname:this.groupFilter}),e}}},Ht=Qt,Bt=(a("f3fc"),Object(d["a"])(Ht,Nt,Ft,!1,null,"64b0dae0",null)),Kt=Bt.exports,Vt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-9"},[t("b-table",{attrs:{data:e.tags,total:e.tableTotal,"backend-pagination":"",loading:e.loading,perPage:50,paginated:"",hoverable:!0,narrowed:!0,"current-page":e.tablePage},on:{click:e=>this.selectedTag=JSON.parse(JSON.stringify(e)),"page-change":e.onPageChange},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-table-column",{attrs:{field:"name",label:"name"}},[t("b-tag",[e._v(e._s(a.row.name))])],1),t("b-table-column",{attrs:{field:"default_expiration",label:"Default expiration"}},[e._v(" "+e._s(a.row.default_expiration)+" ")]),t("b-table-column",{attrs:{field:"count",label:"Count"}},[e._v(e._s(a.row.count))]),t("b-table-column",{attrs:{field:"produces",label:"Produces"}},[t("b-taglist",e._l(a.row.produces,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"replaces",label:"Replaces"}},[t("b-taglist",e._l(a.row.replaces,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("b-table-column",{attrs:{field:"created",label:"Created (UTC)",width:"180"}},[t("span",{attrs:{title:"Localtime: "+e.formatTimestamp(a.row.created,!0)}},[e._v(e._s(e.formatTimestamp(a.row.created)))])])]}}])})],1),t("div",{staticClass:"column is-3"},[t("b-tabs",{attrs:{position:"is-centered",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("b-tab-item",{attrs:{label:"Edit tag"}},[t("b-field",{attrs:{label:"Name"}},[t("b-input",{model:{value:e.selectedTag.name,callback:function(t){e.$set(e.selectedTag,"name",t)},expression:"selectedTag.name"}})],1),t("b-field",{attrs:{label:"Produced tags"}},[t("yeti-tag-input",{model:{value:e.selectedTag.produces,callback:function(t){e.$set(e.selectedTag,"produces",t)},expression:"selectedTag.produces"}})],1),t("b-field",{attrs:{label:"Replaces"}},[t("yeti-tag-input",{model:{value:e.selectedTag.replaces,callback:function(t){e.$set(e.selectedTag,"replaces",t)},expression:"selectedTag.replaces"}})],1),t("b-field",{attrs:{label:"Expiration (seconds)"}},[t("b-input",{model:{value:e.selectedTag.default_expiration,callback:function(t){e.$set(e.selectedTag,"default_expiration",t)},expression:"selectedTag.default_expiration"}})],1),t("b-field",{attrs:{grouped:""}},[e.selectedTag.id?t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.updateTag}},[e._v("Save changes")])]):e._e(),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-light",on:{click:function(t){e.selectedTag={}}}},[e._v("Clear form")])])])],1),t("b-tab-item",{attrs:{label:"Merge tag"}},[t("tag-merge")],1)],1),t("b-tabs",{attrs:{position:"is-centered"}},[t("b-tab-item",{attrs:{label:"Filter tags"}},[t("b-field",{attrs:{label:"Name"}},[t("b-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchTags.apply(null,arguments)}},model:{value:e.tagFilter,callback:function(t){e.tagFilter=t},expression:"tagFilter"}})],1)],1)],1)],1)])},Wt=[],Jt=function(){var e=this,t=e._self._c;return t("div",[t("b-field",{attrs:{label:"Merge"}},[t("yeti-tag-input",{model:{value:e.merge,callback:function(t){e.merge=t},expression:"merge"}})],1),t("b-field",{attrs:{label:"Merge into"}},[t("yeti-tag-input",{attrs:{maxtags:1},model:{value:e.mergeInto,callback:function(t){e.mergeInto=t},expression:"mergeInto"}})],1),t("b-field",[t("b-checkbox",{model:{value:e.permanent,callback:function(t){e.permanent=t},expression:"permanent"}},[e._v("Make merge permanent")])],1),t("p",{staticClass:"control"},[t("button",{staticClass:"button is-primary",on:{click:e.mergeTags}},[e._v("Merge")])])],1)},Zt=[],Xt={name:"TagsMerge",components:{YetiTagInput:q},data(){return{merge:null,mergeInto:null,permanent:!1}},methods:{mergeTags(){if(this.merge&&this.mergeInto){var e={make_dict:this.permanent,merge_into:this.mergeInto[0].name,merge:this.merge.map(e=>e.name)};this.clearForm(),k.a.post("/api/tag/merge",e).then(()=>{this.$buefy.notification.open({message:"Changes succesfully changed.",type:"is-success"})}).catch(e=>{console.log(e)}).finally(()=>{this.clearForm()})}},clearForm(){this.mergeInto=[],this.merge=[]}}},ea=Xt,ta=Object(d["a"])(ea,Jt,Zt,!1,null,null,null),aa=ta.exports,sa={name:"TagsAdmin",components:{YetiTagInput:q,TagMerge:aa},data(){return{tags:[],selectedTag:{},activeTab:0,tablePage:1,tableTotal:500,loading:!1,tagFilter:""}},mounted(){this.searchTags()},methods:{searchTags(e=!0){var t={filter:{name:this.tagFilter},params:{regex:!0,page:this.tablePage}};console.log(t),e&&this.countTotal(t),this.loading=!0,k.a.post("/api/tagsearch/",t).then(e=>(this.tags=e.data,0===this.tags.length&&(this.tablePage=1),this.tags)).catch(e=>console.log(e)).finally(()=>{this.loading=!1})},countTotal(e){this.tableTotal=500,k.a.post("/api/tagsearch/total",e).then(e=>{this.tableTotal=e.data.total}).catch(e=>{console.log(e)})},onPageChange(e){this.tablePage=e,this.searchTags(!1)},updateTag(){var e={name:this.selectedTag.name,produces:this.selectedTag.produces.map(e=>e.name||e),replaces:this.selectedTag.replaces.map(e=>e.name||e),default_expiration:this.selectedTag.default_expiration};k.a.post("/api/tag/"+this.selectedTag.id,e).then(()=>{this.getTags()}).catch(e=>{console.log(e)}).finally(()=>{})},formatTimestamp(e,t){return B.formatTimestamp(e,t)}}},ia=sa,la=Object(d["a"])(ia,Vt,Wt,!1,null,null,null),na=la.exports,oa=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-6"},[t("h1",{staticClass:"is-size-2"},[e._v("Worker status")]),e.infoLoading?t("b-progress",{attrs:{size:"is-medium","show-value":""}},[e._v(" Pinging Celery workers... ")]):e._e(),e.info?t("table",{staticClass:"table is-narrow is-fullwidth"},[t("tbody",[e._m(0),e._l(Object.keys(e.info.registered),(function(a){return t("tr",{key:a},[t("td",[e._v(e._s(a))]),t("td",[t("b-taglist",e._l(e.info.registered[a].processes,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1),t("td",[e._v(e._s(e.info.registered[a].active?"Yes":"No"))]),t("td",[t("b-button",{on:{click:function(t){return e.restartWorker(a)}}},[e._v("Restart")])],1)])}))],2)]):e._e(),e.info?t("table",{staticClass:"table is-narrow is-fullwidth"},[t("tbody",[e._m(1),e._l(Object.keys(e.info.active),(function(a){return t("tr",{key:a},[t("td",[e._v(e._s(a))]),t("td",[t("b-taglist",e._l(e.info.active[a].running,(function(a){return t("b-tag",{key:a},[e._v(" "+e._s(a)+" ")])})),1)],1)])}))],2)]):e._e(),t("div",{staticClass:"buttons"},[t("b-button",{attrs:{type:"is-danger"},on:{click:function(t){return e.restartWorker("all")}}},[e._v("Restart All workers")])],1)],1),t("div",{staticClass:"column is-6"},[t("h1",{staticClass:"is-size-2"},[e._v("System config")]),t("pre",[e._v(e._s(e.appConfig))])])])])},ra=[function(){var e=this,t=e._self._c;return t("tr",[t("th",[e._v("Registered worker")]),t("th",[e._v("Process IDs")]),t("th",[e._v("Active")]),t("th",[e._v("Restart")])])},function(){var e=this,t=e._self._c;return t("tr",[t("th",[e._v("Workers")]),t("th",[e._v("Active tasks")])])}],ca={name:"System",data(){return{info:null,infoLoading:!1}},mounted(){this.getWorkerInfo()},methods:{getWorkerInfo(){this.infoLoading=!0,k.a.get("/api/system/").then(e=>{this.info=e.data,this.infoLoading=!1}).catch(e=>{console.log(e)})},restartWorker(e){k.a.get("/api/system/restart/worker/"+e).then(e=>{this.$buefy.notification.open({message:e.data.message,type:"success"==e.data.status?"is-success":"is-danger"})}).catch(e=>{console.log(e)})}},computed:{appConfig(){return this.$store.getters.appConfig}}},da=ca,ua=Object(d["a"])(da,oa,ra,!1,null,null,null),pa=ua.exports,ba=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns"},[t("div",{staticClass:"column is-4 is-offset-4"},[t("div",{staticClass:"card is-wide has-text-centered loginform"},[t("div",{staticClass:"card-content"},[t("p",{staticClass:"title"},[e._v("Log in to Yeti")]),t("form",{on:{submit:e.logIn}},[t("b-field",{attrs:{label:"Username"}},[t("b-input",{model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1),t("b-field",{attrs:{label:"Password"}},[t("b-input",{attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),t("b-button",{attrs:{type:"is-primary","native-type":"submit"}},[e._v("Login")])],1)])])])])},ma=[],ha={name:"Login",data(){return{user:null,password:null,loading:!1}},methods:{logIn(e){console.log("submitted"),e.preventDefault(),this.loading=!0,this.$store.dispatch("login",{user:this.user,password:this.password}).then(()=>{console.log("Successfully logged in!"),this.$router.push("/")}).catch(e=>{this.$buefy.notification.open({message:e.response.data.error,type:"is-danger"})}).finally(()=>{this.loading=!1})}}},fa=ha,ga=(a("479b"),Object(d["a"])(fa,ba,ma,!1,null,null,null)),va=ga.exports,ya=a("2f62");s["a"].use(ya["a"]);const _a={user:null,appConfig:null},ka={login({commit:e},t){return new Promise((a,s)=>{e("authRequest"),k.a.post("/api/auth/login",t).then(t=>{!0===t.data.authenticated&&(k.a.get("/api/users").then(t=>e("authSuccess",t.data)),a(t))}).catch(t=>{e("authError",t),s(t)})})},logout({commit:e}){return new Promise(t=>{k.a.post("/api/auth/logout").then(a=>{e("logout"),t(a)})})},refresh({commit:e}){return new Promise((t,a)=>{k.a.get("/api/users/").then(a=>{console.log("Session refresh success"),e("authSuccess",a.data),t(a)}).catch(e=>{console.log("Session refresh fail"),a(e)})})},getAppConfig({commit:e}){k.a.get("/api/system/config/").then(t=>{e("setAppConfig",t.data)})}},wa={authRequest(e){e.user=null},authSuccess(e,t){e.user=t},authError(e,t){console.log(t),e.user=null},logout(e){e.user=null},setAppConfig(e,t){e.appConfig=t}},xa={isAuthenticated:e=>!!e.user,isAdmin:e=>!!e.user&&!!e.user.permissions.admin,tokenSubject:e=>e.user.username,appConfig:e=>e.appConfig},Ca=new ya["a"].Store({state:_a,actions:ka,mutations:wa,getters:xa});var Ta=Ca;s["a"].use(g["a"]);const ja=[{path:"/",name:"ObservableSearch",component:P},{path:"/browse",name:"ObservableList",component:J,props:e=>({searchQuery:e.query.q})},{path:"/observable/:id([a-z0-9]{24})",name:"ObservableDetails",component:Xe,props:!0},{path:"/entities",name:"EntityList",component:de,props:e=>({searchQuery:e.query.q})},{path:"/entity/:id([a-z0-9]{24})",name:"EntityDetails",component:Se,props:!0},{path:"/indicators",name:"IndicatorList",component:Le,props:e=>({searchQuery:e.query.q})},{path:"/indicator/:id([a-z0-9]{24})",name:"IndicatorDetails",component:Ge,props:!0},{path:"/feeds",name:"Feeds",component:lt},{path:"/analytics",name:"Analytics",component:ut},{path:"/exports",name:"Exports",component:vt},{path:"/templates",name:"Templates",component:Ct},{path:"/profile/:id([a-z0-9]{24})",name:"UserProfileAdmin",component:It,props:!0},{path:"/profile",name:"UserProfile",component:It},{path:"/admin/users",name:"UserAdmin",component:Ut},{path:"/admin/groups",name:"GroupAdmin",component:Kt},{path:"/admin/tags",name:"TagsAdmin",component:na},{path:"/admin/system",name:"SystemView",component:pa},{path:"/login",name:"Login",component:va}],Ea=new g["a"]({mode:"history",base:"/",linkActiveClass:"is-active",routes:ja});Ea.beforeEach((e,t,a)=>{"Login"==e.name?a():null===Ta.state.user?Ta.dispatch("refresh").then(()=>{console.log("redirecting to "+e.fullPath),a({path:e.fullPath})}).catch(()=>{console.log("redirecting to /auth/login"),window.location.href="/auth/login"}):a()});var Oa=Ea,Sa=a("289d"),Ia=a("ecee"),$a=a("c074"),Pa=a("ad3d");s["a"].config.productionTip=!1,Ia["c"].add($a["a"]),s["a"].component("vue-fontawesome",Pa["a"]),s["a"].use(Sa["a"],{defaultIconComponent:"vue-fontawesome",defaultIconPack:"fas"}),new s["a"]({router:Oa,store:Ta,render:e=>e(f),created(){this.$store.dispatch("getAppConfig")}}).$mount("#app")},"5dc5":function(e,t,a){},"634d":function(e,t,a){"use strict";a("223d")},6629:function(e,t,a){},"678b":function(e,t,a){},"692f":function(e,t,a){},"725d":function(e,t,a){"use strict";a("6629")},"7c20":function(e,t,a){"use strict";a("03fd")},"7ff2":function(e,t,a){"use strict";a("b454")},"856e":function(e,t,a){},"8eae":function(e,t,a){},"90c7":function(e,t,a){"use strict";a("f7d3")},9484:function(e,t,a){"use strict";a("1a13")},9766:function(e,t,a){"use strict";a("c2d6")},9785:function(e,t,a){"use strict";a("d006")},a5c5:function(e,t,a){"use strict";a("43ac")},b1ff:function(e,t,a){"use strict";a("8eae")},b2d4:function(e,t,a){"use strict";a("1d39")},b454:function(e,t,a){},c2d6:function(e,t,a){},c693:function(e,t,a){},d006:function(e,t,a){},d315:function(e,t,a){"use strict";a("5dc5")},f3ec:function(e,t,a){},f3fc:function(e,t,a){"use strict";a("c693")},f7d3:function(e,t,a){}});
//# sourceMappingURL=app.e052d923.js.map