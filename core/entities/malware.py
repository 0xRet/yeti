from __future__ import unicode_literals

from mongoengine import *

from core.entities import Entity

from core.database import StringListField


class Malware(Entity):
    aliases = ListField(StringField(), verbose_name="Aliases")
    family = StringField()

    DISPLAY_FIELDS = Entity.DISPLAY_FIELDS + [
        ("aliases", "Aliases"),
        ("family", "Family"),
    ]

    def info(self):
        i = Entity.info(self)
        i["family"] = self.family
        i["aliases"] = self.aliases
        i["type"] = "malware"
        return i

    def generate_tags(self):
        tags = [self.name.lower()]
        if self.family is not None:
            tags.append(self.family.name.lower())
        return tags
