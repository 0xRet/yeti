from mongoengine import *

from core.entities import Entity

class MalwareFamily(Document):

    name = StringField(required=True, unique=True)

class Malware(Entity):

    aliases = ListField(StringField())
    family = ReferenceField(MalwareFamily)

    def add_alias(alias):
        self.modify(add_to_set__aliases=alias)
        self.reload()
