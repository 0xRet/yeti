from mongoengine import *

from core.entities import Entity
from core.entities import KILL_CHAIN_STEPS

class MalwareFamily(Document):

    name = StringField(required=True, unique=True)

class Malware(Entity):

    aliases = ListField(StringField())
    family = ReferenceField(MalwareFamily)
    killchain = StringField(choices=KILL_CHAIN_STEPS)

    def add_alias(alias):
        self.modify(add_to_set__aliases=alias)
        self.reload()
