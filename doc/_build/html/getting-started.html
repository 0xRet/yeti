

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting started &mdash; YETI 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="YETI 1.0 documentation" href="index.html"/>
        <link rel="next" title="Yeti objects" href="objects.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> YETI
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#malware-stolen-data">Malware stolen data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-malware-entity">Creating a Malware Entity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-observables">Adding Observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-indicators">Adding indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automation">Automation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Yeti objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">Extending Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">The API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YETI</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Getting started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/getting-started.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>So Yeti sounds cool, but how to I actually use it? Glad you asked. even though
great efforts have been made to &#8220;build the manual into the UI&#8221;, it&#8217;s natural
that some questions arise.</p>
<p>You will need to have a running install of Yeti for this to make any sense.
Please refer to the <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Installation</span></a> section of the documentation.</p>
<p><em>What is it all about?</em></p>
<p>Yeti is about organizing observables, indicators of compromise, TTPs, and
knowledge on threat actors in a single, unified repository. Ideally, this
repository should be queryable in an automated way by other tools (spoiler:
it is!)</p>
<div class="section" id="malware-stolen-data">
<h2>Malware stolen data<a class="headerlink" href="#malware-stolen-data" title="Permalink to this headline">¶</a></h2>
<p>You just analyzed the latest Dridex sample and you figured out that it&#8217;s using
a subdirectory in the user&#8217;s <code class="docutils literal"><span class="pre">Roaming</span></code> directory to store its data, and you&#8217;d
like to document this. <em>(Whether this is a strong indicator or not is another
story)</em>.</p>
<p>You start by adding a new <strong>Entity</strong> of type <strong>Malware</strong> called Dridex. Navigate
to <strong>New &gt; Malware</strong>, and populate the fields.</p>
<div class="section" id="creating-a-malware-entity">
<h3>Creating a Malware Entity<a class="headerlink" href="#creating-a-malware-entity" title="Permalink to this headline">¶</a></h3>
<p>You start by adding the observable in Yeti&#8217;s repository. Navigate to
<strong>Observables &gt; Search &amp; Add</strong> (which also happens to be the landing page). This page allows you
to add one or more observables to the repository and tag them accordingly.</p>
<img alt="_images/new_malware.png" src="_images/new_malware.png" />
<p>Most fields are self-explanatory. As for the others:</p>
<ul class="simple">
<li><strong>Tags that link to this entity</strong> - Observables tagged with the Tags specified
here will be linked to this Entity. See note below for more information.</li>
<li><strong>Bind to entities</strong> - Allows you to bind this entity to another one. malware to TTPs, actors to malware, etc.</li>
<li><strong>Aliases</strong> - Other known names for this entity. This field will be indexed in search too.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tags are a way to quickly assess an Observable&#8217;s context. Yeti also uses tags
to link observables to <strong>Entities</strong> (TTPs, Actors, Exploit Kits, etc.)
When you tag an observable, Yeti will
look for any Entities that have declared these tags and link the observable to them. You
can also tag observables even if no Entity has declared it; it will just not be linked to anything.
This is may be useful for tags like <code class="docutils literal"><span class="pre">sinkhole</span></code>, <code class="docutils literal"><span class="pre">whitelist</span></code>, <code class="docutils literal"><span class="pre">internal</span></code>.</p>
</div>
<p>Clicking on <strong>Save</strong> will take you to the following page:</p>
<img alt="_images/malware_page.png" src="_images/malware_page.png" />
<p>This will be your go-to page for all information on Dridex. You can get back to it
by navigating to &#8220;Entities &gt; Malware&#8221;.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>Files</strong> control box allows you to upload files (external reports, samples, etc.) and attach them to this Entity.
<em>(No further processing is done on these files, for the moment)</em>.</p>
</div>
<p>Any other linked entities will appear in their corresponding tab under the <strong>Description</strong> section.</p>
</div>
<div class="section" id="adding-observables">
<h3>Adding Observables<a class="headerlink" href="#adding-observables" title="Permalink to this headline">¶</a></h3>
<p><strong>Time to add our observable!</strong> Head to <strong>Observables &gt; Search &amp; Add</strong>. This page
allows you to add or try to match one or several Observables. The &#8220;write&#8221; behavior
is toggled by the <strong>Add unknown observables to database</strong> checkbox. When adding
Observables, you can specify one or more Tags for your observable as well as the observable type.
Guessing should be fine for most observable types (URLs, IP addresses, hostnames)
but make sure you specify it if it gets ambiguous (e.g. Bitcoin address vs. Hash).</p>
<img alt="_images/add_observable.png" src="_images/add_observable.png" />
<p>Click on <strong>Launch</strong> to launch the Search / Add procedure.</p>
<img alt="_images/add_result.png" src="_images/add_result.png" />
<p>The results page shows the newly added Observable(s) as well as any entities
associated linked to them, if any. In this case, we&#8217;re &#8220;cheating&#8221; since tagging
our Observable &#8220;Dridex&#8221; associated the observable to the malware. But if another
analyst searches for the same observable, they will leverage Yeti&#8217;s database and
see the newly created association (you can try this by just searching for your
Observable again, with the &#8220;Add to database&#8221; checkbox off.).</p>
<p>Going back to the Dridex page and selecting the &#8220;Observables&#8221; tab shows the link
was successful. You can break the link between Entities and Observables by hovering
on the line and clicking the &#8220;Unlink&#8221; icon, as can be seen below:</p>
<img alt="_images/malware_observable.png" src="_images/malware_observable.png" />
</div>
<div class="section" id="adding-indicators">
<h3>Adding indicators<a class="headerlink" href="#adding-indicators" title="Permalink to this headline">¶</a></h3>
<p>The following week, you run into a new sample of Dridex which has changed. It
now stores its data in a random subdirectory under <code class="docutils literal"><span class="pre">Roaming</span></code>. You&#8217;ve observed
the following paths:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C:\Users\admin\AppData\Roaming\Famas</span></code></li>
<li><code class="docutils literal"><span class="pre">C:\Users\admin\AppData\Roaming\Thssk</span></code></li>
<li><code class="docutils literal"><span class="pre">C:\Users\admin\AppData\Roaming\Lzmoo</span></code></li>
</ul>
<p>You add the three observables to the database as seen before, tagging them
<code class="docutils literal"><span class="pre">dridex</span></code>. But what if an analyst searches for
<code class="docutils literal"><span class="pre">C:\Users\admin\AppData\Roaming\Enxa</span></code> or <code class="docutils literal"><span class="pre">C:\Users\admin\AppData\Roaming\Xiwa</span></code>?
This is precisely what indicators are for.</p>
<p>Think of indicators as an &#8220;enhanced Observable&#8221;. Indicators come in two flavors,
simple regular expressions or Yara rules. When submitting Observables in &#8220;Search
&amp; Add&#8221;, they will be compared to all the Indicators in Yeti&#8217;s database and any
matches will be displayed.</p>
<p>Head over to <strong>New &gt; Regular expression</strong> and complete as follows:</p>
<img alt="_images/indicator_new.png" src="_images/indicator_new.png" />
<p>Short explanation on fields:</p>
<ul class="simple">
<li><strong>Location</strong> - This helps the analyst know where it can find this indicator.
This is free-text and useful values could be <em>Filesystem</em>, <em>HTTP headers</em>,
<em>HTTP URI</em>, <em>Registry</em>, etc.</li>
<li><strong>Diamond edge</strong> - Corresponding Diamond Model edge.</li>
<li><strong>Link with entities</strong> - Link this Indicator to other entities. In this case
we want to link it to Dridex.</li>
<li><strong>Pattern</strong> - Complete this with your regular expression or Yara rule.</li>
</ul>
<img alt="_images/indicator_dridex.png" src="_images/indicator_dridex.png" />
<p>Note how the <strong>Malware</strong> tab now shows a link to the Dridex malware. Opening the
Dridex entity and selecting the <strong>Indicators</strong> tab also reflects this
relationship:</p>
<img alt="_images/dridex_indicators.png" src="_images/dridex_indicators.png" />
</div>
<div class="section" id="automation">
<h3>Automation<a class="headerlink" href="#automation" title="Permalink to this headline">¶</a></h3>
<p>All this information can be queried from other software (think incident
management platforms, forensic frameworks...) using Yeti&#8217;s API:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ http -vv --json POST localhost:5000/api/observablesearch/ filter:=&#39;{&quot;value&quot;: &quot;Roaming&quot;}&#39; params:=&#39;{&quot;regex&quot;: &quot;true&quot;}&#39;
POST /api/observablesearch/ HTTP/1.1
Accept: application/json, */*
Accept-Encoding: gzip, deflate
Connection: keep-alive
Content-Length: 61
Content-Type: application/json
Host: localhost:5000
User-Agent: HTTPie/0.9.8

{
    &quot;filter&quot;: {
        &quot;value&quot;: &quot;Roaming&quot;
    },
    &quot;params&quot;: {
        &quot;regex&quot;: &quot;true&quot;
    }
}

HTTP/1.0 200 OK
Content-Length: 2033
Content-Type: application/json
Date: Mon, 06 Mar 2017 17:38:50 GMT
Server: Werkzeug/0.11.15 Python/2.7.13

[
    {
        &quot;context&quot;: [],
        &quot;created&quot;: &quot;2017-03-06T17:35:07.614000&quot;,
        &quot;human_url&quot;: &quot;http://localhost:5000/observable/58bd9dcb10c553738521480e&quot;,
        &quot;id&quot;: &quot;58bd9dcb10c553738521480e&quot;,
        &quot;last_analyses&quot;: {},
        &quot;sources&quot;: [],
        &quot;tags&quot;: [
            {
                &quot;first_seen&quot;: &quot;2017-03-06T17:35:07.627000&quot;,
                &quot;fresh&quot;: true,
                &quot;last_seen&quot;: &quot;2017-03-06T17:35:07.627000&quot;,
                &quot;name&quot;: &quot;dridex&quot;
            }
        ],
        &quot;type&quot;: &quot;Path&quot;,
        &quot;url&quot;: &quot;http://localhost:5000/api/observable/58bd9dcb10c553738521480e&quot;,
        &quot;value&quot;: &quot;C:\\Users\\admin\\AppData\\Roaming\\Lzmoo&quot;
    },
    {
        &quot;context&quot;: [],
        &quot;created&quot;: &quot;2017-03-06T17:35:07.592000&quot;,
        &quot;human_url&quot;: &quot;http://localhost:5000/observable/58bd9dcb10c553738521480b&quot;,
        &quot;id&quot;: &quot;58bd9dcb10c553738521480b&quot;,
        &quot;last_analyses&quot;: {},
        &quot;sources&quot;: [],
        &quot;tags&quot;: [
            {
                &quot;first_seen&quot;: &quot;2017-03-06T17:35:07.606000&quot;,
                &quot;fresh&quot;: true,
                &quot;last_seen&quot;: &quot;2017-03-06T17:35:07.606000&quot;,
                &quot;name&quot;: &quot;dridex&quot;
            }
        ],
        &quot;type&quot;: &quot;Path&quot;,
        &quot;url&quot;: &quot;http://localhost:5000/api/observable/58bd9dcb10c553738521480b&quot;,
        &quot;value&quot;: &quot;C:\\Users\\admin\\AppData\\Roaming\\Thssk&quot;
    },
    {
        &quot;context&quot;: [],
        &quot;created&quot;: &quot;2017-03-06T17:35:07.565000&quot;,
        &quot;human_url&quot;: &quot;http://localhost:5000/observable/58bd9dcb10c5537385214808&quot;,
        &quot;id&quot;: &quot;58bd9dcb10c5537385214808&quot;,
        &quot;last_analyses&quot;: {},
        &quot;sources&quot;: [],
        &quot;tags&quot;: [
            {
                &quot;first_seen&quot;: &quot;2017-03-06T17:35:07.585000&quot;,
                &quot;fresh&quot;: true,
                &quot;last_seen&quot;: &quot;2017-03-06T17:35:07.585000&quot;,
                &quot;name&quot;: &quot;dridex&quot;
            },
            {
                &quot;first_seen&quot;: &quot;2017-03-06T17:35:21.268000&quot;,
                &quot;fresh&quot;: true,
                &quot;last_seen&quot;: &quot;2017-03-06T17:35:21.268000&quot;,
                &quot;name&quot;: &quot;banker&quot;
            }
        ],
        &quot;type&quot;: &quot;Path&quot;,
        &quot;url&quot;: &quot;http://localhost:5000/api/observable/58bd9dcb10c5537385214808&quot;,
        &quot;value&quot;: &quot;C:\\Users\\admin\\AppData\\Roaming\\Famas&quot;
    },
    {
        &quot;context&quot;: [],
        &quot;created&quot;: &quot;2017-03-06T17:17:00.572000&quot;,
        &quot;human_url&quot;: &quot;http://localhost:5000/observable/58bd998c10c55366bedca50b&quot;,
        &quot;id&quot;: &quot;58bd998c10c55366bedca50b&quot;,
        &quot;last_analyses&quot;: {},
        &quot;sources&quot;: [],
        &quot;tags&quot;: [
            {
                &quot;first_seen&quot;: &quot;2017-03-06T17:17:00.595000&quot;,
                &quot;fresh&quot;: true,
                &quot;last_seen&quot;: &quot;2017-03-06T17:17:00.595000&quot;,
                &quot;name&quot;: &quot;dridex&quot;
            }
        ],
        &quot;type&quot;: &quot;Path&quot;,
        &quot;url&quot;: &quot;http://localhost:5000/api/observable/58bd998c10c55366bedca50b&quot;,
        &quot;value&quot;: &quot;C:\\Users\\tomchop\\AppData\\Roaming\\stolen.dat&quot;
    }
]
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="objects.html" class="btn btn-neutral float-right" title="Yeti objects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Thomas Chopitea, Gael Muller.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>